/*! For license information please see main.255e867d.js.LICENSE.txt */
(()=>{var __webpack_modules__={6960:(t,e,n)=>{"use strict";const{IOBuffer:r}=n(9643),i=n(4012),a=[];for(let o=0;o<=8;o++)a.push(255<<o);t.exports=class extends r{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new r,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),n=Math.ceil(this.bitDepth*this.width/8),r=e-n,i=this.bitDepth*this.width%8,o=0===i?0:8-i,s=e*this.height;let l,h,c=0,u=0,d=8;t.mark(),h=this.readUint8();for(let f=this.height-1;f>=0;f--){const s=0===f;t.reset(),t.skip(f*e);for(let e=0;e<n;e++){const f=e===n-1;u<=o&&f?(t.writeByte(h<<u),0!==o&&o!==u||s||(l=h,h=this.readByte())):0===u?(l=h,h=this.readUint8(),t.writeByte(l)):(l=h,h=this.readUint8(),t.writeByte(l<<u&a[u]|h>>d)),f&&(c+=i||0,t.skip(r),u=c%8,d=8-u)}}e>n&&(t.reset(),t.skip(s-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(i.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(i.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(i.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}},4012:t=>{"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},9461:(t,e,n)=>{"use strict";const r=n(6960);e.l=function(t){return new r(t).encode()}},1979:t=>{"use strict";const e=[];t.exports=class{constructor(t,e){e=e||{},void 0===t&&(t=8192),"number"===typeof t&&(t=new ArrayBuffer(t));let n=t.byteLength;const r=e.offset?e.offset>>>0:0;t.buffer&&(n=t.byteLength-r,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+r,t.byteOffset+t.byteLength):r?t.buffer.slice(r):t.buffer),this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=n||8192,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,n=new Uint8Array(e);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),n=0;n<t;n++)e[n]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),e.length=t;for(var n=0;n<t;n++)e[n]=this.readChar();return e.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},251:(t,e,n)=>{"use strict";const r=n(9856);t.exports=function(t,e){return new r(t,e).decode(e)}},5240:(t,e,n)=>{"use strict";const r={standard:n(3042),exif:n(1325),gps:n(999)};t.exports=class{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(r[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=r[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}},2423:(t,e)=>{"use strict";var n=new Map([[1,[1,r]],[2,[1,function(t,e){for(var n=[],r="",i=0;i<e;i++){var a=String.fromCharCode(t.readUint8());"\0"===a?(n.push(r),r=""):r+=a}return 1===n.length?n[0]:n}]],[3,[2,function(t,e){if(1===e)return t.readUint16();for(var n=new Uint16Array(e),r=0;r<e;r++)n[r]=t.readUint16();return n}]],[4,[4,function(t,e){if(1===e)return t.readUint32();for(var n=new Uint32Array(e),r=0;r<e;r++)n[r]=t.readUint32();return n}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var n=new Array(e),r=0;r<e;r++)n[r]=t.readUint32()/t.readUint32();return n}]],[6,[1,function(t,e){if(1===e)return t.readInt8();for(var n=new Int8Array(e),r=0;r<e;r++)n[r]=t.readInt8();return n}]],[7,[1,r]],[8,[2,function(t,e){if(1===e)return t.readInt16();for(var n=new Int16Array(e),r=0;r<e;r++)n[r]=t.readInt16();return n}]],[9,[4,function(t,e){if(1===e)return t.readInt32();for(var n=new Int32Array(e),r=0;r<e;r++)n[r]=t.readInt32();return n}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var n=new Array(e),r=0;r<e;r++)n[r]=t.readInt32()/t.readInt32();return n}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();for(var n=new Float32Array(e),r=0;r<e;r++)n[r]=t.readFloat32();return n}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();for(var n=new Float64Array(e),r=0;r<e;r++)n[r]=t.readFloat64();return n}]]]);function r(t,e){if(1===e)return t.readUint8();for(var n=new Uint8Array(e),r=0;r<e;r++)n[r]=t.readUint8();return n}e.getByteLength=function(t,e){return n.get(t)[0]*e},e.readData=function(t,e,r){return n.get(e)[1](t,r)}},5801:(t,e,n)=>{"use strict";e.decode=n(251)},1325:t=>{"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},n={};for(var r in e)n[e[r]]=r;t.exports={tagsById:e,tagsByName:n}},999:t=>{"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},n={};for(var r in e)n[e[r]]=r;t.exports={tagsById:e,tagsByName:n}},3042:t=>{"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},n={};for(var r in e)n[e[r]]=r;t.exports={tagsById:e,tagsByName:n}},9856:(t,e,n)=>{"use strict";const r=n(1979),i=n(5240),a=n(1773),o=n(2423),s={ignoreImageData:!1,onlyFirst:!1};function l(t,e,n,r){for(var i=0;i<r;i++)t[n++]=e.getUint8(i);return n}function h(t,e,n,r,i){for(var a=0;a<2*r;a+=2)t[n++]=e.getUint16(a,i);return n}function c(t,e,n,r,i){for(var a=0;a<4*r;a+=4)t[n++]=e.getFloat32(a,i);return n}function u(t,e){throw new Error("Unsupported "+t+": "+e)}t.exports=class extends r{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},s,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new i(t.kind):new a;const n=this.readUint16();for(var r=0;r<n;r++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,n=this.readUint16(),r=this.readUint16(),i=this.readUint32();if(r<1||r>12)return void this.skip(4);o.getByteLength(r,i)>4&&this.seek(this.readUint32());const a=o.readData(this,r,i);if(t.fields.set(n,a),34665===n||34853===n){let e,r=this.offset;34665===n?e="exif":34853===n&&(e="gps"),this._nextIFD=a,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=r}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&u("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:u("image type",t.type)}}readStripData(t){const e=t.width,n=t.height,r=function(t){if(t.length){const n=t;t=n[0];for(var e=0;e<n.length;e++)n[e]!==t&&u("bit depth",n)}return t}(t.bitsPerSample),i=t.sampleFormat;let a=e*n;const o=function(t,e,n,r){return 8===n?new Uint8Array(t*e):16===n?new Uint16Array(t*e):32===n&&3===r?new Float32Array(t*e):u("bit depth / sample format",n+" / "+r)}(a,1,r,i),s=t.compression,d=t.rowsPerStrip*e,f=t.stripOffsets,m=t.stripByteCounts;for(var p=0,g=0;g<f.length;g++){var v=this.getStripData(s,f[g],m[g]),_=a>d?d:a;a-=_,8===r?p=l(o,v,p,_):16===r?p=h(o,v,p,_,this.isLittleEndian()):32===r&&3===i?p=c(o,v,p,_,this.isLittleEndian()):u("bitDepth",r)}t.data=o}getStripData(t,e,n){switch(t){case 1:return new DataView(this.buffer,e,n);case 2:case 32773:return u("Compression",t);default:throw new Error("invalid compression: "+t)}}}},1773:(t,e,n)=>{"use strict";const r=n(5240),i=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;function a(t){return"number"===typeof t?[t]:t}t.exports=class extends r{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=i.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return a(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return a(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}},862:(t,e,n)=>{"use strict";const r=n(1979),i=n(5801);t.exports=function(t){const e=new r(t),n={};if(e.setBigEndian(),65496!==e.readUint16())throw new Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=i.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});n.exif=t}}return n}},3378:(t,e,n)=>{"use strict";e.decode=n(862)},7872:t=>{!function(){function e(t,e,n){this.next=n,n&&(n.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function n(){if(!(this instanceof n))return new n;this._head=null,this._tail=null,this.length=0}n.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var n=e-t,r=new Array(n),i=0,a=this._head;t-- >0&&a;)a=a.next;for(;i<n&&a;)r[i++]=a.data,a=a.next;return r},drop:function(){n.call(this)},forEach:function(t,e){for(var n=this._head,r=0,i=this.length;r<i&&n;)t.call(e||this,n.data,r,this),n=n.next,r++},map:function(t,e){var r=new n;return this.forEach((function(n,i,a){r.push(t.call(e||a,n,i,a))})),r},filter:function(t,e){var r=new n;return this.forEach((function(n,i,a){t.call(e||a,n,i,a)&&r.push(n)})),r},reduce:function(t,e,n){var r=0,i=this._head,a=this.length;for(e||(r=1,e=i&&i.data,i=i&&i.next);r<a&&i;)e=t.call(n||this,e,i.data,this),r++,i=i.next;return e}},t.exports=n}()},6849:t=>{"use strict";function e(t){if(this.size=0|t,this.size<=1||0!==(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),n=0;n<e.length;n+=2){const t=Math.PI*n/this.size;e[n]=Math.cos(t),e[n+1]=-Math.sin(t)}this.table=e;for(var r=0,i=1;this.size>i;i<<=1)r++;this._width=r%2===0?r-1:r,this._bitrev=new Array(1<<this._width);for(var a=0;a<this._bitrev.length;a++){this._bitrev[a]=0;for(var o=0;o<this._width;o+=2){var s=this._width-o-2;this._bitrev[a]|=(a>>>o&3)<<s}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var n=e||new Array(t.length>>>1),r=0;r<t.length;r+=2)n[r>>>1]=t[r];return n},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var n=e||this.createComplexArray(),r=0;r<n.length;r+=2)n[r]=t[r>>>1],n[r+1]=0;return n},e.prototype.completeSpectrum=function(t){for(var e=this._csize,n=e>>>1,r=2;r<n;r+=2)t[e-r]=t[r],t[e-r+1]=-t[r+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var n=0;n<t.length;n++)t[n]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,n=this._out,r=this._csize,i=1<<this._width,a=r/i<<1,o=this._bitrev;if(4===a)for(t=0,e=0;t<r;t+=a,e++){const n=o[e];this._singleTransform2(t,n,i)}else for(t=0,e=0;t<r;t+=a,e++){const n=o[e];this._singleTransform4(t,n,i)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var h=(a=r/i<<1)>>>2;for(t=0;t<r;t+=a)for(var c=t+h,u=t,d=0;u<c;u+=2,d+=i){const t=u,e=t+h,r=e+h,i=r+h,a=n[t],o=n[t+1],c=n[e],f=n[e+1],m=n[r],p=n[r+1],g=n[i],v=n[i+1],_=a,w=o,y=l[d],b=s*l[d+1],x=c*y-f*b,M=c*b+f*y,S=l[2*d],E=s*l[2*d+1],k=m*S-p*E,C=m*E+p*S,A=l[3*d],P=s*l[3*d+1],T=g*A-v*P,D=g*P+v*A,I=_+k,N=w+C,R=_-k,L=w-C,U=x+T,O=M+D,z=s*(x-T),F=s*(M-D),B=I+U,V=N+O,H=I-U,G=N-O,j=R+F,Y=L-z,X=R-F,W=L+z;n[t]=B,n[t+1]=V,n[e]=j,n[e+1]=Y,n[r]=H,n[r+1]=G,n[i]=X,n[i+1]=W}}},e.prototype._singleTransform2=function(t,e,n){const r=this._out,i=this._data,a=i[e],o=i[e+1],s=i[e+n],l=i[e+n+1],h=a+s,c=o+l,u=a-s,d=o-l;r[t]=h,r[t+1]=c,r[t+2]=u,r[t+3]=d},e.prototype._singleTransform4=function(t,e,n){const r=this._out,i=this._data,a=this._inv?-1:1,o=2*n,s=3*n,l=i[e],h=i[e+1],c=i[e+n],u=i[e+n+1],d=i[e+o],f=i[e+o+1],m=i[e+s],p=i[e+s+1],g=l+d,v=h+f,_=l-d,w=h-f,y=c+m,b=u+p,x=a*(c-m),M=a*(u-p),S=g+y,E=v+b,k=_+M,C=w-x,A=g-y,P=v-b,T=_-M,D=w+x;r[t]=S,r[t+1]=E,r[t+2]=k,r[t+3]=C,r[t+4]=A,r[t+5]=P,r[t+6]=T,r[t+7]=D},e.prototype._realTransform4=function(){var t,e,n=this._out,r=this._csize,i=1<<this._width,a=r/i<<1,o=this._bitrev;if(4===a)for(t=0,e=0;t<r;t+=a,e++){const n=o[e];this._singleRealTransform2(t,n>>>1,i>>>1)}else for(t=0,e=0;t<r;t+=a,e++){const n=o[e];this._singleRealTransform4(t,n>>>1,i>>>1)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var h=(a=r/i<<1)>>>1,c=h>>>1,u=c>>>1;for(t=0;t<r;t+=a)for(var d=0,f=0;d<=u;d+=2,f+=i){var m=t+d,p=m+c,g=p+c,v=g+c,_=n[m],w=n[m+1],y=n[p],b=n[p+1],x=n[g],M=n[g+1],S=n[v],E=n[v+1],k=_,C=w,A=l[f],P=s*l[f+1],T=y*A-b*P,D=y*P+b*A,I=l[2*f],N=s*l[2*f+1],R=x*I-M*N,L=x*N+M*I,U=l[3*f],O=s*l[3*f+1],z=S*U-E*O,F=S*O+E*U,B=k+R,V=C+L,H=k-R,G=C-L,j=T+z,Y=D+F,X=s*(T-z),W=s*(D-F),q=B+j,$=V+Y,Z=H+W,K=G-X;if(n[m]=q,n[m+1]=$,n[p]=Z,n[p+1]=K,0!==d){if(d!==u){var Q=H+-s*W,J=-G+-s*X,tt=B+-s*j,et=-V- -s*Y,nt=t+c-d,rt=t+h-d;n[nt]=Q,n[nt+1]=J,n[rt]=tt,n[rt+1]=et}}else{var it=B-j,at=V-Y;n[g]=it,n[g+1]=at}}}},e.prototype._singleRealTransform2=function(t,e,n){const r=this._out,i=this._data,a=i[e],o=i[e+n],s=a+o,l=a-o;r[t]=s,r[t+1]=0,r[t+2]=l,r[t+3]=0},e.prototype._singleRealTransform4=function(t,e,n){const r=this._out,i=this._data,a=this._inv?-1:1,o=2*n,s=3*n,l=i[e],h=i[e+n],c=i[e+o],u=i[e+s],d=l+c,f=l-c,m=h+u,p=a*(h-u),g=d+m,v=f,_=-p,w=d-m,y=f,b=p;r[t]=g,r[t+1]=0,r[t+2]=v,r[t+3]=_,r[t+4]=w,r[t+5]=0,r[t+6]=y,r[t+7]=b}},1169:module=>{"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t[e],r=1,i=0;for(;++i<8;)r*=256,n+=t[e+i]*r;return n}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const n=(t,n)=>{n=Object.assign({offset:0},n);for(let r=0;r<t.length;r++)if(n.mask){if(t[r]!==(n.mask[r]&e[r+n.offset]))return!1}else if(t[r]!==e[r+n.offset])return!1;return!0},r=(t,e)=>n(toBytes(t),e);if(n([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(n([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(n([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(n([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((n([73,73,42,0])||n([77,77,0,42]))&&n([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(n([73,73,42,0])||n([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n([66,77]))return{ext:"bmp",mime:"image/bmp"};if(n([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(n([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n([80,75,3,4])){if(n([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(n(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(r("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(r("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(r("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.findIndex(((t,n,r)=>n>=e&&80===r[n]&&75===r[n+1]&&3===r[n+2]&&4===r[n+3]))};let i=0,a=!1,o=null;do{const s=i+30;if(a||(a=n(oxmlContentTypes,{offset:s})||n(oxmlRels,{offset:s})),o||(r("word/",{offset:s})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:r("ppt/",{offset:s})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:r("xl/",{offset:s})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),a&&o)return o;i=t(e,s)}while(i>=0);if(o)return o}if(n([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(n([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(n([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(n([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(n([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(n([51,103,112,53])||n([0,0,0])&&n([102,116,121,112],{offset:4})&&(n([109,112,52,49],{offset:8})||n([109,112,52,50],{offset:8})||n([105,115,111,109],{offset:8})||n([105,115,111,50],{offset:8})||n([109,109,112,52],{offset:8})||n([77,52,86],{offset:8})||n([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(n([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(n([26,69,223,163])){const t=e.subarray(4,4100),n=t.findIndex(((t,e,n)=>66===n[e]&&130===n[e+1]));if(-1!==n){const e=n+3,r=n=>[...n].every(((n,r)=>t[e+r]===n.charCodeAt(0)));if(r("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(r("webm"))return{ext:"webm",mime:"video/webm"}}}if(n([0,0,0,20,102,116,121,112,113,116,32,32])||n([102,114,101,101],{offset:4})||n([102,116,121,112,113,116,32,32],{offset:4})||n([109,100,97,116],{offset:4})||n([109,111,111,118],{offset:4})||n([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(n([82,73,70,70])){if(n([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(n([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(n([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const r=readUInt64LE(e,t+16);if(n([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(n([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(n([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=r}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(n([0,0,1,186])||n([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(n([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let i=0;i<2&&i<e.length-16;i++){if(n([73,68,51],{offset:i})||n([255,226],{offset:i,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(n([255,228],{offset:i,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,248],{offset:i,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,240],{offset:i,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(n([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(n([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(n([79,103,103,83]))return n([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:n([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:n([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:n([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:n([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(n([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(n([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(n([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(n([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(n([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(n([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&n([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(n([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(n([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(n([119,79,70,70])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(n([119,79,70,50])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(n([76,80],{offset:34})&&(n([0,0,1],{offset:8})||n([1,0,2],{offset:8})||n([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(n([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(n([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(n([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(n([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n([37,33]))return{ext:"ps",mime:"application/postscript"};if(n([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(n([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n([77,83,67,70])||n([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(n([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(n([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(n([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(n([31,160])||n([31,157]))return{ext:"Z",mime:"application/x-compress"};if(n([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(n([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(n([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n([71],{offset:4})&&(n([71],{offset:192})||n([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(n([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(n([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n([0,0,0,12,106,80,32,32,13,10,135,10])){if(n([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(n([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(n([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(n([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(n([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(r("<?xml "))return{ext:"xml",mime:"application/xml"};if(n([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(n([102,116,121,112],{offset:4})){if(n([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(n([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(n([104,101,105,99],{offset:8})||n([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(n([104,101,118,99],{offset:8})||n([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return n([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:n([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:n([77,80,43])||n([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:n([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:n([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:n([212,195,178,161])||n([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(n){reject(n)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},8265:(t,e,n)=>{var r=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return r.call(e,t)},e.version=n(7753).version},4416:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Image:()=>El,Kernel:()=>s,Shape:()=>ps,Stack:()=>fi,Static:()=>Ll,Worker:()=>Rl,default:()=>El});var r={};n.r(r),n.d(r,{CMYK:()=>Er,GREY:()=>br,HSL:()=>Mr,HSV:()=>Sr,RGB:()=>xr});var i={};n.r(i),n.d(i,{tagsById:()=>Nr,tagsByName:()=>Rr});var a={};n.r(a),n.d(a,{tagsById:()=>Lr,tagsByName:()=>Ur});var o={};n.r(o),n.d(o,{tagsById:()=>Or,tagsByName:()=>zr});var s={};n.r(s),n.d(s,{DISCRETE_LAPLACE_4:()=>Ri,DISCRETE_LAPLACE_8:()=>Li,SCHARR_X:()=>zi,SCHARR_Y:()=>Fi,SECOND_DERIVATIVE:()=>Bi,SECOND_DERIVATIVE_INV:()=>Vi,SOBEL_X:()=>Ui,SOBEL_Y:()=>Oi,laplacianOfGaussian:()=>kl});const l={getBit(t){return this.data[h(t)]&1<<c(t)?1:0},setBit(t){this.data[h(t)]|=1<<c(t)},clearBit(t){this.data[h(t)]&=~(1<<c(t))},toggleBit(t){this.data[h(t)]^=1<<c(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function h(t){return t>>3}function c(t){return 7-(7&t)}function u(t,e){t=t||[],"string"===typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}function d(t,e,n){return"function"===typeof t.toBlob?new Promise((function(r){t.toBlob(r,e,n)})):Promise.resolve(function(t){var e=t.match(/data:([^;]+)/)[1],n=t.replace(/^[^,]+,/,"");return u([f(atob(n))],{type:e})}(t.toDataURL(e,n)))}function f(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=-1;++i<e;)r[i]=t.charCodeAt(i);return n}var m=n(9461),p=n(9643);function g(t){let e=t.length;for(;--e>=0;)t[e]=0}const v=256,_=286,w=30,y=15,b=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),x=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),E=new Array(576);g(E);const k=new Array(60);g(k);const C=new Array(512);g(C);const A=new Array(256);g(A);const P=new Array(29);g(P);const T=new Array(w);function D(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}let I,N,R;function L(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}g(T);const U=t=>t<256?C[t]:C[256+(t>>>7)],O=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},z=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,O(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},F=(t,e,n)=>{z(t,n[2*e],n[2*e+1])},B=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},V=(t,e,n)=>{const r=new Array(16);let i,a,o=0;for(i=1;i<=y;i++)o=o+n[i-1]<<1,r[i]=o;for(a=0;a<=e;a++){let e=t[2*a+1];0!==e&&(t[2*a]=B(r[e]++,e))}},H=t=>{let e;for(e=0;e<_;e++)t.dyn_ltree[2*e]=0;for(e=0;e<w;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},G=t=>{t.bi_valid>8?O(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},j=(t,e,n,r)=>{const i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]},Y=(t,e,n)=>{const r=t.heap[n];let i=n<<1;for(;i<=t.heap_len&&(i<t.heap_len&&j(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!j(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r},X=(t,e,n)=>{let r,i,a,o,s=0;if(0!==t.sym_next)do{r=255&t.pending_buf[t.sym_buf+s++],r+=(255&t.pending_buf[t.sym_buf+s++])<<8,i=t.pending_buf[t.sym_buf+s++],0===r?F(t,i,e):(a=A[i],F(t,a+v+1,e),o=b[a],0!==o&&(i-=P[a],z(t,i,o)),r--,a=U(r),F(t,a,n),o=x[a],0!==o&&(r-=T[a],z(t,r,o)))}while(s<t.sym_next);F(t,256,e)},W=(t,e)=>{const n=e.dyn_tree,r=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.elems;let o,s,l,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<a;o++)0!==n[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):n[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,n[2*l]=1,t.depth[l]=0,t.opt_len--,i&&(t.static_len-=r[2*l+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)Y(t,n,o);l=a;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Y(t,n,1),s=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=s,n[2*l]=n[2*o]+n[2*s],t.depth[l]=(t.depth[o]>=t.depth[s]?t.depth[o]:t.depth[s])+1,n[2*o+1]=n[2*s+1]=l,t.heap[1]=l++,Y(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,r=e.max_code,i=e.stat_desc.static_tree,a=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,c,u,d,f,m,p=0;for(d=0;d<=y;d++)t.bl_count[d]=0;for(n[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)c=t.heap[h],d=n[2*n[2*c+1]+1]+1,d>l&&(d=l,p++),n[2*c+1]=d,c>r||(t.bl_count[d]++,f=0,c>=s&&(f=o[c-s]),m=n[2*c],t.opt_len+=m*(d+f),a&&(t.static_len+=m*(i[2*c+1]+f)));if(0!==p){do{for(d=l-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,p-=2}while(p>0);for(d=l;0!==d;d--)for(c=t.bl_count[d];0!==c;)u=t.heap[--h],u>r||(n[2*u+1]!==d&&(t.opt_len+=(d-n[2*u+1])*n[2*u],n[2*u+1]=d),c--)}})(t,e),V(n,h,t.bl_count)},q=(t,e,n)=>{let r,i,a=-1,o=e[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=e[2*(r+1)+1],++s<l&&i===o||(s<h?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4))},$=(t,e,n)=>{let r,i,a=-1,o=e[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),r=0;r<=n;r++)if(i=o,o=e[2*(r+1)+1],!(++s<l&&i===o)){if(s<h)do{F(t,i,t.bl_tree)}while(0!==--s);else 0!==i?(i!==a&&(F(t,i,t.bl_tree),s--),F(t,16,t.bl_tree),z(t,s-3,2)):s<=10?(F(t,17,t.bl_tree),z(t,s-3,3)):(F(t,18,t.bl_tree),z(t,s-11,7));s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4)}};let Z=!1;const K=(t,e,n,r)=>{z(t,0+(r?1:0),3),G(t),O(t,n),O(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n};var Q=(t,e,n,r)=>{let i,a,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<v;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),W(t,t.l_desc),W(t,t.d_desc),o=(t=>{let e;for(q(t,t.dyn_ltree,t.l_desc.max_code),q(t,t.dyn_dtree,t.d_desc.max_code),W(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*S[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),i=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?K(t,e,n,r):4===t.strategy||a===i?(z(t,2+(r?1:0),3),X(t,E,k)):(z(t,4+(r?1:0),3),((t,e,n,r)=>{let i;for(z(t,e-257,5),z(t,n-1,5),z(t,r-4,4),i=0;i<r;i++)z(t,t.bl_tree[2*S[i]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),X(t,t.dyn_ltree,t.dyn_dtree)),H(t),r&&G(t)},J={_tr_init:t=>{Z||((()=>{let t,e,n,r,i;const a=new Array(16);for(n=0,r=0;r<28;r++)for(P[r]=n,t=0;t<1<<b[r];t++)A[n++]=r;for(A[n-1]=r,i=0,r=0;r<16;r++)for(T[r]=i,t=0;t<1<<x[r];t++)C[i++]=r;for(i>>=7;r<w;r++)for(T[r]=i<<7,t=0;t<1<<x[r]-7;t++)C[256+i++]=r;for(e=0;e<=y;e++)a[e]=0;for(t=0;t<=143;)E[2*t+1]=8,t++,a[8]++;for(;t<=255;)E[2*t+1]=9,t++,a[9]++;for(;t<=279;)E[2*t+1]=7,t++,a[7]++;for(;t<=287;)E[2*t+1]=8,t++,a[8]++;for(V(E,287,a),t=0;t<w;t++)k[2*t+1]=5,k[2*t]=B(t,5);I=new D(E,b,257,_,y),N=new D(k,x,0,w,y),R=new D(new Array(0),M,0,19,7)})(),Z=!0),t.l_desc=new L(t.dyn_ltree,I),t.d_desc=new L(t.dyn_dtree,N),t.bl_desc=new L(t.bl_tree,R),t.bi_buf=0,t.bi_valid=0,H(t)},_tr_stored_block:K,_tr_flush_block:Q,_tr_tally:(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(A[n]+v+1)]++,t.dyn_dtree[2*U(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{z(t,2,3),F(t,256,E),(t=>{16===t.bi_valid?(O(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var tt=(t,e,n,r)=>{let i=65535&t,a=t>>>16&65535,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+e[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16};const et=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var nt=(t,e,n,r)=>{const i=et,a=r+n;t^=-1;for(let o=r;o<a;o++)t=t>>>8^i[255&(t^e[o])];return~t},rt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},it={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:at,_tr_stored_block:ot,_tr_flush_block:st,_tr_tally:lt,_tr_align:ht}=J,{Z_NO_FLUSH:ct,Z_PARTIAL_FLUSH:ut,Z_FULL_FLUSH:dt,Z_FINISH:ft,Z_BLOCK:mt,Z_OK:pt,Z_STREAM_END:gt,Z_STREAM_ERROR:vt,Z_DATA_ERROR:_t,Z_BUF_ERROR:wt,Z_DEFAULT_COMPRESSION:yt,Z_FILTERED:bt,Z_HUFFMAN_ONLY:xt,Z_RLE:Mt,Z_FIXED:St,Z_DEFAULT_STRATEGY:Et,Z_UNKNOWN:kt,Z_DEFLATED:Ct}=it,At=258,Pt=262,Tt=42,Dt=113,It=666,Nt=(t,e)=>(t.msg=rt[e],e),Rt=t=>2*t-(t>4?9:0),Lt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Ut=t=>{let e,n,r,i=t.w_size;e=t.hash_size,r=e;do{n=t.head[--r],t.head[r]=n>=i?n-i:0}while(--e);e=i,r=e;do{n=t.prev[--r],t.prev[r]=n>=i?n-i:0}while(--e)};let Ot=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const zt=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},Ft=(t,e)=>{st(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,zt(t.strm)},Bt=(t,e)=>{t.pending_buf[t.pending++]=e},Vt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Ht=(t,e,n,r)=>{let i=t.avail_in;return i>r&&(i=r),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),n),1===t.state.wrap?t.adler=tt(t.adler,e,i,n):2===t.state.wrap&&(t.adler=nt(t.adler,e,i,n)),t.next_in+=i,t.total_in+=i,i)},Gt=(t,e)=>{let n,r,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match;const l=t.strstart>t.w_size-Pt?t.strstart-(t.w_size-Pt):0,h=t.window,c=t.w_mask,u=t.prev,d=t.strstart+At;let f=h[a+o-1],m=h[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(n=e,h[n+o]===m&&h[n+o-1]===f&&h[n]===h[a]&&h[++n]===h[a+1]){a+=2,n++;do{}while(h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&a<d);if(r=At-(d-a),a=d-At,r>o){if(t.match_start=e,o=r,r>=s)break;f=h[a+o-1],m=h[a+o]}}}while((e=u[e&c])>l&&0!==--i);return o<=t.lookahead?o:t.lookahead},jt=t=>{const e=t.w_size;let n,r,i;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Pt)&&(t.window.set(t.window.subarray(e,e+e-r),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Ut(t),r+=e),0===t.strm.avail_in)break;if(n=Ht(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=n,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=Ot(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=Ot(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Pt&&0!==t.strm.avail_in)},Yt=(t,e)=>{let n,r,i,a=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,s=t.strm.avail_in;do{if(n=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i)break;if(i=t.strm.avail_out-i,r=t.strstart-t.block_start,n>r+t.strm.avail_in&&(n=r+t.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&e!==ft||e===ct||n!==r+t.strm.avail_in))break;o=e===ft&&n===r+t.strm.avail_in?1:0,ot(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,zt(t.strm),r&&(r>n&&(r=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,n-=r),n&&(Ht(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===o);return s-=t.strm.avail_in,s&&(s>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=s&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-s,t.strm.next_in),t.strstart),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==ct&&e!==ft&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(Ht(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i,a=i>t.w_size?t.w_size:i,r=t.strstart-t.block_start,(r>=a||(r||e===ft)&&e!==ct&&0===t.strm.avail_in&&r<=i)&&(n=r>i?i:r,o=e===ft&&0===t.strm.avail_in&&n===r?1:0,ot(t,t.block_start,n,o),t.block_start+=n,zt(t.strm)),o?3:1)},Xt=(t,e)=>{let n,r;for(;;){if(t.lookahead<Pt){if(jt(t),t.lookahead<Pt&&e===ct)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=Ot(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-Pt&&(t.match_length=Gt(t,n)),t.match_length>=3)if(r=lt(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Ot(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Ot(t,t.ins_h,t.window[t.strstart+1]);else r=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(Ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===ft?(Ft(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ft(t,!1),0===t.strm.avail_out)?1:2},Wt=(t,e)=>{let n,r,i;for(;;){if(t.lookahead<Pt){if(jt(t),t.lookahead<Pt&&e===ct)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=Ot(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-Pt&&(t.match_length=Gt(t,n),t.match_length<=5&&(t.strategy===bt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,r=lt(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=Ot(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(Ft(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(r=lt(t,0,t.window[t.strstart-1]),r&&Ft(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=lt(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===ft?(Ft(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ft(t,!1),0===t.strm.avail_out)?1:2};function qt(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}const $t=[new qt(0,0,0,0,Yt),new qt(4,4,8,4,Xt),new qt(4,5,16,8,Xt),new qt(4,6,32,32,Xt),new qt(4,4,16,16,Wt),new qt(8,16,32,32,Wt),new qt(8,16,128,128,Wt),new qt(8,32,128,256,Wt),new qt(32,128,258,1024,Wt),new qt(32,258,258,4096,Wt)];function Zt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ct,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Lt(this.dyn_ltree),Lt(this.dyn_dtree),Lt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Lt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Lt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Kt=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Tt&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Dt&&e.status!==It?1:0},Qt=t=>{if(Kt(t))return Nt(t,vt);t.total_in=t.total_out=0,t.data_type=kt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?Tt:Dt,t.adler=2===e.wrap?0:1,e.last_flush=-2,at(e),pt},Jt=t=>{const e=Qt(t);var n;return e===pt&&((n=t.state).window_size=2*n.w_size,Lt(n.head),n.max_lazy_match=$t[n.level].max_lazy,n.good_match=$t[n.level].good_length,n.nice_match=$t[n.level].nice_length,n.max_chain_length=$t[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),e},te=(t,e,n,r,i,a)=>{if(!t)return vt;let o=1;if(e===yt&&(e=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==Ct||r<8||r>15||e<0||e>9||a<0||a>St||8===r&&1!==o)return Nt(t,vt);8===r&&(r=9);const s=new Zt;return t.state=s,s.strm=t,s.status=Tt,s.wrap=o,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=e,s.strategy=a,s.method=n,Jt(t)};var ee=(t,e)=>te(t,e,Ct,15,8,Et),ne=(t,e)=>{let n=e.length;if(Kt(t))return vt;const r=t.state,i=r.wrap;if(2===i||1===i&&r.status!==Tt||r.lookahead)return vt;if(1===i&&(t.adler=tt(t.adler,e,n,0)),r.wrap=0,n>=r.w_size){0===i&&(Lt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let t=new Uint8Array(r.w_size);t.set(e.subarray(n-r.w_size,n),0),e=t,n=r.w_size}const a=t.avail_in,o=t.next_in,s=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,jt(r);r.lookahead>=3;){let t=r.strstart,e=r.lookahead-2;do{r.ins_h=Ot(r,r.ins_h,r.window[t+3-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++}while(--e);r.strstart=t,r.lookahead=2,jt(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=o,t.input=s,t.avail_in=a,r.wrap=i,pt},re={deflateInit:ee,deflateInit2:te,deflateReset:Jt,deflateResetKeep:Qt,deflateSetHeader:(t,e)=>Kt(t)||2!==t.state.wrap?vt:(t.state.gzhead=e,pt),deflate:(t,e)=>{if(Kt(t)||e>mt||e<0)return t?Nt(t,vt):vt;const n=t.state;if(!t.output||0!==t.avail_in&&!t.input||n.status===It&&e!==ft)return Nt(t,0===t.avail_out?wt:vt);const r=n.last_flush;if(n.last_flush=e,0!==n.pending){if(zt(t),0===t.avail_out)return n.last_flush=-1,pt}else if(0===t.avail_in&&Rt(e)<=Rt(r)&&e!==ft)return Nt(t,wt);if(n.status===It&&0!==t.avail_in)return Nt(t,wt);if(n.status===Tt&&0===n.wrap&&(n.status=Dt),n.status===Tt){let e=Ct+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=xt||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=r<<6,0!==n.strstart&&(e|=32),e+=31-e%31,Vt(n,e),0!==n.strstart&&(Vt(n,t.adler>>>16),Vt(n,65535&t.adler)),t.adler=1,n.status=Dt,zt(t),0!==n.pending)return n.last_flush=-1,pt}if(57===n.status)if(t.adler=0,Bt(n,31),Bt(n,139),Bt(n,8),n.gzhead)Bt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Bt(n,255&n.gzhead.time),Bt(n,n.gzhead.time>>8&255),Bt(n,n.gzhead.time>>16&255),Bt(n,n.gzhead.time>>24&255),Bt(n,9===n.level?2:n.strategy>=xt||n.level<2?4:0),Bt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Bt(n,255&n.gzhead.extra.length),Bt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=nt(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,9===n.level?2:n.strategy>=xt||n.level<2?4:0),Bt(n,3),n.status=Dt,zt(t),0!==n.pending)return n.last_flush=-1,pt;if(69===n.status){if(n.gzhead.extra){let e=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(t.adler=nt(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=i,zt(t),0!==n.pending)return n.last_flush=-1,pt;e=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>e&&(t.adler=nt(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let e,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=nt(t.adler,n.pending_buf,n.pending-r,r)),zt(t),0!==n.pending)return n.last_flush=-1,pt;r=0}e=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Bt(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>r&&(t.adler=nt(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let e,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=nt(t.adler,n.pending_buf,n.pending-r,r)),zt(t),0!==n.pending)return n.last_flush=-1,pt;r=0}e=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Bt(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>r&&(t.adler=nt(t.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(zt(t),0!==n.pending))return n.last_flush=-1,pt;Bt(n,255&t.adler),Bt(n,t.adler>>8&255),t.adler=0}if(n.status=Dt,zt(t),0!==n.pending)return n.last_flush=-1,pt}if(0!==t.avail_in||0!==n.lookahead||e!==ct&&n.status!==It){let r=0===n.level?Yt(n,e):n.strategy===xt?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(jt(t),0===t.lookahead)){if(e===ct)return 1;break}if(t.match_length=0,n=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(Ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===ft?(Ft(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ft(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===Mt?((t,e)=>{let n,r,i,a;const o=t.window;for(;;){if(t.lookahead<=At){if(jt(t),t.lookahead<=At&&e===ct)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=t.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=t.strstart+At;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);t.match_length=At-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=lt(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(Ft(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===ft?(Ft(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ft(t,!1),0===t.strm.avail_out)?1:2})(n,e):$t[n.level].func(n,e);if(3!==r&&4!==r||(n.status=It),1===r||3===r)return 0===t.avail_out&&(n.last_flush=-1),pt;if(2===r&&(e===ut?ht(n):e!==mt&&(ot(n,0,0,!1),e===dt&&(Lt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),zt(t),0===t.avail_out))return n.last_flush=-1,pt}return e!==ft?pt:n.wrap<=0?gt:(2===n.wrap?(Bt(n,255&t.adler),Bt(n,t.adler>>8&255),Bt(n,t.adler>>16&255),Bt(n,t.adler>>24&255),Bt(n,255&t.total_in),Bt(n,t.total_in>>8&255),Bt(n,t.total_in>>16&255),Bt(n,t.total_in>>24&255)):(Vt(n,t.adler>>>16),Vt(n,65535&t.adler)),zt(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?pt:gt)},deflateEnd:t=>{if(Kt(t))return vt;const e=t.state.status;return t.state=null,e===Dt?Nt(t,_t):pt},deflateSetDictionary:ne,deflateInfo:"pako deflate (from Nodeca project)"};const ie=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var ae=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(const e in n)ie(n,e)&&(t[e]=n[e])}}return t},oe=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,a=t.length;r<a;r++){let e=t[r];n.set(e,i),i+=e.length}return n};let se=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Ul){se=!1}const le=new Uint8Array(256);for(let Ol=0;Ol<256;Ol++)le[Ol]=Ol>=252?6:Ol>=248?5:Ol>=240?4:Ol>=224?3:Ol>=192?2:1;le[254]=le[254]=1;var he=t=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,r,i,a,o=t.length,s=0;for(i=0;i<o;i++)n=t.charCodeAt(i),55296===(64512&n)&&i+1<o&&(r=t.charCodeAt(i+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(s),a=0,i=0;a<s;i++)n=t.charCodeAt(i),55296===(64512&n)&&i+1<o&&(r=t.charCodeAt(i+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},ce=(t,e)=>{const n=e||t.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,i;const a=new Array(2*n);for(i=0,r=0;r<n;){let e=t[r++];if(e<128){a[i++]=e;continue}let o=le[e];if(o>4)a[i++]=65533,r+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&r<n;)e=e<<6|63&t[r++],o--;o>1?a[i++]=65533:e<65536?a[i++]=e:(e-=65536,a[i++]=55296|e>>10&1023,a[i++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&se)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n})(a,i)},ue=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128===(192&t[n]);)n--;return n<0||0===n?e:n+le[t[n]]>e?n:e};var de=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const fe=Object.prototype.toString,{Z_NO_FLUSH:me,Z_SYNC_FLUSH:pe,Z_FULL_FLUSH:ge,Z_FINISH:ve,Z_OK:_e,Z_STREAM_END:we,Z_DEFAULT_COMPRESSION:ye,Z_DEFAULT_STRATEGY:be,Z_DEFLATED:xe}=it;function Me(t){this.options=ae({level:ye,method:xe,chunkSize:16384,windowBits:15,memLevel:8,strategy:be},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new de,this.strm.avail_out=0;let n=re.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==_e)throw new Error(rt[n]);if(e.header&&re.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"===typeof e.dictionary?he(e.dictionary):"[object ArrayBuffer]"===fe.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=re.deflateSetDictionary(this.strm,t),n!==_e)throw new Error(rt[n]);this._dict_set=!0}}function Se(t,e){const n=new Me(e);if(n.push(t,!0),n.err)throw n.msg||rt[n.err];return n.result}Me.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=e===~~e?e:!0===e?ve:me,"string"===typeof t?n.input=he(t):"[object ArrayBuffer]"===fe.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===pe||a===ge)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=re.deflate(n,a),i===we)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=re.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===_e;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Me.prototype.onData=function(t){this.chunks.push(t)},Me.prototype.onEnd=function(t){t===_e&&(this.result=oe(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ee={Deflate:Me,deflate:Se,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Se(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Se(t,e)},constants:it};const ke=16209;var Ce=function(t,e){let n,r,i,a,o,s,l,h,c,u,d,f,m,p,g,v,_,w,y,b,x,M,S,E;const k=t.state;n=t.next_in,S=t.input,r=n+(t.avail_in-5),i=t.next_out,E=t.output,a=i-(e-t.avail_out),o=i+(t.avail_out-257),s=k.dmax,l=k.wsize,h=k.whave,c=k.wnext,u=k.window,d=k.hold,f=k.bits,m=k.lencode,p=k.distcode,g=(1<<k.lenbits)-1,v=(1<<k.distbits)-1;t:do{f<15&&(d+=S[n++]<<f,f+=8,d+=S[n++]<<f,f+=8),_=m[d&g];e:for(;;){if(w=_>>>24,d>>>=w,f-=w,w=_>>>16&255,0===w)E[i++]=65535&_;else{if(!(16&w)){if(0===(64&w)){_=m[(65535&_)+(d&(1<<w)-1)];continue e}if(32&w){k.mode=16191;break t}t.msg="invalid literal/length code",k.mode=ke;break t}y=65535&_,w&=15,w&&(f<w&&(d+=S[n++]<<f,f+=8),y+=d&(1<<w)-1,d>>>=w,f-=w),f<15&&(d+=S[n++]<<f,f+=8,d+=S[n++]<<f,f+=8),_=p[d&v];n:for(;;){if(w=_>>>24,d>>>=w,f-=w,w=_>>>16&255,!(16&w)){if(0===(64&w)){_=p[(65535&_)+(d&(1<<w)-1)];continue n}t.msg="invalid distance code",k.mode=ke;break t}if(b=65535&_,w&=15,f<w&&(d+=S[n++]<<f,f+=8,f<w&&(d+=S[n++]<<f,f+=8)),b+=d&(1<<w)-1,b>s){t.msg="invalid distance too far back",k.mode=ke;break t}if(d>>>=w,f-=w,w=i-a,b>w){if(w=b-w,w>h&&k.sane){t.msg="invalid distance too far back",k.mode=ke;break t}if(x=0,M=u,0===c){if(x+=l-w,w<y){y-=w;do{E[i++]=u[x++]}while(--w);x=i-b,M=E}}else if(c<w){if(x+=l+c-w,w-=c,w<y){y-=w;do{E[i++]=u[x++]}while(--w);if(x=0,c<y){w=c,y-=w;do{E[i++]=u[x++]}while(--w);x=i-b,M=E}}}else if(x+=c-w,w<y){y-=w;do{E[i++]=u[x++]}while(--w);x=i-b,M=E}for(;y>2;)E[i++]=M[x++],E[i++]=M[x++],E[i++]=M[x++],y-=3;y&&(E[i++]=M[x++],y>1&&(E[i++]=M[x++]))}else{x=i-b;do{E[i++]=E[x++],E[i++]=E[x++],E[i++]=E[x++],y-=3}while(y>2);y&&(E[i++]=E[x++],y>1&&(E[i++]=E[x++]))}break}}break}}while(n<r&&i<o);y=f>>3,n-=y,f-=y<<3,d&=(1<<f)-1,t.next_in=n,t.next_out=i,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=i<o?o-i+257:257-(i-o),k.hold=d,k.bits=f};const Ae=15,Pe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Te=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),De=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ie=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ne=(t,e,n,r,i,a,o,s)=>{const l=s.bits;let h,c,u,d,f,m,p=0,g=0,v=0,_=0,w=0,y=0,b=0,x=0,M=0,S=0,E=null;const k=new Uint16Array(16),C=new Uint16Array(16);let A,P,T,D=null;for(p=0;p<=Ae;p++)k[p]=0;for(g=0;g<r;g++)k[e[n+g]]++;for(w=l,_=Ae;_>=1&&0===k[_];_--);if(w>_&&(w=_),0===_)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(v=1;v<_&&0===k[v];v++);for(w<v&&(w=v),x=1,p=1;p<=Ae;p++)if(x<<=1,x-=k[p],x<0)return-1;if(x>0&&(0===t||1!==_))return-1;for(C[1]=0,p=1;p<Ae;p++)C[p+1]=C[p]+k[p];for(g=0;g<r;g++)0!==e[n+g]&&(o[C[e[n+g]]++]=g);if(0===t?(E=D=o,m=20):1===t?(E=Pe,D=Te,m=257):(E=De,D=Ie,m=0),S=0,g=0,p=v,f=a,y=w,b=0,u=-1,M=1<<w,d=M-1,1===t&&M>852||2===t&&M>592)return 1;for(;;){A=p-b,o[g]+1<m?(P=0,T=o[g]):o[g]>=m?(P=D[o[g]-m],T=E[o[g]-m]):(P=96,T=0),h=1<<p-b,c=1<<y,v=c;do{c-=h,i[f+(S>>b)+c]=A<<24|P<<16|T}while(0!==c);for(h=1<<p-1;S&h;)h>>=1;if(0!==h?(S&=h-1,S+=h):S=0,g++,0===--k[p]){if(p===_)break;p=e[n+o[g]]}if(p>w&&(S&d)!==u){for(0===b&&(b=w),f+=v,y=p-b,x=1<<y;y+b<_&&(x-=k[y+b],!(x<=0));)y++,x<<=1;if(M+=1<<y,1===t&&M>852||2===t&&M>592)return 1;u=S&d,i[u]=w<<24|y<<16|f-a}}return 0!==S&&(i[f+S]=p-b<<24|64<<16),s.bits=w,0};const{Z_FINISH:Re,Z_BLOCK:Le,Z_TREES:Ue,Z_OK:Oe,Z_STREAM_END:ze,Z_NEED_DICT:Fe,Z_STREAM_ERROR:Be,Z_DATA_ERROR:Ve,Z_MEM_ERROR:He,Z_BUF_ERROR:Ge,Z_DEFLATED:je}=it,Ye=16180,Xe=16190,We=16191,qe=16192,$e=16194,Ze=16199,Ke=16200,Qe=16206,Je=16209,tn=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function en(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const nn=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Ye||e.mode>16211?1:0},rn=t=>{if(nn(t))return Be;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Ye,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Oe},an=t=>{if(nn(t))return Be;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,rn(t)},on=(t,e)=>{let n;if(nn(t))return Be;const r=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Be:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,an(t))},sn=(t,e)=>{if(!t)return Be;const n=new en;t.state=n,n.strm=t,n.window=null,n.mode=Ye;const r=on(t,e);return r!==Oe&&(t.state=null),r};let ln,hn,cn=!0;const un=t=>{if(cn){ln=new Int32Array(512),hn=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Ne(1,t.lens,0,288,ln,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Ne(2,t.lens,0,32,hn,0,t.work,{bits:5}),cn=!1}t.lencode=ln,t.lenbits=9,t.distcode=hn,t.distbits=5},dn=(t,e,n,r)=>{let i;const a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(e.subarray(n-r,n-r+i),a.wnext),(r-=i)?(a.window.set(e.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var fn={inflateReset:an,inflateReset2:on,inflateResetKeep:rn,inflateInit:t=>sn(t,15),inflateInit2:sn,inflate:(t,e)=>{let n,r,i,a,o,s,l,h,c,u,d,f,m,p,g,v,_,w,y,b,x,M,S=0;const E=new Uint8Array(4);let k,C;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(nn(t)||!t.output||!t.input&&0!==t.avail_in)return Be;n=t.state,n.mode===We&&(n.mode=qe),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,r=t.input,s=t.avail_in,h=n.hold,c=n.bits,u=s,d=l,M=Oe;t:for(;;)switch(n.mode){case Ye:if(0===n.wrap){n.mode=qe;break}for(;c<16;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(2&n.wrap&&35615===h){0===n.wbits&&(n.wbits=15),n.check=0,E[0]=255&h,E[1]=h>>>8&255,n.check=nt(n.check,E,2,0),h=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=Je;break}if((15&h)!==je){t.msg="unknown compression method",n.mode=Je;break}if(h>>>=4,c-=4,x=8+(15&h),0===n.wbits&&(n.wbits=x),x>15||x>n.wbits){t.msg="invalid window size",n.mode=Je;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&h?16189:We,h=0,c=0;break;case 16181:for(;c<16;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(n.flags=h,(255&n.flags)!==je){t.msg="unknown compression method",n.mode=Je;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=Je;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&4&n.wrap&&(E[0]=255&h,E[1]=h>>>8&255,n.check=nt(n.check,E,2,0)),h=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.head&&(n.head.time=h),512&n.flags&&4&n.wrap&&(E[0]=255&h,E[1]=h>>>8&255,E[2]=h>>>16&255,E[3]=h>>>24&255,n.check=nt(n.check,E,4,0)),h=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&4&n.wrap&&(E[0]=255&h,E[1]=h>>>8&255,n.check=nt(n.check,E,2,0)),h=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&4&n.wrap&&(E[0]=255&h,E[1]=h>>>8&255,n.check=nt(n.check,E,2,0)),h=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>s&&(f=s),f&&(n.head&&(x=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),x)),512&n.flags&&4&n.wrap&&(n.check=nt(n.check,r,f,a)),s-=f,a+=f,n.length-=f),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break t;f=0;do{x=r[a+f++],n.head&&x&&n.length<65536&&(n.head.name+=String.fromCharCode(x))}while(x&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=nt(n.check,r,f,a)),s-=f,a+=f,x)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break t;f=0;do{x=r[a+f++],n.head&&x&&n.length<65536&&(n.head.comment+=String.fromCharCode(x))}while(x&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=nt(n.check,r,f,a)),s-=f,a+=f,x)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(4&n.wrap&&h!==(65535&n.check)){t.msg="header crc mismatch",n.mode=Je;break}h=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=We;break;case 16189:for(;c<32;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}t.adler=n.check=tn(h),h=0,c=0,n.mode=Xe;case Xe:if(0===n.havedict)return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=h,n.bits=c,Fe;t.adler=n.check=1,n.mode=We;case We:if(e===Le||e===Ue)break t;case qe:if(n.last){h>>>=7&c,c-=7&c,n.mode=Qe;break}for(;c<3;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}switch(n.last=1&h,h>>>=1,c-=1,3&h){case 0:n.mode=16193;break;case 1:if(un(n),n.mode=Ze,e===Ue){h>>>=2,c-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=Je}h>>>=2,c-=2;break;case 16193:for(h>>>=7&c,c-=7&c;c<32;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if((65535&h)!==(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Je;break}if(n.length=65535&h,h=0,c=0,n.mode=$e,e===Ue)break t;case $e:n.mode=16195;case 16195:if(f=n.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break t;i.set(r.subarray(a,a+f),o),s-=f,a+=f,l-=f,o+=f,n.length-=f;break}n.mode=We;break;case 16196:for(;c<14;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(n.nlen=257+(31&h),h>>>=5,c-=5,n.ndist=1+(31&h),h>>>=5,c-=5,n.ncode=4+(15&h),h>>>=4,c-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Je;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.lens[A[n.have++]]=7&h,h>>>=3,c-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},M=Ne(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,M){t.msg="invalid code lengths set",n.mode=Je;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[h&(1<<n.lenbits)-1],g=S>>>24,v=S>>>16&255,_=65535&S,!(g<=c);){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(_<16)h>>>=g,c-=g,n.lens[n.have++]=_;else{if(16===_){for(C=g+2;c<C;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(h>>>=g,c-=g,0===n.have){t.msg="invalid bit length repeat",n.mode=Je;break}x=n.lens[n.have-1],f=3+(3&h),h>>>=2,c-=2}else if(17===_){for(C=g+3;c<C;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}h>>>=g,c-=g,x=0,f=3+(7&h),h>>>=3,c-=3}else{for(C=g+7;c<C;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}h>>>=g,c-=g,x=0,f=11+(127&h),h>>>=7,c-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Je;break}for(;f--;)n.lens[n.have++]=x}}if(n.mode===Je)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=Je;break}if(n.lenbits=9,k={bits:n.lenbits},M=Ne(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,M){t.msg="invalid literal/lengths set",n.mode=Je;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},M=Ne(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,M){t.msg="invalid distances set",n.mode=Je;break}if(n.mode=Ze,e===Ue)break t;case Ze:n.mode=Ke;case Ke:if(s>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=h,n.bits=c,Ce(t,d),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,r=t.input,s=t.avail_in,h=n.hold,c=n.bits,n.mode===We&&(n.back=-1);break}for(n.back=0;S=n.lencode[h&(1<<n.lenbits)-1],g=S>>>24,v=S>>>16&255,_=65535&S,!(g<=c);){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(v&&0===(240&v)){for(w=g,y=v,b=_;S=n.lencode[b+((h&(1<<w+y)-1)>>w)],g=S>>>24,v=S>>>16&255,_=65535&S,!(w+g<=c);){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}h>>>=w,c-=w,n.back+=w}if(h>>>=g,c-=g,n.back+=g,n.length=_,0===v){n.mode=16205;break}if(32&v){n.back=-1,n.mode=We;break}if(64&v){t.msg="invalid literal/length code",n.mode=Je;break}n.extra=15&v,n.mode=16201;case 16201:if(n.extra){for(C=n.extra;c<C;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;S=n.distcode[h&(1<<n.distbits)-1],g=S>>>24,v=S>>>16&255,_=65535&S,!(g<=c);){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(0===(240&v)){for(w=g,y=v,b=_;S=n.distcode[b+((h&(1<<w+y)-1)>>w)],g=S>>>24,v=S>>>16&255,_=65535&S,!(w+g<=c);){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}h>>>=w,c-=w,n.back+=w}if(h>>>=g,c-=g,n.back+=g,64&v){t.msg="invalid distance code",n.mode=Je;break}n.offset=_,n.extra=15&v,n.mode=16203;case 16203:if(n.extra){for(C=n.extra;c<C;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Je;break}n.mode=16204;case 16204:if(0===l)break t;if(f=d-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Je;break}f>n.wnext?(f-=n.wnext,m=n.wsize-f):m=n.wnext-f,f>n.length&&(f=n.length),p=n.window}else p=i,m=o-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{i[o++]=p[m++]}while(--f);0===n.length&&(n.mode=Ke);break;case 16205:if(0===l)break t;i[o++]=n.length,l--,n.mode=Ke;break;case Qe:if(n.wrap){for(;c<32;){if(0===s)break t;s--,h|=r[a++]<<c,c+=8}if(d-=l,t.total_out+=d,n.total+=d,4&n.wrap&&d&&(t.adler=n.check=n.flags?nt(n.check,i,d,o-d):tt(n.check,i,d,o-d)),d=l,4&n.wrap&&(n.flags?h:tn(h))!==n.check){t.msg="incorrect data check",n.mode=Je;break}h=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===s)break t;s--,h+=r[a++]<<c,c+=8}if(4&n.wrap&&h!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=Je;break}h=0,c=0}n.mode=16208;case 16208:M=ze;break t;case Je:M=Ve;break t;case 16210:return He;default:return Be}return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=h,n.bits=c,(n.wsize||d!==t.avail_out&&n.mode<Je&&(n.mode<Qe||e!==Re))&&dn(t,t.output,t.next_out,d-t.avail_out),u-=t.avail_in,d-=t.avail_out,t.total_in+=u,t.total_out+=d,n.total+=d,4&n.wrap&&d&&(t.adler=n.check=n.flags?nt(n.check,i,d,t.next_out-d):tt(n.check,i,d,t.next_out-d)),t.data_type=n.bits+(n.last?64:0)+(n.mode===We?128:0)+(n.mode===Ze||n.mode===$e?256:0),(0===u&&0===d||e===Re)&&M===Oe&&(M=Ge),M},inflateEnd:t=>{if(nn(t))return Be;let e=t.state;return e.window&&(e.window=null),t.state=null,Oe},inflateGetHeader:(t,e)=>{if(nn(t))return Be;const n=t.state;return 0===(2&n.wrap)?Be:(n.head=e,e.done=!1,Oe)},inflateSetDictionary:(t,e)=>{const n=e.length;let r,i,a;return nn(t)?Be:(r=t.state,0!==r.wrap&&r.mode!==Xe?Be:r.mode===Xe&&(i=1,i=tt(i,e,n,0),i!==r.check)?Ve:(a=dn(t,e,n,n),a?(r.mode=16210,He):(r.havedict=1,Oe)))},inflateInfo:"pako inflate (from Nodeca project)"};var mn=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const pn=Object.prototype.toString,{Z_NO_FLUSH:gn,Z_FINISH:vn,Z_OK:_n,Z_STREAM_END:wn,Z_NEED_DICT:yn,Z_STREAM_ERROR:bn,Z_DATA_ERROR:xn,Z_MEM_ERROR:Mn}=it;function Sn(t){this.options=ae({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new de,this.strm.avail_out=0;let n=fn.inflateInit2(this.strm,e.windowBits);if(n!==_n)throw new Error(rt[n]);if(this.header=new mn,fn.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=he(e.dictionary):"[object ArrayBuffer]"===pn.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=fn.inflateSetDictionary(this.strm,e.dictionary),n!==_n)))throw new Error(rt[n])}function En(t,e){const n=new Sn(e);if(n.push(t),n.err)throw n.msg||rt[n.err];return n.result}Sn.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(o=e===~~e?e:!0===e?vn:gn,"[object ArrayBuffer]"===pn.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=fn.inflate(n,o),a===yn&&i&&(a=fn.inflateSetDictionary(n,i),a===_n?a=fn.inflate(n,o):a===xn&&(a=yn));n.avail_in>0&&a===wn&&n.state.wrap>0&&0!==t[n.next_in];)fn.inflateReset(n),a=fn.inflate(n,o);switch(a){case bn:case xn:case yn:case Mn:return this.onEnd(a),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||a===wn))if("string"===this.options.to){let t=ue(n.output,n.next_out),e=n.next_out-t,i=ce(n.output,t);n.next_out=e,n.avail_out=r-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==_n||0!==s){if(a===wn)return a=fn.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Sn.prototype.onData=function(t){this.chunks.push(t)},Sn.prototype.onEnd=function(t){t===_n&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=oe(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var kn={Inflate:Sn,inflate:En,inflateRaw:function(t,e){return(e=e||{}).raw=!0,En(t,e)},ungzip:En,constants:it};const{Deflate:Cn,deflate:An,deflateRaw:Pn,gzip:Tn}=Ee,{Inflate:Dn,inflate:In,inflateRaw:Nn,ungzip:Rn}=kn;var Ln=An,Un=Dn,On=In;const zn=[137,80,78,71,13,10,26,10],Fn=[];for(let Ol=0;Ol<256;Ol++){let t=Ol;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;Fn[Ol]=t}const Bn=4294967295;function Vn(t,e){return(function(t,e,n){let r=t;for(let i=0;i<n;i++)r=Fn[255&(r^e[i])]^r>>>8;return r}(Bn,t,e)^Bn)>>>0}var Hn,Gn,jn,Yn;!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(Hn||(Hn={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(Gn||(Gn={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(jn||(jn={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(Yn||(Yn={}));const Xn=new Uint8Array(0),Wn=new Uint16Array([255]),qn=255===new Uint8Array(Wn.buffer)[0];class $n extends p.IOBuffer{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t);const{checkCrc:n=!1}=e;this._checkCrc=n,this._inflator=new Un,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Gn.UNKNOWN,this._filterMethod=jn.UNKNOWN,this._interlaceMethod=Yn.UNKNOWN,this._colorType=Hn.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<zn.length;t++)if(this.readUint8()!==zn[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${zn[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),n=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const n=this.readUint32(),r=t+4,i=Vn(new Uint8Array(this.buffer,this.byteOffset+this.offset-r-4,r),r);if(i!==n)throw new Error(`CRC mismatch for chunk ${e}. Expected ${n}, found ${i}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}(this.readUint8());const e=this.readUint8();let n;switch(this._colorType=e,e){case Hn.GREYSCALE:n=1;break;case Hn.TRUECOLOUR:n=3;break;case Hn.INDEXED_COLOUR:n=1;break;case Hn.GREYSCALE_ALPHA:n=2;break;case Hn.TRUECOLOUR_ALPHA:n=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Gn.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const n=[];this._palette=n;for(let r=0;r<e;r++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case Hn.GREYSCALE:case Hn.TRUECOLOUR:if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case Hn.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,n="";for(;"\0"!==(e=this.readChar());)n+=e;const r=this.readUint8();if(r!==Gn.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const i=this.readBytes(t-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:On(i)}}decodetEXt(t){let e,n="";for(;"\0"!==(e=this.readChar());)n+=e;this._png.text[n]=this.readChars(t-n.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:e,unit:n}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==jn.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==Yn.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,n=this._png.channels*this._png.depth/8,r=this._png.width*n,i=new Uint8Array(this._png.height*r);let a,o,s=Xn,l=0;for(let c=0;c<e;c++){switch(a=t.subarray(l+1,l+1+r),o=i.subarray(c*r,(c+1)*r),t[l]){case 0:Zn(a,o,r);break;case 1:Kn(a,o,r,n);break;case 2:Qn(a,o,s,r);break;case 3:Jn(a,o,s,r,n);break;case 4:tr(a,o,s,r,n);break;default:throw new Error(`Unsupported filter: ${t[l]}`)}s=o,l+=r+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(i.buffer);if(qn)for(let e=0;e<t.length;e++)t[e]=(255&(h=t[e]))<<8|h>>8&255;this._png.data=t}else this._png.data=i;var h}}function Zn(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function Kn(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function Qn(t,e,n,r){let i=0;if(0===n.length)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function Jn(t,e,n,r,i){let a=0;if(0===n.length){for(;a<i;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(n[a]>>1)&255;for(;a<r;a++)e[a]=t[a]+(e[a-i]+n[a]>>1)&255}}function tr(t,e,n,r,i){let a=0;if(0===n.length){for(;a<i;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+n[a]&255;for(;a<r;a++)e[a]=t[a]+er(e[a-i],n[a],n[a-i])&255}}function er(t,e,n){const r=t+e-n,i=Math.abs(r-t),a=Math.abs(r-e),o=Math.abs(r-n);return i<=a&&i<=o?t:a<=o?e:n}const nr={level:3};class rr extends p.IOBuffer{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this._colorType=Hn.UNKNOWN,this._zlibOptions={...nr,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(zn)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(Gn.DEFLATE),this.writeByte(jn.ADAPTIVE),this.writeByte(Yn.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:n,depth:r,data:i}=this._png,a=n*t,o=(new p.IOBuffer).setBigEndian();let s=0;for(let c=0;c<e;c++)if(o.writeByte(0),8===r)s=ar(i,o,a,s);else{if(16!==r)throw new Error("unreachable");s=or(i,o,a,s)}const l=o.toArray(),h=Ln(l,this._zlibOptions);this.encodeIDAT(h)}_checkData(t){const{colorType:e,channels:n,depth:r}=function(t){const{channels:e=4,depth:n=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==n&&16!==n)throw new RangeError(`unsupported bit depth: ${n}`);const r={channels:e,depth:n,colorType:Hn.UNKNOWN};switch(e){case 4:r.colorType=Hn.TRUECOLOUR_ALPHA;break;case 3:r.colorType=Hn.TRUECOLOUR;break;case 1:r.colorType=Hn.GREYSCALE;break;case 2:r.colorType=Hn.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return r}(t),i={width:ir(t.width,"width"),height:ir(t.height,"height"),channels:n,data:t.data,depth:r,text:{}};this._colorType=e;const a=i.width*i.height*n;if(i.data.length!==a)throw new RangeError(`wrong data size. Found ${i.data.length}, expected ${a}`);return i}writeCrc(t){this.writeUint32(Vn(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function ir(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function ar(t,e,n,r){for(let i=0;i<n;i++)e.writeByte(t[r++]);return r}function or(t,e,n,r){for(let i=0;i<n;i++)e.writeUint16(t[r++]);return r}var sr;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(sr||(sr={}));var lr=n(3194);let hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cr=new Uint8Array(256);for(let Ol=0;Ol<64;Ol++)cr[hr.charCodeAt(Ol)]=Ol;function ur(t,e){return`data:${e};base64,${function(t){let e,n=t.length,r="";for(e=0;e<n;e+=3)r+=hr[t[e]>>2],r+=hr[(3&t[e])<<4|t[e+1]>>4],r+=hr[(15&t[e+1])<<2|t[e+2]>>6],r+=hr[63&t[e+2]];return n%3===2?r=`${r.substring(0,r.length-1)}=`:n%3===1&&(r=`${r.substring(0,r.length-2)}==`),r}(t)}`}const dr=self.ImageData,fr=self.Image;function mr(t,e){let n=self.document.createElement("canvas");return n.width=t,n.height=e,n}function pr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={width:t.width,height:t.height,data:t.getRGBAData()};return(0,lr.encode)(n,e.quality).data}function gr(t,e){const n={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==n.depth&&32!==n.depth||(n.depth=8,n.channels=4,n.data=t.getRGBAData()),function(t,e){return new rr(t,e).encode()}(n,e)}const vr={save(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{useCanvas:n=!1,encoder:r}=e;let{format:i}=e;if(!i){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(i=e.groups.format.toLowerCase())}if(!i)throw new Error("file format not provided");return new Promise(((t,e)=>{let a,o;switch(i.toLowerCase()){case"png":n?a=this.getCanvas().pngStream():o=gr(this,r);break;case"jpg":case"jpeg":n?a=this.getCanvas().jpegStream():o=pr(this,r);break;case"bmp":o=(0,m.l)(this,r);break;default:throw new RangeError(`invalid output format: ${i}`)}if(a){let n=function(){throw new Error("createWriteStream does not exist in the browser")}();n.on("finish",t),n.on("error",e),a.pipe(n)}else o&&function(){throw new Error("writeFile does not exist in the browser")}()}))},toDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===typeof t&&(e=t,t="image/png");const{useCanvas:n=!1,encoder:r}=e;function i(e,n){return ur(e(n,r),t)}return t=function(t){return t.includes("/")||(t=`image/${t}`),t}(t),"image/bmp"===t?i(m.l,this):"image/png"!==t||n?"image/jpeg"!==t||n?this.getCanvas().toDataURL(t):i(pr,this):i(gr,this)},toBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{format:e="png",encoder:n}=t;switch(e.toLowerCase()){case"png":return gr(this,n);case"jpeg":case"jpg":return pr(this,n);case"bmp":return(0,m.l)(this,n);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const n=this.toDataURL(t,e);return n.substring(n.indexOf(",")+1)}},toBlob(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8;return d(this.getCanvas(),t,e)},getCanvas(){const t=new dr(this.getRGBAData({clamped:!0}),this.width,this.height);let e=mr(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};var _r=n(8265),wr=n.n(_r);let yr={configurable:!0,enumerable:!1,get:void 0};const br="GREY",xr="RGB",Mr="HSL",Sr="HSV",Er="CMYK";const kr="BINARY",Cr="RGBA",Ar={};Ar[kr]={components:1,alpha:0,bitDepth:1,colorModel:br},Ar.GREYA={components:1,alpha:1,bitDepth:8,colorModel:br},Ar.GREY={components:1,alpha:0,bitDepth:8,colorModel:br},Ar[Cr]={components:3,alpha:1,bitDepth:8,colorModel:xr},Ar.RGB={components:3,alpha:0,bitDepth:8,colorModel:xr},Ar.CMYK={components:4,alpha:0,bitDepth:8,colorModel:Er},Ar.CMYKA={components:4,alpha:1,bitDepth:8,colorModel:Er};const Pr=[1,8,16,32];var Tr=n(3378),Dr=n(7288),Ir=n.n(Dr);const Nr={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},Rr={};for(let Ol in Nr)Rr[Nr[Ol]]=Number(Ol);const Lr={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},Ur={};for(let Ol in Lr)Ur[Lr[Ol]]=Number(Ol);const Or={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},zr={};for(let Ol in Or)zr[Or[Ol]]=Number(Ol);const Fr={standard:o,exif:i,gps:a};class Br{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(Fr[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=Fr[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Vr=new Map([[1,[1,Hr]],[2,[1,function(t,e){let n=[],r="";for(let i=0;i<e;i++){let e=String.fromCharCode(t.readUint8());"\0"===e?(n.push(r),r=""):r+=e}return 1===n.length?n[0]:n}]],[3,[2,function(t,e){if(1===e)return t.readUint16();let n=new Uint16Array(e);for(let r=0;r<e;r++)n[r]=t.readUint16();return n}]],[4,[4,function(t,e){if(1===e)return t.readUint32();let n=new Uint32Array(e);for(let r=0;r<e;r++)n[r]=t.readUint32();return n}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();let n=new Array(e);for(let r=0;r<e;r++)n[r]=t.readUint32()/t.readUint32();return n}]],[6,[1,function(t,e){if(1===e)return t.readInt8();let n=new Int8Array(e);for(let r=0;r<e;r++)n[r]=t.readInt8();return n}]],[7,[1,Hr]],[8,[2,function(t,e){if(1===e)return t.readInt16();let n=new Int16Array(e);for(let r=0;r<e;r++)n[r]=t.readInt16();return n}]],[9,[4,function(t,e){if(1===e)return t.readInt32();let n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.readInt32();return n}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();let n=new Array(e);for(let r=0;r<e;r++)n[r]=t.readInt32()/t.readInt32();return n}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();let n=new Float32Array(e);for(let r=0;r<e;r++)n[r]=t.readFloat32();return n}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();let n=new Float64Array(e);for(let r=0;r<e;r++)n[r]=t.readFloat64();return n}]]]);function Hr(t,e){if(1===e)return t.readUint8();let n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t.readUint8();return n}let Gr=[];const jr=[511,1023,2047,4095],Yr=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class Xr{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=258,this.currentBitLength=9,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new p.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;for(;257!==(t=this.getNextCode());)if(256===t){if(this.initializeTable(),t=this.getNextCode(),257===t)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const n=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(n),this.addStringToTable(n),e=t}const n=this.outData.toArray();return new DataView(n.buffer,n.byteOffset,n.byteLength)}initializeTable(){!function(){if(0===Gr.length){for(let e=0;e<256;e++)Gr.push([e]);const t=[];for(let e=256;e<4096;e++)Gr.push(t)}}(),this.tableLength=258,this.currentBitLength=9}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return Gr[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(Gr[this.tableLength++]=t,Gr.length>4096)throw Gr=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===Yr[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&jr[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function Wr(t){return new Xr(t).decode()}const qr=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class $r extends Br{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=qr.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!==typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return Zr(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return Zr(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return Zr(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const n=[];for(let r=0;r<t;r++)n.push([e[r],e[r+t],e[r+2*t]]);return n}}function Zr(t){return"number"===typeof t?[t]:t}function Kr(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=On(e);return new DataView(n.buffer,n.byteOffset,n.byteLength)}const Qr={ignoreImageData:!1,onlyFirst:!1};class Jr extends p.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw ti("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw ti("ifdCount",t)}decode(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({},Qr,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let n;if(this.seek(this._nextIFD),e)n=new $r;else{if(!t.kind)throw new Error("kind is missing");n=new Br(t.kind)}const r=this.readUint16();for(let i=0;i<r;i++)this.decodeIFDEntry(n);if(!t.ignoreImageData){if(!(n instanceof $r))throw new Error("must be a tiff ifd");this.decodeImageData(n)}return this._nextIFD=this.readUint32(),n}decodeIFDEntry(t){const e=this.offset,n=this.readUint16(),r=this.readUint16(),i=this.readUint32();if(r<1||r>12)return void this.skip(4);const a=function(t,e){const n=Vr.get(t);if(!n)throw new Error(`type not found: ${t}`);return n[0]*e}(r,i);a>4&&this.seek(this.readUint32());const o=function(t,e,n){const r=Vr.get(e);if(!r)throw new Error(`type not found: ${e}`);return r[1](t,n)}(this,r,i);if(t.fields.set(n,o),34665===n||34853===n){let e=this.offset,r="exif";34665===n?r="exif":34853===n&&(r="gps"),this._nextIFD=o,t[r]=this.decodeIFD({kind:r,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw ti("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw ti("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,n=Math.pow(2,e)-1;for(let r=0;r<t.data.length;r++)t.data[r]=n-t.data[r]}}readStripData(t){const e=t.width,n=t.height,r=t.bitsPerSample,i=t.sampleFormat,a=e*n*t.samplesPerPixel,o=function(t,e,n){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===n)return new Float32Array(t);throw ti("bit depth / sample format",`${e} / ${n}`)}(a,r,i),s=t.rowsPerStrip*e*t.samplesPerPixel,l=t.stripOffsets,h=t.stripByteCounts||function(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}(t);let c=a,u=0;for(let d=0;d<l.length;d++){let e=new DataView(this.buffer,this.byteOffset+l[d],h[d]),n=c>s?s:c;c-=n;let a=e;switch(t.compression){case 1:break;case 5:a=Wr(e);break;case 8:a=Kr(e);break;case 2:throw ti("Compression","CCITT Group 3");case 32773:throw ti("Compression","PackBits");default:throw ti("Compression",t.compression)}u=this.fillUncompressed(r,i,o,a,u,n)}t.data=o}fillUncompressed(t,e,n,r,i,a){if(8===t)return function(t,e,n,r){for(let i=0;i<r;i++)t[n++]=e.getUint8(i);return n}(n,r,i,a);if(16===t)return function(t,e,n,r,i){for(let a=0;a<2*r;a+=2)t[n++]=e.getUint16(a,i);return n}(n,r,i,a,this.isLittleEndian());if(32===t&&3===e)return function(t,e,n,r,i){for(let a=0;a<4*r;a+=4)t[n++]=e.getFloat32(a,i);return n}(n,r,i,a,this.isLittleEndian());throw ti("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)!function(t,e,n){let r=0;for(;r<t.length;){for(let i=n;i<e*n;i+=n)for(let e=0;e<n;e++)t[r+i+e]=t[r+i+e]+t[r+i-(n-e)]&255;r+=e*n}}(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);!function(t,e,n){let r=0;for(;r<t.length;){for(let i=n;i<e*n;i+=n)for(let e=0;e<n;e++)t[r+i+e]=t[r+i+e]+t[r+i-(n-e)]&65535;r+=e*n}}(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:n,maxSampleValue:r}=t;for(let t=0;t<e.length;t+=n){const i=e[t+n-1];for(let a=0;a<n-1;a++)e[t+a]=Math.round(e[t+a]*r/i)}}}}function ti(t,e){return new Error(`Unsupported ${t}: ${e}`)}function ei(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="matchToPrevious",ignoreBorder:n=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let r="matchToPrevious"===e,i=this[0],a=[];a[0]={position:[0,0],image:this[0]};let o=[0,0];for(let d=1;d<this.length;d++){let t=i.getBestMatch(this[d],{border:n});a[d]={position:[t[0]+o[0],t[1]+o[1]],image:this[d]},r&&(o[0]+=t[0],o[1]+=t[1],i=this[d])}let s=0,l=0,h=0,c=0;for(let d=0;d<a.length;d++){let t=a[d];t.position[0]>s&&(s=t.position[0]),t.position[0]<l&&(l=t.position[0]),t.position[1]>h&&(h=t.position[1]),t.position[1]<c&&(c=t.position[1])}l=0-l,c=0-c;for(let d=0;d<a.length;d++){let t=a[d];t.crop=t.image.crop({x:s-t.position[0],y:h-t.position[1],width:i.width-l-s,height:i.height-c-h})}let u=[];for(let d=0;d<a.length;d++)u[d]=a[d].crop;return new fi(u)}function ni(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let n=0;n<t.length;n++)t[n]=Math.min(t[n],this[e].min[n]);return t}function ri(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let n=0;n<t.length;n++)t[n]=Math.max(t[n],this[e].max[n]);return t}function ii(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let n,r=0,i=0,a=e/2;for(;;){if(t[r]>0){if(void 0!==n)return(n+r)/2;if(i+=t[r],i>a)return r;i===a&&(n=r)}r++}}function ai(t){let e=0,n=0;for(let r=0;r<t.length;r++)e+=t[r],n+=t[r]*r;return 0===e?0:n/e}function oi(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let r=t[n];e[n]=ii(r)}return e}function si(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let n=1;n<this.length;n++){let r=this[n].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=r[t]}return e}function li(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),n=e[0].length;for(let r=1;r<this.length;r++){let i=this[r].getHistograms(t);for(let t=0;t<e.length;t++)for(let r=0;r<n;r++)e[t][r]+=i[t][r]}return e}function hi(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let r=0;r<this.length;r++){let e=this[r];for(let n=0;n<this[0].data.length;n++)t[n]+=e.data[n]}let e=El.createFrom(this[0]),n=e.data;for(let r=0;r<this[0].data.length;r++)n[r]=t[r]/this.length;return e}function ci(){this.checkProcessable("max",{bitDepth:[8,16]});let t=El.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let n=0;n<t.data.length;n++)t.data[n]=Math.max(e.data[n],t.data[n]);return t}function ui(){this.checkProcessable("max",{bitDepth:[8,16]});let t=El.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let n=0;n<t.data.length;n++)t.data[n]=Math.min(e.data[n],t.data[n]);return t}let di={configurable:!0,enumerable:!1,get:void 0};class fi extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"===typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(El.load)).then((t=>new fi(t)))}static extendMethod(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{inPlace:r=!1,returnThis:i=!0,partialArgs:a=[]}=n;return fi.prototype[t]=r?function(){this.computed=null;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];let o=e.apply(this,[...a,...n]);return i?this:o}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(this,[...a,...n])},fi}static extendProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{partialArgs:r=[]}=n;return di.get=function(){if(null===this.computed)this.computed={};else if(wr()(t,this.computed))return this.computed[t];let n=e.apply(this,r);return this.computed[t]=n,n},Object.defineProperty(fi.prototype,t,di),fi}checkProcessable(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!==typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let n=1;n<this.length;n++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[n].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[n].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[n].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[n].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[n].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[n].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(fi.prototype.map=function(t,e){if("function"!==typeof t)throw new TypeError(`${t} is not a function`);let n=new fi(this.length);for(let r=0;r<this.length;r++)n[r]=t.call(e,this[r],r,this);return n}),function(t){t.extendMethod("matchAndCrop",ei),t.extendMethod("getMin",ni),t.extendMethod("getMax",ri),t.extendMethod("getMedian",oi),t.extendMethod("getHistogram",si),t.extendMethod("getHistograms",li),t.extendMethod("getAverage",hi),t.extendMethod("getAverageImage",hi),t.extendMethod("getMaxImage",ci),t.extendMethod("getMinImage",ui)}(fi);const mi=/^data:[a-z]+\/(?:[a-z]+);base64,/;function pi(t,e,n){const r=Ir()(t);if(r)switch(r.mime){case"image/png":return function(t){const e=function(t,e){return new $n(t,e).decode()}(t);let n,r=e.channels,i=0;2===r||4===r?(n=r-1,i=1):n=r;if(e.palette)return function(t){const e=t.width*t.height,n=t.palette[0].length,r=new Uint8Array(e*n),i=8/t.depth,a=t.depth<8?i:1,o=parseInt("1".repeat(t.depth),2),s=4===n;let l=0;for(let h=0;h<e;h++){const e=Math.floor(h/a);let n=t.data[e];t.depth<8&&(n=n>>>t.depth*(i-1-h%i)&o);const c=t.palette[n];r[l++]=c[0],r[l++]=c[1],r[l++]=c[2],s&&(r[l++]=c[3])}return new El(t.width,t.height,r,{components:3,alpha:s,bitDepth:8})}(e);return new El(e.width,e.height,e.data,{components:n,alpha:i,bitDepth:e.depth})}(t);case"image/jpeg":return function(t){const e=(0,Tr.decode)(t);let n;e.exif&&(n=gi(e.exif));const r=(0,lr.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let i=new El(r.width,r.height,r.data,{meta:n});if(n&&n.tiff.tags.Orientation){const t=n.tiff.tags.Orientation;t>2&&(i=i.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(i=i.flipX())}return i}(t);case"image/tiff":return function(t,e){let n=function(t,e){return new Jr(t).decode(e)}(t);return 1===n.length?vi(n[0],e):new fi(n.map((function(t){return vi(t,e)})))}(t,n);default:return _i(i(r.mime))}return _i(i("application/octet-stream"));function i(n){return e||ur(t,n)}}function gi(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function vi(t,e){if(e||3!==t.type)return new El(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?xr:br,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:gi(t)});{const e=new Uint16Array(3*t.width*t.height),n=t.palette;let r=0;for(let i=0;i<t.data.length;i++){const a=n[t.data[i]];e[r++]=a[0],e[r++]=a[1],e[r++]=a[2]}return new El(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:xr,bitDepth:16,meta:gi(t)})}}function _i(t,e){return e=e||{},new Promise((function(n,r){let i=new fr;i.onload=function(){let t=i.width,r=i.height,a=mr(t,r).getContext("2d");a.drawImage(i,0,0,t,r);let o=a.getImageData(0,0,t,r).data;n(new El(t,r,o,e))},i.onerror=function(){r(new Error(`Could not load ${t}`))},i.src=t}))}const wi={getValueXY(t,e,n){return this.data[(e*this.width+t)*this.channels+n]},setValueXY(t,e,n,r){return this.data[(e*this.width+t)*this.channels+n]=r,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,n){return this.data[t*this.channels+e]=n,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,n){return this.setPixel(e*this.width+t,n)},getPixel(t){const e=new Array(this.channels),n=t*this.channels;for(let r=0;r<this.channels;r++)e[r]=this.data[n+r];return e},setPixel(t,e){const n=t*this.channels;for(let r=0;r<e.length;r++)this.data[n+r]=e[r];return this.computed=null,this}};function yi(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function bi(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{out:i}=e;if(void 0===i)return r.copy?t.clone():El.createFrom(t,n);{if(!El.isImage(i))throw new TypeError("out must be an Image object");const e=Object.assign(yi(t),n);for(const t in e)if(i[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${i[t]}")`);return i}}function xi(t,e,n){if(void 0!==e.inPlace&&"boolean"!==typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return bi(t,e,null,n)}function Mi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("abs",{bitDepth:[32]});const e=xi(this,t);return function(t,e){for(let n=0;n<t.data.length;n++)e.data[n]=Math.abs(t.data[n])}(this,e),e}function Si(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=xi(this,t);return 1===this.bitDepth?function(t,e){for(let n=0;n<t.data.length;n++)e.data[n]=~t.data[n]}(this,e):(function(t,e){for(let n=0;n<t.data.length;n+=t.channels)for(let r=0;r<t.components;r++)e.data[n+r]=t.maxValue-t.data[n+r]}(this,e),this!==e&&function(t,e){if(1===t.alpha&&1===e.alpha)for(let n=0;n<t.size;n++)e.data[n*e.channels+e.components]=t.data[n*t.channels+t.components]}(this,e)),e}function Ei(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let n=t*this.channels+e,r=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[n+t];this.data[n+t]=this.data[r+t],this.data[r+t]=e}}}return this}function ki(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let n=e*this.channels+t*this.width*this.channels,r=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[n+t];this.data[n+t]=this.data[r+t],this.data[r+t]=e}}return this}function Ci(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const n=2*e+1,r=new Array(n);for(let i=0;i<n;i++){r[i]=new Array(n);for(let t=0;t<n;t++)r[i][t]=1/(n*n)}return this.convolution(r)}var Ai=n(9080),Pi=n.n(Ai);function Ti(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n,allowAlpha:r,defaultAlpha:i}=e;return"boolean"!==typeof r&&(r=!0),"undefined"===typeof n?function(t,e){let n=e?t.channels:t.components,r=new Array(n);for(let i=0;i<n;i++)r[i]=i;return r}(t,i):function(t,e,n){Array.isArray(e)||(e=[e]);for(let r=0;r<e.length;r++)e[r]=Di(t,e[r],n);return e}(t,n,r)}function Di(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"===typeof e){switch(t.colorModel){case br:break;case xr:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case Mr:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case Sr:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case Er:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"===typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!n&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function Ii(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{radius:e=1,border:n="copy",channels:r}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");r=Ti(this,r,!0);let i=e,a=e,o=El.createFrom(this),s=new Array((2*i+1)*(2*a+1));for(let l=0;l<r.length;l++){let t=r[l];for(let e=a;e<this.height-a;e++)for(let n=i;n<this.width-i;n++){let r=0;for(let o=-a;o<=a;o++)for(let a=-i;a<=i;a++){let i=((e+o)*this.width+n+a)*this.channels+t;s[r++]=this.data[i]}let l=(e*this.width+n)*this.channels+t;o.data[l]=Pi()(s)}}if(this.alpha&&!r.includes(this.channels))for(let l=this.components;l<this.data.length;l+=this.channels)o.data[l]=this.data[l];return o.setBorder({size:[i,a],algorithm:n}),o}function Ni(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{radius:e=1,sigma:n,channels:r,border:i="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const a=function(t,e){const n=2*t+1,r=new Array(n),i=e||.3*(.5*(n-1)-1)+.8,a=-.5/(i*i);let o=0;for(let s=0;s<n;s++){const e=s-t,n=Math.exp(a*e*e);r[s]=n,o+=n}for(let s=0;s<n;s++)r[s]/=o;return r}(e,n);return this.convolution([a,a],{border:i,channels:r,algorithm:"separable"})}const Ri=[[0,1,0],[1,-4,1],[0,1,0]],Li=[[1,1,1],[1,-8,1],[1,1,1]],Ui=[[-1,0,1],[-2,0,2],[-1,0,1]],Oi=[[-1,-2,-1],[0,0,0],[1,2,1]],zi=[[3,0,-3],[10,0,-10],[3,0,-3]],Fi=[[3,10,3],[0,0,0],[-3,-10,-3]],Bi=[[-1,-2,0,2,1],[-2,-4,0,4,2],[0,0,0,0,0],[1,2,0,-2,-1],[2,4,0,-4,-2]],Vi=[[1,2,0,-2,-1],[2,4,0,-4,-2],[0,0,0,0,0],[-2,-4,0,4,2],[-1,-2,0,2,1]];var Hi=n(8239),Gi=n(9867),ji=n.n(Gi);function Yi(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function Xi(t,e,n){if(void 0===n){const r=t.length+e.length-1;n=new Array(r)}!function(t){for(var e=0;e<t.length;e++)t[e]=0}(n);for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)n[r+i]+=t[r]*e[i];return n}n(6849),n(3122);function Wi(t,e,n,r){const i=new Array(t.length);let a,o,s,l;l=e[1],s=(l.length-1)/2,o=new Array(n+l.length-1),a=new Array(n);for(let h=0;h<r;h++){for(let e=0;e<n;e++)a[e]=t[h*n+e];Xi(a,l,o);for(let t=0;t<n;t++)i[h*n+t]=o[s+t]}l=e[0],s=(l.length-1)/2,o=new Array(r+l.length-1),a=new Array(r);for(let h=0;h<n;h++){for(let t=0;t<r;t++)a[t]=i[t*n+h];Xi(a,l,o);for(let t=0;t<r;t++)i[t*n+h]=o[s+t]}return i}var qi=n(6832);qi.AbstractMatrix,qi.CHO,qi.CholeskyDecomposition,qi.DistanceMatrix,qi.EVD,qi.EigenvalueDecomposition,qi.LU,qi.LuDecomposition;const $i=qi.Matrix,Zi=(qi.MatrixColumnSelectionView,qi.MatrixColumnView,qi.MatrixFlipColumnView,qi.MatrixFlipRowView,qi.MatrixRowSelectionView,qi.MatrixRowView,qi.MatrixSelectionView,qi.MatrixSubView,qi.MatrixTransposeView,qi.NIPALS,qi.Nipals,qi.QR,qi.QrDecomposition,qi.SVD),Ki=qi.SingularValueDecomposition,Qi=(qi.SymmetricMatrix,qi.WrapperMatrix1D,qi.WrapperMatrix2D,qi.correlation,qi.covariance,qi.Matrix,qi.Matrix,qi.determinant,qi.inverse),Ji=(qi.linearDependencies,qi.pseudoInverse,qi.solve);qi.wrap;function ta(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n,bitDepth:r,normalize:i=!1,divisor:a=1,border:o="copy",algorithm:s="auto"}=e,l={};r&&(l.bitDepth=r);let h,c,u=El.createFrom(this,l);if(n=Ti(this,n,!0),"separable"!==s)({kernel:t}=function(t){let e,n;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0===(1&t.length)||0===(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),n=Math.floor(t[0].length/2)}else{let r=Math.sqrt(t.length);if(!ji()(r))throw new RangeError("validateKernel: Kernel array should be a square");n=e=Math.floor(Math.sqrt(t.length)/2);let i=new Array(r);for(let e=0;e<r;e++){i[e]=new Array(r);for(let n=0;n<r;n++)i[e][n]=t[e*r+n]}t=i}return{kernel:t,kWidth:n,kHeight:e}}(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===s){let e=function(t){const e=new Zi(t,{autoTranspose:!0});if(1!==e.rank)return null;const n=Math.sqrt(e.s[0]);return[e.U.to2DArray().map((t=>t[0]*n)),e.V.to2DArray().map((t=>t[0]*n))]}(t);null!==e?(s="separable",t=e):s=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===s?(h=Math.floor(t[0].length/2),c=Math.floor(t[1].length/2)):(h=Math.floor(t.length/2),c=Math.floor(t[0].length/2));let d,f,m,p,g,v,_=u.isClamped,w=new Array(this.height*this.width);for(p=0;p<n.length;p++){for(g=n[p],m=0;m<this.height;m++)for(f=0;f<this.width;f++)d=m*this.width+f,w[d]=this.data[d*this.channels+g];if("direct"===s)v=(0,Hi.direct)(w,t,{rows:this.height,cols:this.width,normalize:i,divisor:a});else if("separable"===s){if(v=Wi(w,t,this.width,this.height),i){a=0;for(let e=0;e<t[0].length;e++)for(let n=0;n<t[1].length;n++)a+=t[0][e]*t[1][n]}if(1!==a)for(let t=0;t<v.length;t++)v[t]/=a}else v=(0,Hi.fft)(w,t,{rows:this.height,cols:this.width,normalize:i,divisor:a});for(m=0;m<this.height;m++)for(f=0;f<this.width;f++)d=m*this.width+f,u.data[d*this.channels+g]=_?Yi(v[d],u):v[d]}if(this.alpha&&!n.includes(this.channels))for(f=this.components;f<this.data.length;f+=this.channels)u.data[f]=this.data[f];return"periodic"!==o&&u.setBorder({size:[c,h],algorithm:o}),u}function ea(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{direction:e="xy",border:n="copy",kernelX:r,kernelY:i,channels:a,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!r)throw new Error("kernelX option is missing");return ta.call(this,r,{channels:a,border:n,bitDepth:o});case"y":if(!i)throw new Error("kernelY option is missing");return ta.call(this,i,{channels:a,border:n,bitDepth:o});case"xy":{if(!r)throw new Error("kernelX option is missing");if(!i)throw new Error("kernelY option is missing");const t=ta.call(this,r,{channels:a,border:n,bitDepth:32}),e=ta.call(this,i,{channels:a,border:n,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:a})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function na(t){return ea.call(this,Object.assign({},t,{kernelX:Ui,kernelY:Oi}))}function ra(t){return ea.call(this,Object.assign({},t,{kernelX:zi,kernelY:Fi}))}var ia=n(5198),aa=n.n(ia);function oa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="range",channels:n,min:r=this.min,max:i=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),n=Ti(this,{channels:n}),n.length!==this.channel&&(Array.isArray(r)&&r.length===this.channels&&(r=r.filter(((t,e)=>n.includes(e)))),Array.isArray(i)&&i.length===this.channels&&(i=i.filter(((t,e)=>n.includes(e))))),"range"!==e)throw new Error(`level: algorithm not implement: ${e}`);return r<0&&(r=0),i>this.maxValue&&(i=this.maxValue),Array.isArray(r)||(r=aa()(n.length,r)),Array.isArray(i)||(i=aa()(n.length,i)),function(t,e,n,r){let i=1e-5,a=new Array(r.length);for(let o=0;o<r.length;o++)0===e[o]&&n[o]===t.maxValue||n[o]===e[o]?a[o]=0:a[o]=(t.maxValue+1-i)/(n[o]-e[o]),e[o]+=(.5-i/2)/a[o];for(let o=0;o<r.length;o++){let n=r[o];if(0!==a[o])for(let r=0;r<t.data.length;r+=t.channels)t.data[r+n]=Math.min(Math.max(0,(t.data[r+n]-e[o])*a[o]+.5|0),t.maxValue)}}(this,r,i,n),this}var sa=n(2516),la=n.n(sa);function ha(t){if(isNaN(t)){if(t instanceof El)return t.data;if(!la()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function ca(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),n=Ti(this,{channels:n}),t=ha(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<n.length;e++){let r=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]+t[e+r]|0))}}else for(let r=0;r<n.length;r++){let e=n[r];for(let n=0;n<this.data.length;n+=this.channels)this.data[n+e]=Math.min(this.maxValue,this.data[n+e]+t|0)}return this}function ua(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),n=Ti(this,{channels:n}),t=ha(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<n.length;e++){let r=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]-t[e+r]|0))}}else for(let r=0;r<n.length;r++){let e=n[r];for(let n=0;n<this.data.length;n+=this.channels)this.data[n+e]=Math.max(0,this.data[n+e]-t|0)}return this}function da(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n,absolute:r=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let i=this.clone();n=Ti(this,{channels:n});for(let a=0;a<n.length;a++){for(let e=n[a];e<this.data.length;e+=this.channels){let n=this.data[e]-t.data[e];i.data[e]=r?Math.abs(n):Math.max(n,0)}}return i}function fa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{bitDepth:n=this.bitDepth,channels:r}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let i=El.createFrom(this,{bitDepth:n});r=Ti(this,{channels:r});let a=i.isClamped;for(let o=0;o<r.length;o++){for(let e=r[o];e<this.data.length;e+=this.channels){let n=Math.hypot(this.data[e],t.data[e]);i.data[e]=a?Math.min(Math.max(Math.round(n),0),i.maxValue):n}}return i}function ma(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(n=Ti(this,{channels:n}),t=ha(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<n.length;e++){let r=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]*t[e+r]|0))}}else for(let r=0;r<n.length;r++){let e=n[r];for(let n=0;n<this.data.length;n+=this.channels)this.data[n+e]=Math.min(this.maxValue,this.data[n+e]*t|0)}return this}function pa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:n}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),n=Ti(this,{channels:n}),t=ha(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<n.length;e++){let r=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]/t[e+r]|0))}}else for(let r=0;r<n.length;r++){let e=n[r];for(let n=0;n<this.data.length;n+=this.channels)this.data[n+e]=Math.min(this.maxValue,this.data[n+e]/t|0)}return this}var ga=n(6889);class va{constructor(){if(new.target===va)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"===typeof t)return this._predict(t);if((0,ga.isAnyArray)(t)){const e=[];for(let n=0;n<t.length;n++)e.push(this._predict(t[n]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,ga.isAnyArray)(t)||!(0,ga.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const n=t.length,r=new Array(n);for(let d=0;d<n;d++)r[d]=this._predict(t[d]);let i=0,a=0,o=0,s=0,l=0,h=0,c=0;for(let d=0;d<n;d++)i+=r[d],a+=e[d],l+=r[d]*r[d],h+=e[d]*e[d],c+=r[d]*e[d],0!==e[d]&&(o+=(e[d]-r[d])*(e[d]-r[d])/e[d]),s+=(e[d]-r[d])*(e[d]-r[d]);const u=(n*c-i*a)/Math.sqrt((n*l-i*i)*(n*h-a*a));return{r:u,r2:u*u,chi2:o,rmsd:Math.sqrt(s/n)}}}var _a=n(47),wa=n.n(_a);const ya={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class ba extends va{constructor(t,e,n){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(wa())(e.kernelType,e.kernelOptions);else{t=$i.checkMatrix(t),n=Object.assign({},ya,n);const r=new(wa())(n.kernelType,n.kernelOptions),i=r.compute(t),a=t.rows;i.add($i.eye(a,a).mul(n.lambda)),this.alpha=Ji(i,e),this.inputs=t,this.kernelType=n.kernelType,this.kernelOptions=n.kernelOptions,this.kernel=r}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new ba(!0,t)}}function xa(t,e,n){const r=new ba(t,e,n),i=new Array(this.size);for(let s=0;s<this.width;s++)for(let t=0;t<this.height;t++)i[t*this.width+s]=[s,t];const a=r.predict(i),o=El.createFrom(this);for(let s=0;s<this.size;s++)o.data[s]=Math.min(this.maxValue,Math.max(0,a[s][0]));return o}function Ma(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let r=!0;t:for(const a of e)for(const t of a)if(1!==t){r=!1;break t}let i=this;for(let a=0;a<n;a++)if(1===this.bitDepth)if(r){const t=i.clone();i=Ca(i,t,e.length,e[0].length)}else{i=ka(i,El.createFrom(i),e)}else if(r){i=Ea(i,El.createFrom(i),e.length,e[0].length)}else{i=Sa(i,El.createFrom(i),e)}return i}function Sa(t,e,n){const r=n.length,i=n[0].length;let a=(r-1)/2,o=(i-1)/2;for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){let h=0;for(let e=0;e<i;e++)for(let i=0;i<r;i++){if(1!==n[i][e])continue;let r=i-a+l,c=e-o+s;if(r<0||c<0||r>=t.width||c>=t.height)continue;const u=t.getValueXY(r,c,0);u>h&&(h=u)}e.setValueXY(l,s,0,h)}return e}function Ea(t,e,n,r){const i=(n-1)/2,a=(r-1)/2,o=[];for(let s=0;s<t.width;s++)o.push(0);for(let s=0;s<t.height;s++){for(let e=0;e<t.width;e++){let n=0;for(let r=Math.max(0,s-a);r<Math.min(t.height,s+a+1);r++){const i=t.getValueXY(e,r,0);i>n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let r=0;for(let e=Math.max(0,n-i);e<Math.min(t.width,n+i+1);e++)o[e]>r&&(r=o[e]);e.setValueXY(n,s,0,r)}}return e}function ka(t,e,n){const r=n.length,i=n[0].length;let a=(r-1)/2,o=(i-1)/2;for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){let h=0;t:for(let e=0;e<i;e++)for(let i=0;i<r;i++){if(1!==n[i][e])continue;let r=i-a+l,c=e-o+s;if(c<0||r<0||r>=t.width||c>=t.height)continue;if(1===t.getBitXY(r,c)){h=1;break t}}1===h&&e.setBitXY(l,s)}return e}function Ca(t,e,n,r){const i=(n-1)/2,a=(r-1)/2,o=[];for(let s=0;s<t.width;s++)o.push(1);for(let s=0;s<t.height;s++){for(let e=0;e<t.width;e++){o[e]=0;for(let n=Math.max(0,s-a);n<Math.min(t.height,s+a+1);n++)if(1===t.getBitXY(e,n)){o[e]=1;break}}for(let n=0;n<t.width;n++)if(1!==e.getBitXY(n,s))for(let r=Math.max(0,n-i);r<Math.min(t.width,n+i+1);r++)if(1===o[r]){e.setBitXY(n,s);break}}return e}function Aa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let r=!0;t:for(const a of e)for(const t of a)if(1!==t){r=!1;break t}let i=this;for(let a=0;a<n;a++)if(1===this.bitDepth)if(r){const t=i.clone();i=Ia(i,t,e.length,e[0].length)}else{i=Da(i,El.createFrom(i),e)}else if(r){i=Ta(i,El.createFrom(i),e.length,e[0].length)}else{i=Pa(i,El.createFrom(i),e)}return i}function Pa(t,e,n){const r=n.length,i=n[0].length;let a=(r-1)/2,o=(i-1)/2;for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){let h=t.maxValue;for(let e=0;e<i;e++)for(let i=0;i<r;i++){if(1!==n[i][e])continue;let r=i-a+l,c=e-o+s;if(r<0||c<0||r>=t.width||c>=t.height)continue;const u=t.getValueXY(r,c,0);u<h&&(h=u)}e.setValueXY(l,s,0,h)}return e}function Ta(t,e,n,r){const i=(n-1)/2,a=(r-1)/2,o=[];for(let s=0;s<t.width;s++)o.push(0);for(let s=0;s<t.height;s++){for(let e=0;e<t.width;e++){let n=t.maxValue;for(let r=Math.max(0,s-a);r<Math.min(t.height,s+a+1);r++){const i=t.getValueXY(e,r,0);i<n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let r=t.maxValue;for(let e=Math.max(0,n-i);e<Math.min(t.width,n+i+1);e++)o[e]<r&&(r=o[e]);e.setValueXY(n,s,0,r)}}return e}function Da(t,e,n){const r=n.length,i=n[0].length;let a=(r-1)/2,o=(i-1)/2;for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){let h=1;t:for(let e=0;e<i;e++)for(let i=0;i<r;i++){if(1!==n[i][e])continue;let r=i-a+l,c=e-o+s;if(c<0||r<0||r>=t.width||c>=t.height)continue;if(0===t.getBitXY(r,c)){h=0;break t}}1===h&&e.setBitXY(l,s)}return e}function Ia(t,e,n,r){const i=(n-1)/2,a=(r-1)/2,o=[];for(let s=0;s<t.width;s++)o.push(0);for(let s=0;s<t.height;s++){for(let e=0;e<t.width;e++){o[e]=1;for(let n=Math.max(0,s-a);n<Math.min(t.height,s+a+1);n++)if(0===t.getBitXY(e,n)){o[e]=0;break}}for(let n=0;n<t.width;n++)if(0!==e.getBitXY(n,s))for(let r=Math.max(0,n-i);r<Math.min(t.width,n+i+1);r++)if(0===o[r]){e.clearBitXY(n,s);break}}return e}function Na(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let r=this;for(let i=0;i<n;i++)r=r.erode({kernel:e}),r=r.dilate({kernel:e});return r}function Ra(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let r=this;for(let i=0;i<n;i++)r=r.dilate({kernel:e}).erode({kernel:e});return r}function La(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2===0||e[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let r=this;for(let i=0;i<n;i++){let t=r.open({kernel:e});r=t.subtractImage(r,{absolute:!0})}return r}function Ua(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let r=this;for(let i=0;i<n;i++){const t=r.close({kernel:e});r=t.subtractImage(r,{absolute:!0})}return r}function Oa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let r=this;for(let i=0;i<n;i++){let t=r.dilate({kernel:e}),n=r.erode({kernel:e});r=t.subtractImage(n,{absolute:!0})}return r}function za(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Fa(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ba(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Va(t,e,n,r,i,a,o,s,l,h,c,u){let[d,f]=[(n*t+r*e+i)/(l*t+h*e+1),(a*t+o*e+s)/(l*t+h*e+1)];return c.getValueXY(Math.floor(d),Math.floor(f),u)}function Ha(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{calculateRatio:n=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let r,i,[a,o,s,l]=t,h=[a,o,s,l],[c,u,d,f]=function(t){let e=0,n=0,r=0,i=0,a=t[0][0],o=0;for(let h=1;h<t.length;h++)t[h][0]<a&&(a=t[h][0],o=h);let s=t[(o+1)%t.length][0],l=(o+1)%t.length;for(let h=1;h<t.length;h++)t[h][0]<s&&h!==o&&(s=t[h][0],l=h);return t[l][1]<t[o][1]?(e=t[l],i=t[o],o!==(l+1)%4?(n=t[(l+1)%4],r=t[(l+2)%4]):(n=t[(l+2)%4],r=t[(l+3)%4])):(i=t[l],e=t[o],l!==(o+1)%4?(n=t[(o+1)%4],r=t[(o+2)%4]):(n=t[(o+2)%4],r=t[(o+3)%4])),[e,n,r,i]}(h);n?[r,i]=function(t,e,n,r,i,a){let o=Math.max(za(t,e),za(r,n)),s=Math.max(za(t,r),za(e,n)),l=0,h=0,c=Math.ceil(i/2),u=Math.ceil(a/2),d=o/s,f=[t[0],t[1],1],m=[e[0],e[1],1],p=[r[0],r[1],1],g=[n[0],n[1],1],v=Ba(Fa(f,g),p)/Ba(Fa(m,g),p),_=Ba(Fa(f,g),m)/Ba(Fa(p,g),m),w=[v*m[0]-f[0],v*m[1]-f[1],v*m[2]-f[2]],y=[_*p[0]-f[0],_*p[1]-f[1],_*p[2]-f[2]],b=w[0],x=w[1],M=w[2],S=y[0],E=y[1],k=y[2],C=1/(M*k)*(b*S-(b*k+M*S)*c+M*k*c*c+(x*E-(x*k+M*E)*u+M*k*u*u));C=C>=0?Math.sqrt(C):Math.sqrt(-C);let A=new $i([[C,0,c],[0,C,u],[0,0,1]]),P=A.transpose(),T=Qi(P),D=Qi(A),I=$i.rowVector(w),N=$i.rowVector(y),R=Math.sqrt(Ba(I.mmul(T).mmul(D).to1DArray(),w)/Ba(N.mmul(T).mmul(D).to1DArray(),y));return 0===R||0===d?(l=Math.ceil(o),h=Math.ceil(s)):R<d?(l=Math.ceil(o),h=Math.ceil(l/R)):(h=Math.ceil(s),l=Math.ceil(R*h)),[l,h]}(c,u,d,f,this.width,this.height):(r=Math.ceil(Math.max(za(c,u),za(f,d))),i=Math.ceil(Math.max(za(c,f),za(u,d))));let m=El.createFrom(this,{width:r,height:i}),[p,g]=c,[v,_]=u,[w,y]=d,[b,x]=f,[M,S]=[0,0],[E,k]=[0,r-1],[C,A]=[i-1,r-1],[P,T]=[i-1,0],D=new $i([[M,S,1,0,0,0,-M*p,-S*p],[E,k,1,0,0,0,-E*v,-k*v],[C,A,1,0,0,0,-C*w,-S*w],[P,T,1,0,0,0,-P*b,-T*b],[0,0,0,M,S,1,-M*g,-S*g],[0,0,0,E,k,1,-E*_,-k*_],[0,0,0,C,A,1,-C*y,-A*y],[0,0,0,P,T,1,-P*x,-T*x]]),I=$i.columnVector([p,v,w,b,g,_,y,x]),N=new Ki(D).solve(I),[R,L,U,O,z,F,B,V]=N.to1DArray(),H=new $i(i,r);for(let G=0;G<this.channels;G++){for(let t=0;t<i;t++)for(let e=0;e<r;e++)H.set(t,e,Va(t,e,R,L,U,O,z,F,B,V,this,G));m.setMatrix(H,{channel:G})}return m}function Ga(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:e=0,y:n=0,width:r=this.width-e,height:i=this.height-n}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),n=Math.round(n),r=Math.round(r),i=Math.round(i),e>this.width-1||n>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${n}) out of range (${this.width-1}; ${this.height-1})`);if(r<=0||i<=0)throw new RangeError(`crop: width and height (width:${r}; height:${i}) must be positive numbers`);if(e<0||n<0)throw new RangeError(`crop: x and y (x:${e}, y:${n}) must be positive numbers`);if(r>this.width-e||i>this.height-n)throw new RangeError(`crop: (x: ${e}, y:${n}, width:${r}, height:${i}) size is out of range`);let a=this;if(1===this.bitDepth){a=function(t,e,n,r,i,a){let o=i*t.channels,s=r+a,l=0,h=n*t.channels;for(let c=r;c<s;c++){let n=c*t.width*t.channels+h,r=n+o;for(;n<r;n++)t.getBit(n)&&e.setBit(l),++l}return e}(this,new El(r,i,{kind:"BINARY",parent:this}),e,n,r,i)}else{a=function(t,e,n,r,i,a){let o=i*t.channels,s=r+a,l=0,h=n*t.channels;for(let c=r;c<s;c++){let n=c*t.width*t.channels+h,r=n+o;for(;n<r;n++)e.data[l++]=t.data[n]}return e}(this,El.createFrom(this,{width:r,height:i,position:[e,n]}),e,n,r,i)}return a}function ja(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let n=function(t,e,n){for(let r=0;r<t.width;r++)for(let i=0;i<t.height;i++)if(t.getValueXY(r,i,n)>=e)return r;return-1}(this,e,this.components);if(-1===n)throw new Error("Could not find new dimensions. Threshold may be too high.");let r=function(t,e,n,r){for(let i=0;i<t.height;i++)for(let a=r;a<t.width;a++)if(t.getValueXY(a,i,n)>=e)return i;return-1}(this,e,this.components,n),i=function(t,e,n,r){for(let i=t.height-1;i>=0;i--)for(let a=r;a<t.width;a++)if(t.getValueXY(a,i,n)>=e)return i;return-1}(this,e,this.components,n),a=function(t,e,n,r,i,a){for(let o=t.width-1;o>=r;o--)for(let r=i;r<=a;r++)if(t.getValueXY(o,r,n)>=e)return o;return-1}(this,e,this.components,n,r,i);return this.crop({x:n,y:r,width:a-n+1,height:i-r+1})}function Ya(t,e,n){t=function(t){if("string"===typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}(t);let r=Math.round(t*e),i=Math.round(t*n);return r<=0&&(r=1),i<=0&&(i=1),{width:r,height:i}}function Xa(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const Wa={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function qa(t){if("string"!==typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!Wa[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return Wa[t]}function $a(t,e,n){const r=this.width/e,i=this.height/n;if(this.bitDepth>1)for(let a=0;a<e;a++){const e=Math.floor((a+.5)*r);for(let r=0;r<n;r++){const n=Math.floor((r+.5)*i);for(let i=0;i<this.channels;i++)t.setValueXY(a,r,i,this.getValueXY(e,n,i))}}else for(let a=0;a<e;a++){const e=Math.floor((a+.5)*r);for(let r=0;r<n;r++){const n=Math.floor((r+.5)*i);this.getBitXY(e,n)&&t.setBitXY(a,r)}}}function Za(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{factor:e=1,interpolation:n=Wa.nearestneighbor,preserveAspectRatio:r=!0}=t,i=qa(n);let a=t.width,o=t.height;if(a||(a=o&&r?Math.round(o*(this.width/this.height)):this.width),o||(o=r?Math.round(a*(this.height/this.width)):this.height),({width:a,height:o}=Ya(e,a,o)),a===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let s=Math.round((this.width-a)/2),l=Math.round((this.height-o)/2);const h=El.createFrom(this,{width:a,height:o,position:[s,l]});if(i!==Wa.nearestneighbor)throw new Error(`unsupported resize interpolation: ${i}`);return $a.call(this,h,a,o),h}function Ka(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[xr]});let t=El.createFrom(this,{colorModel:Sr}),e=0,n=this.data;for(let r=0;r<n.length;r+=this.channels){let i=n[r],a=n[r+1],o=n[r+2],s=Math.min(i,a,o),l=Math.max(i,a,o),h=l-s,c=0,u=0===l?0:h/l,d=l;if(l!==s){switch(l){case i:c=(a-o)/h+(a<o?6:0);break;case a:c=(o-i)/h+2;break;case o:c=(i-a)/h+4;break;default:throw new Error("unreachable")}c/=6}t.data[e++]=c*this.maxValue,t.data[e++]=u*this.maxValue,t.data[e++]=d,this.alpha&&(t.data[e++]=n[r+3])}return t}function Qa(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[xr]});let t=El.createFrom(this,{colorModel:Mr}),e=Math.floor(this.maxValue/2),n=0,r=this.data;for(let i=0;i<r.length;i+=this.channels){let a=r[i],o=r[i+1],s=r[i+2],l=Math.max(a,o,s),h=Math.min(a,o,s),c=0,u=0,d=(l+h)/2;if(l!==h){let t=l-h;switch(u=d>e?t/(2-l-h):t/(l+h),l){case a:c=(o-s)/t+(o<s?6:0);break;case o:c=(s-a)/t+2;break;case s:c=(a-o)/t+4;break;default:throw new Error("unreachable")}c/=6}t.data[n++]=c*this.maxValue,t.data[n++]=u*this.maxValue,t.data[n++]=d,this.alpha&&(t.data[n++]=r[i+3])}return t}function Ja(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[xr]});let t=El.createFrom(this,{components:4,colorModel:Er}),e=0,n=this.data;for(let r=0;r<n.length;r+=this.channels){let i=n[r],a=n[r+1],o=n[r+2],s=Math.min(this.maxValue-i,this.maxValue-a,this.maxValue-o),l=(this.maxValue-i-s)/(1-s/this.maxValue),h=(this.maxValue-a-s)/(1-s/this.maxValue),c=(this.maxValue-o-s)/(1-s/this.maxValue);t.data[e++]=Math.round(l),t.data[e++]=Math.round(h),t.data[e++]=Math.round(c),t.data[e++]=Math.round(s),this.alpha&&(t.data[e++]=n[r+3])}return t}function to(){return new El(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const eo={luma709:(t,e,n)=>6966*t+23436*e+2366*n>>15,luma601:(t,e,n)=>9798*t+19235*e+3735*n>>15,maximum:(t,e,n)=>Math.max(t,e,n),minimum:(t,e,n)=>Math.min(t,e,n),average:(t,e,n)=>(t+e+n)/3|0,minmax:(t,e,n)=>(Math.max(t,e,n)+Math.min(t,e,n))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,n)=>n,cyan(t,e,n,r){let i=eo.black(t,e,n,r);return(r.maxValue-t-i)/(1-i/r.maxValue)|0},magenta(t,e,n,r){let i=eo.black(t,e,n,r);return(r.maxValue-e-i)/(1-i/r.maxValue)|0},yellow(t,e,n,r){let i=eo.black(t,e,n,r);return(r.maxValue-n-i)/(1-i/r.maxValue)|0},black:(t,e,n,r)=>Math.min(r.maxValue-t,r.maxValue-e,r.maxValue-n),hue(t,e,n,r){let i=eo.min(t,e,n),a=eo.max(t,e,n);if(a===i)return 0;let o=0,s=a-i;switch(a){case t:o=(e-n)/s+(e<n?6:0);break;case e:o=(n-t)/s+2;break;case n:o=(t-e)/s+4;break;default:throw new Error("unreachable")}return o/6*r.maxValue|0},saturation(t,e,n,r){let i=eo.min(t,e,n),a=eo.max(t,e,n);return 0===a?0:(a-i)/a*r.maxValue},lightness(t,e,n){let r=eo.min(t,e,n);return(eo.max(t,e,n)+r)/2}};Object.defineProperty(eo,"luminosity",{enumerable:!1,value:eo.lightness}),Object.defineProperty(eo,"luminance",{enumerable:!1,value:eo.lightness}),Object.defineProperty(eo,"min",{enumerable:!1,value:eo.minimum}),Object.defineProperty(eo,"max",{enumerable:!1,value:eo.maximum}),Object.defineProperty(eo,"brightness",{enumerable:!1,value:eo.maximum});const no={};function ro(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="luma709",keepAlpha:n=!1,mergeAlpha:r=!0}=t;if("string"!==typeof e&&"function"!==typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),n&=this.alpha,r&=this.alpha,n&&(r=!1);let i,a=bi(this,t,{components:1,alpha:n,colorModel:br});if("function"===typeof e)i=e;else if(i=eo[e.toLowerCase()],!i)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let s=0;s<this.data.length;s+=this.channels)r?a.data[o++]=Yi(i(this.data[s],this.data[s+1],this.data[s+2],this)*this.data[s+this.components]/this.maxValue,this):(a.data[o++]=Yi(i(this.data[s],this.data[s+1],this.data[s+2],this),this),a.alpha&&(a.data[o++]=this.data[s+this.components]));return a}function io(t){let e=!1,n=0;for(let r=1;r<t.length-1;r++)if(t[r-1]<t[r]&&t[r+1]<t[r]&&(n++,n>2))return!1;return 2===n&&(e=!0),e}function ao(t,e){let n=0;for(let r=0;r<=e;r++)n+=t[r];return n}function oo(t,e){let n=0;for(let r=0;r<=e;r++)n+=r*t[r];return n}function so(t,e){let n=0;for(let r=0;r<=e;r++)n+=r*r*t[r];return n}function lo(t){let e=new Array(t.length);for(let n=1;n<t.length-1;n++)e[n]=(t[n-1]+t[n]+t[n+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function ho(t){let e=t.length,n=!1,r=0;for(let i=1;i<e-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(r++,r>2))return!1;return 2===r&&(n=!0),n}function co(t,e){let n=0;for(let r=0;r<=e;r++)n+=t[r];return n}Object.keys(eo).forEach((t=>{no[t]=t}));const uo={huang:function(t){let e=0;for(let c=0;c<t.length;c++)if(0!==t[c]){e=c;break}let n=t.length-1;for(let c=t.length-1;c>=e;c--)if(0!==t[c]){n=c;break}let r=1/(n-e),i=new Array(t.length),a=0,o=0;for(let c=e;c<t.length;c++)a+=c*t[c],o+=t[c],i[c]=a/o;let s=new Array(t.length);a=o=0;for(let c=n;c>0;c--)a+=c*t[c],o+=t[c],s[c-1]=a/o;let l=-1,h=Number.MAX_VALUE;for(let c=0;c<t.length;c++){let e,n=0;for(let a=0;a<=c;a++)e=1/(1+r*Math.abs(a-i[c])),e<1e-6||e>.999999||(n+=t[a]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));for(let i=c+1;i<t.length;i++)e=1/(1+r*Math.abs(i-s[c])),e<1e-6||e>.999999||(n+=t[i]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));n<h&&(h=n,l=c)}return l},intermodes:function(t){let e=t.slice(),n=0;for(;!io(e);){let r=0,i=0,a=e[0];for(let n=0;n<t.length-1;n++)r=i,i=a,a=e[n+1],e[n]=(r+i+a)/3;if(e[t.length-1]=(i+a)/3,n++,n>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let r=0;for(let i=1;i<t.length-1;i++)e[i-1]<e[i]&&e[i+1]<e[i]&&(r+=i);return Math.floor(r/2)},isodata:function(t){let e,n,r,i,a=0;for(let o=1;o<t.length;o++)if(t[o]>0){a=o+1;break}for(;;){e=0,r=0;for(let n=0;n<a;n++)r+=t[n],e+=t[n]*n;i=0,n=0;for(let e=a+1;e<t.length;e++)n+=t[e],i+=t[e]*e;if(r>0&&n>0&&(e/=r,i/=n,a===Math.round((e+i)/2)))break;if(a++,a>t.length-2)throw new Error("Threshold not found")}return a},li:function(t,e){let n,r,i,a,o,s,l,h,c,u,d,f;d=.5,u=0;for(let m=0;m<t.length;m++)u+=m*t[m];u/=e,l=u;do{s=l,n=s+.5|0,r=0,a=0;for(let e=0;e<=n;e++)r+=e*t[e],a+=t[e];h=0===a?0:r/a,i=0,o=0;for(let e=n+1;e<t.length;e++)i+=e*t[e],o+=t[e];c=0===o?0:i/o,f=(h-c)/(Math.log(h)-Math.log(c)),l=f<-Number.EPSILON?f-.5|0:f+.5|0}while(Math.abs(l-s)>.5);return n},maxentropy:function(t,e){let n=new Array(t.length);for(let d=0;d<t.length;d++)n[d]=t[d]/e;let r=new Array(t.length),i=new Array(t.length);r[0]=n[0],i[0]=1-r[0];for(let d=1;d<t.length;d++)r[d]=r[d-1]+n[d],i[d]=1-r[d];let a=0;for(let d=0;d<t.length;d++)if(Math.abs(r[d])>=Number.EPSILON){a=d;break}let o=t.length-1;for(let d=t.length-1;d>=a;d--)if(Math.abs(i[d])>=Number.EPSILON){o=d;break}let s,l,h,c=-1,u=Number.MIN_VALUE;for(let d=a;d<=o;d++){l=0;for(let e=0;e<=d;e++)0!==t[e]&&(l-=n[e]/r[d]*Math.log(n[e]/r[d]));h=0;for(let e=d+1;e<t.length;e++)0!==t[e]&&(h-=n[e]/i[d]*Math.log(n[e]/i[d]));s=l+h,u<s&&(u=s,c=d)}return c},mean:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=r*t[r];return Math.floor(n/e)},minerror:function(t,e){let n,r,i,a,o,s,l,h,c,u,d,f,m=-2,p=0;for(let g=0;g<t.length;g++)p+=g*t[g];for(p/=e,n=p;n!==m;){let e=ao(t,n),p=ao(t,t.length-1),g=oo(t,n),v=oo(t,t.length-1),_=so(t,n);if(r=g/e,i=(v-g)/(p-e),a=e/p,o=(p-e)/p,s=_/e-r*r,l=(so(t,t.length-1)-_)/(p-e)-i*i,h=1/s-1/l,c=r/s-i/l,u=r*r/s-i*i/l+Math.log10(s*(o*o)/(l*(a*a))),d=c*c-h*u,d<0)return n;m=n,f=(c+Math.sqrt(d))/h,n=isNaN(f)?m:Math.floor(f)}return n},minimum:function(t){if(t.length<2)return 0;let e=0,n=-1,r=-1,i=new Array(t.length);for(let a=0;a<t.length;a++)i[a]=t[a],t[a]>0&&(r=a);for(;!ho(i);)if(i=lo(i),e++,e>1e4)return n;return n=function(t,e){let n;for(let r=1;r<e;r++)if(t[r-1]>t[r]&&t[r+1]>=t[r]){n=r;break}return n}(i,r),n},moments:function(t,e){let n,r,i,a,o,s,l=0,h=0,c=0,u=0,d=-1,f=t.length,m=new Array(f);for(let p=0;p<f;p++)m[p]=t[p]/e;for(let p=0;p<f;p++)l+=p*m[p],h+=p*p*m[p],c+=p*p*p*m[p];r=1*h-l*l,i=(-h*h+l*c)/r,a=(1*-c+h*l)/r,o=.5*(-a-Math.sqrt(a*a-4*i)),s=.5*(-a+Math.sqrt(a*a-4*i)),n=(s-l)/(s-o);for(let p=0;p<f;p++)if(u+=m[p],u>n){d=p;break}return d},otsu:function(t,e){let n=0,r=0,i=0,a=0,o=0;for(let s=0;s<t.length;s++)o+=s*t[s];for(let s=0;s<t.length;s++){r+=t[s];const l=e-r;if(0===r||0===l)continue;n+=s*t[s];const h=(o-n)/l,c=r*l*(n/r-h)*(n/r-h);c>=i&&(a=s,i=c)}return a},percentile:function(t){let e=-1,n=new Array(t.length),r=co(t,t.length-1),i=1;for(let a=0;a<t.length;a++)n[a]=Math.abs(co(t,a)/r-.5),n[a]<i&&(i=n[a],e=a);return e},renyientropy:function(t,e){let n,r,i,a=new Array(t.length),o=new Array(t.length),s=new Array(t.length),l=0,h=0,c=0,u=0,d=0,f=0;for(let v=0;v<t.length;v++)a[v]=t[v]/e;o[0]=a[0],s[0]=1-o[0];for(let v=1;v<t.length;v++)o[v]=o[v-1]+a[v],s[v]=1-o[v];r=0;for(let v=0;v<t.length;v++)if(Math.abs(o[v])>=Number.EPSILON){r=v;break}i=t.length-1;for(let v=t.length-1;v>=r;v--)if(Math.abs(s[v])>=Number.EPSILON){i=v;break}for(let v=r;v<=i;v++){let e=0,n=0,r=0;for(let s=0;s<=v;s++)0!==t[s]&&(e-=a[s]/o[v]*Math.log(a[s]/o[v])),n+=Math.sqrt(a[s]/o[v]),r+=a[s]*a[s]/(o[v]*o[v]);let i=0,m=0,p=0;for(let o=v+1;o<t.length;o++)0!==t[o]&&(i-=a[o]/s[v]*Math.log(a[o]/s[v])),m+=Math.sqrt(a[o]/s[v]),p+=a[o]*a[o]/(s[v]*s[v]);let g=e+i,_=2*(n*m>0?Math.log(n*m):0),w=-1*(r*p>0?Math.log(r*p):0);g>u&&(u=g,l=v),_>d&&(d=_,h=v),w>f&&(f=w,c=v)}let m,p=[l,h,c];p.sort(((t,e)=>t-e)),m=Math.abs(p[0]-p[1])<=5?Math.abs(p[1]-p[2])<=5?[1,2,1]:[0,1,3]:Math.abs(p[1]-p[2])<=5?[3,1,0]:[1,2,1];let g=o[p[2]]-o[p[0]];return n=Math.round(p[0]*(o[p[0]]+.25*g*m[0])+.25*p[1]*g*m[1]+p[2]*(s[p[2]]+.25*g*m[2])),n},shanbhag:function(t,e){let n=new Array(t.length);for(let f=0;f<t.length;f++)n[f]=t[f]/e;let r=new Array(t.length),i=new Array(t.length);r[0]=n[0],i[0]=1-r[0];for(let f=1;f<t.length;f++)r[f]=r[f-1]+n[f],i[f]=1-r[f];let a=0;for(let f=0;f<t.length;f++)if(Math.abs(r[f])>=Number.EPSILON){a=f;break}let o=t.length-1;for(let f=t.length-1;f>=a;f--)if(Math.abs(i[f])>=Number.EPSILON){o=f;break}let s,l,h,c,u=-1,d=Number.MAX_VALUE;for(let f=a;f<=o;f++){h=0,s=.5/r[f];for(let t=1;t<=f;t++)h-=n[t]*Math.log(1-s*r[t-1]);h*=s,c=0,s=.5/i[f];for(let e=f+1;e<t.length;e++)c-=n[e]*Math.log(1-s*i[e]);c*=s,l=Math.abs(h-c),l<d&&(d=l,u=f)}return u},triangle:function(t){let e=0,n=0,r=0,i=0;for(let u=0;u<t.length;u++)if(t[u]>0){e=u;break}e>0&&e--;for(let u=t.length-1;u>0;u--)if(t[u]>0){i=u;break}i<t.length-1&&i++;for(let u=0;u<t.length;u++)t[u]>n&&(r=u,n=t[u]);let a,o,s,l=!1;if(r-e<i-r){l=!0;let n=0,a=t.length-1;for(;n<a;){let e=t[n];t[n]=t[a],t[a]=e,n++,a--}e=t.length-1-i,r=t.length-1-r}if(e===r)return e;a=t[r],o=e-r,s=Math.sqrt(a*a+o*o),a/=s,o/=s,s=a*e+o*t[e];let h=e,c=0;for(let u=e+1;u<=r;u++){let e=a*u+o*t[u]-s;e>c&&(h=u,c=e)}if(h--,l){let e=0,n=t.length-1;for(;e<n;){let r=t[e];t[e]=t[n],t[n]=r,e++,n--}return t.length-1-h}return h},yen:function(t,e){let n=new Array(t.length);for(let h=0;h<t.length;h++)n[h]=t[h]/e;let r=new Array(t.length);r[0]=n[0];for(let h=1;h<t.length;h++)r[h]=r[h-1]+n[h];let i=new Array(t.length);i[0]=n[0]*n[0];for(let h=1;h<t.length;h++)i[h]=i[h-1]+n[h]*n[h];let a=new Array(t.length);a[t.length-1]=0;for(let h=t.length-2;h>=0;h--)a[h]=a[h+1]+n[h+1]*n[h+1];let o,s=-1,l=Number.MIN_VALUE;for(let h=0;h<t.length;h++)o=-1*(i[h]*a[h]>0?Math.log(i[h]*a[h]):0)+2*(r[h]*(1-r[h])>0?Math.log(r[h]*(1-r[h])):0),o>l&&(l=o,s=h);return s}},fo={};function mo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e=fo.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let n=uo[e.toLowerCase()];if(n){return n(this.getHistogram(),this.size)}throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(uo).forEach((t=>{fo[t]=t}));const po="threshold";function go(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e=po,threshold:n=.5,useAlpha:r=!0,invert:i=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),n=e===po?function(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"===typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"===typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}(n,this.maxValue):mo.call(this,t);let a=new El(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&r)for(let s=0;s<this.data.length;s+=this.channels){let t=this.data[s]+(this.maxValue-this.data[s])*(this.maxValue-this.data[s+1])/this.maxValue;(i&&t<=n||!i&&t>=n)&&a.setBit(o),o++}else for(let s=0;s<this.data.length;s+=this.channels)(i&&this.data[s]<=n||!i&&this.data[s]>=n)&&a.setBit(o),o++;return a}function vo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{size:e=0,algorithm:n="copy",color:r}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===n){if(r.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<r.length;t++)0===r[t]&&(r[t]=.001)}else r=aa()(this.channels,null);Array.isArray(e)||(e=[e,e]);let i=this.width+2*e[0],a=this.height+2*e[1],o=this.channels,s=El.createFrom(this,{width:i,height:a});!function(t,e,n,r){let i=t.width,a=t.height,o=e.width,s=t.channels;for(let l=0;l<i;l++)for(let h=0;h<a;h++)for(let a=0;a<s;a++){let c=(h*i+l)*s+a,u=((r+h)*o+n+l)*s+a;e.data[u]=t.data[c]}}(this,s,e[0],e[1]);for(let l=e[0];l<i-e[0];l++)for(let t=0;t<o;t++){let n=r[t]||s.data[(e[1]*i+l)*o+t];for(let r=0;r<e[1];r++)s.data[(r*i+l)*o+t]=n;n=r[t]||s.data[((a-e[1]-1)*i+l)*o+t];for(let r=a-e[1];r<a;r++)s.data[(r*i+l)*o+t]=n}for(let l=0;l<a;l++)for(let t=0;t<o;t++){let n=r[t]||s.data[(l*i+e[0])*o+t];for(let r=0;r<e[0];r++)s.data[(l*i+r)*o+t]=n;n=r[t]||s.data[(l*i+i-e[0]-1)*o+t];for(let r=i-e[0];r<i;r++)s.data[(l*i+r)*o+t]=n}return s}function _o(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=El.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function wo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{interpolation:n=Wa.nearestneighbor,width:r=this.width,height:i=this.height}=e;if("number"!==typeof t)throw new TypeError("degrees must be a number");const a=qa(n),o=t*Math.PI/180,s=Math.floor(Math.abs(r*Math.cos(o))+Math.abs(i*Math.sin(o))),l=Math.floor(Math.abs(i*Math.cos(o))+Math.abs(r*Math.sin(o))),h=Math.cos(-o),c=Math.sin(-o);let u=s/2,d=l/2;s%2===0?(u-=.5,l%2===0?d-=.5:d=Math.floor(d)):(u=Math.floor(u),l%2===0?d-=.5:d=Math.floor(d));const f=Math.floor(r/2-u),m=Math.floor(i/2-d);if(1===this.bitDepth){const t=new El(s,l,{kind:"BINARY",parent:this});switch(a){case Wa.nearestneighbor:return function(t,e,n,r,i,a,o,s){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1){let c=Math.round((l-i)*o-(h-a)*s+i)+n,u=Math.round((h-a)*o+(l-i)*s+a)+r;(c<0||c>=t.width||u<0||u>=t.height||t.getBitXY(c,u))&&e.setBitXY(l,h)}return e}(this,t,f,m,u,d,h,c);case Wa.bilinear:return function(t,e,n,r,i,a,o,s){let l=t.width;for(let h=0;h<e.height;h++)for(let c=0;c<e.width;c++){let u=(c-i)*o-(h-a)*s+i+n,d=(h-a)*o+(c-i)*s+a+r,f=0|u,m=0|d,p=u-f,g=d-m;if(u<0||u>=t.width||d<0||d>=t.height)e.setBitXY(c,h);else{let n=m*t.width+f,r=t.getBit(n),i=t.getBit(n+1),a=t.getBit(n+l);(r|p&i-r|g&a-r|p&g&r-i-a+t.getBit(n+1+l))>0&&e.setBitXY(c,h)}}return e}(this,t,f,m,u,d,h,c);default:throw new Error(`unsupported rotate interpolation: ${a}`)}}else{const t=El.createFrom(this,{width:s,height:l});switch(a){case Wa.nearestneighbor:return function(t,e,n,r,i,a,o,s){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1)for(let c=0;c<t.channels;c++){let u=Math.round((l-i)*o-(h-a)*s+i)+n,d=Math.round((h-a)*o+(l-i)*s+a)+r;u<0||u>=t.width||d<0||d>=t.height?1===t.alpha&&c===t.channels-1?e.setValueXY(l,h,c,0):e.setValueXY(l,h,c,t.maxValue):e.setValueXY(l,h,c,t.getValueXY(u,d,c))}return e}(this,t,f,m,u,d,h,c);case Wa.bilinear:return function(t,e,n,r,i,a,o,s){let l=t.width*t.channels;for(let h=0;h<e.height;h++)for(let c=0;c<e.width;c++){let u=(c-i)*o-(h-a)*s+i+n,d=(h-a)*o+(c-i)*s+a+r,f=0|u,m=0|d,p=u-f,g=d-m;for(let n=0;n<t.channels;n++)if(u<0||u>=t.width||d<0||d>=t.height)1===t.alpha&&n===t.channels-1?e.setValueXY(c,h,n,0):e.setValueXY(c,h,n,t.maxValue);else{let r=(m*t.width+f)*t.channels+n,i=t.data[r],a=t.data[r+t.channels],o=t.data[r+l],s=i+p*(a-i)+g*(o-i)+p*g*(i-a-o+t.data[r+l+t.channels])|0;e.setValueXY(c,h,n,s)}}return e}(this,t,f,m,u,d,h,c);default:throw new Error(`unsupported rotate interpolation: ${a}`)}}}function yo(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!==typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return xo.call(this);case 180:return Mo.call(this);case 270:return bo.call(this);default:return wo.call(this,t,e)}}function bo(){if(1===this.bitDepth){const t=new El(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)this.getBitXY(r,n)&&t.setBitXY(n,e-r);return t}{const t=El.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)for(let i=0;i<this.channels;i++)t.setValueXY(n,e-r,i,this.getValueXY(r,n,i));return t}}function xo(){if(1===this.bitDepth){const t=new El(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)this.getBitXY(r,n)&&t.setBitXY(e-n,r);return t}{const t=El.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)for(let i=0;i<this.channels;i++)t.setValueXY(e-n,r,i,this.getValueXY(r,n,i));return t}}function Mo(){if(1===this.bitDepth){const t=new El(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,n=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)this.getBitXY(i,r)&&t.setBitXY(e-i,n-r);return t}{const t=El.createFrom(this),e=t.width-1,n=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)for(let a=0;a<this.channels;a++)t.setValueXY(e-i,n-r,a,this.getValueXY(i,r,a));return t}}function So(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=yi(t);this.checkProcessable("insert",n);let{x:r=0,y:i=0}=e;const a=xi(this,e,{copy:!0}),o=Math.min(a.height,i+t.height),s=Math.min(a.width,r+t.width);if(1===a.bitDepth)for(let l=i;l<o;l++)for(let e=r;e<s;e++){t.getBitXY(e-r,l-i)?a.setBitXY(e,l):a.clearBitXY(e,l)}else for(let l=i;l<o;l++)for(let e=r;e<s;e++)a.setPixelXY(e,l,t.getPixelXY(e-r,l-i));return a}function Eo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{size:e=0,algorithm:n="copy",color:r}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===n){if(r.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<r.length;t++)0===r[t]&&(r[t]=.001)}else r=aa()(this.channels,null);Array.isArray(e)||(e=[e,e]);let i=e[0],a=e[1],o=this.channels;for(let s=i;s<this.width-i;s++)for(let t=0;t<o;t++){let e=r[t]||this.data[(s+this.width*a)*o+t];for(let n=0;n<a;n++)this.data[(n*this.width+s)*o+t]=e;e=r[t]||this.data[(s+this.width*(this.height-a-1))*o+t];for(let n=this.height-a;n<this.height;n++)this.data[(n*this.width+s)*o+t]=e}for(let s=0;s<this.height;s++)for(let t=0;t<o;t++){let e=r[t]||this.data[(s*this.width+i)*o+t];for(let n=0;n<i;n++)this.data[(s*this.width+n)*o+t]=e;e=r[t]||this.data[(s*this.width+this.width-i-1)*o+t];for(let n=this.width-i;n<this.width;n++)this.data[(s*this.width+n)*o+t]=e}return this}function ko(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new fi([this.clone()]);let n=new fi,r=this.data;if(this.alpha&&e)for(let i=0;i<this.components;i++){let t=El.createFrom(this,{components:1,alpha:!0,colorModel:br}),e=0;for(let n=0;n<r.length;n+=this.channels)t.data[e++]=r[n+i],t.data[e++]=r[n+this.components];n.push(t)}else for(let i=0;i<this.channels;i++){let t=El.createFrom(this,{components:1,alpha:!1,colorModel:br}),e=0;for(let n=0;n<r.length;n+=this.channels)t.data[e++]=r[n+i];n.push(t)}return n}function Co(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{keepAlpha:n=!1,mergeAlpha:r=!1}=e;n&=this.alpha,r&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=Di(this,t);let i=El.createFrom(this,{components:1,alpha:n,colorModel:br}),a=0;for(let o=0;o<this.data.length;o+=this.channels)r?i.data[a++]=this.data[o+t]*this.data[o+this.components]/this.maxValue:(i.data[a++]=this.data[o+t],n&&(i.data[a++]=this.data[o+this.components]));return i}function Ao(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Po,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mergeAlpha:n=!1,keepAlpha:r=!1}=e;n&=this.alpha,r&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let i=El.createFrom(this,{components:1,alpha:r,colorModel:br}),a=0;for(let o=0;o<this.size;o++){let e=t(this.getPixel(o));n?i.data[a++]=e*this.data[o*this.channels+this.components]/this.maxValue:(i.data[a++]=e,r&&(i.data[a++]=this.data[o*this.channels+this.components]))}return i}function Po(t){return(t[0]+t[1]+t[2])/3}function To(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");let n=t=Di(this,t);for(let r=0;r<e.data.length;r++)this.data[n]=e.data[r],n+=this.channels;return this}function Do(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{shift:n=[0,0],average:r,channels:i,defaultAlpha:a,normalize:o,border:s=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(s)||(s=[s,s]),i=Ti(this,{channels:i,defaultAlpha:a}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");"undefined"===typeof r&&(r=!0);let l=Math.max(s[0],-n[0]),h=Math.min(this.width-s[0],this.width-n[0]),c=Math.max(s[1],-n[1]),u=Math.min(this.height-s[1],this.height-n[1]),d=aa()(i.length,0);for(let f=0;f<i.length;f++){let e=i[f],r=o?this.sum[e]:Math.max(this.sum[e],t.sum[e]),a=o?t.sum[e]:Math.max(this.sum[e],t.sum[e]);if(0!==r&&0!==a)for(let i=l;i<h;i++)for(let o=c;o<u;o++){let s=i*this.multiplierX+o*this.multiplierY+e,l=s+n[0]*this.multiplierX+n[1]*this.multiplierY;d[f]+=Math.min(this.data[s]/r,t.data[l]/a)}}return r?d.reduce(((t,e)=>t+e))/d.length:d}function Io(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{sampling:e=[10,10],painted:n=!1,mask:r}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const i=e[0],a=e[1],o=[],s=[],l=this.width/i,h=this.height/a;let c=Math.floor(l/2);for(let d=0;d<i;d++){let t=Math.floor(h/2);for(let e=0;e<a;e++){let e=Math.round(c),n=Math.round(t);r&&!r.getBitXY(e,n)||(o.push([e,n]),s.push(this.getPixelXY(e,n))),t+=h}c+=l}const u={xyS:o,zS:s};return n&&(u.painted=this.rgba8().paintPoints(o)),u}function No(t,e,n){const r=new Array(t);for(let i=0;i<t;i++)r[i]=new Array(e);if(n)for(let i=0;i<t;i++)for(let t=0;t<e;t++)r[i][t]=n;return r.width=t,r.height=e,Object.setPrototypeOf(r,No.prototype),r}function Ro(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{border:n}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let r=new No(t.width,t.height,-1/0),i=Math.floor(t.width/2),a=Math.floor(t.height/2),o=i,s=a,l=!1;for(;!l;){let e=r.localSearch(i,a,-1/0);for(let i=0;i<e.length;i++){let a=e[i],l=this.getSimilarity(t,{border:n,shift:[o-a[0],s-a[1]]});r[a[0]][a[1]]=l}let h=r.localMax(i,a);h.position[0]!==i||h.position[1]!==a?(i=h.position[0],a=h.position[1]):l=!0}return[i-o,a-s]}function Lo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getRow",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}(this,t),Xa(this,e);let n=new Array(this.width),r=0,i=t*this.width*this.channels+e,a=i+this.width*this.channels;for(let o=i;o<a;o+=this.channels)n[r++]=this.data[o];return n}function Uo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getColumn",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}(this,t),Xa(this,e);let n=new Array(this.height),r=0,i=this.width*this.channels;for(let a=e+t*this.channels;a<this.data.length;a+=i)n[r++]=this.data[a];return n}function Oo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let n=new $i(this.height,this.width);for(let r=0;r<this.height;r++)for(let t=0;t<this.width;t++)n.set(r,t,this.getValueXY(t,r,e));return n}function zo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=new $i(t);let{channel:n}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===n){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");n=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)this.setValueXY(e,r,n,t.get(r,e));return this}function Fo(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let n=0;n<this.data.length;n+=this.channels){let r=new Array(this.components);for(let t=0;t<this.components;t++)r[t]=this.data[n+t];t[e++]=r}return t}function Bo(t){let e=this,n=e.getClosestCommonParent(t),r=e.getRelativePosition(n,{defaultFurther:!0}),i=Vo(e,r),a=t.getRelativePosition(n,{defaultFurther:!0}),o=Vo(t,a),s=function(t,e){let n=0,r=0,i=[];for(;n<t.length&&r<e.length;)t[n][0]===e[r][0]&&t[n][1]===e[r][1]?(i.push(t[n]),n++,r++):t[n][0]<e[r][0]||t[n][0]===e[r][0]&&t[n][1]<e[r][1]?n++:r++;return i}(i,o),l={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let h=0;h<s.length;h++){let n=s[h],i=[n[0]-r[0],n[1]-r[1]],o=[n[0]-a[0],n[1]-a[1]],c=e.getBitXY(i[0],i[1]),u=t.getBitXY(o[0],o[1]);1===c&&1===u&&l.commonWhitePixels.push(n)}for(let h=0;h<i.length;h++){let t,n;0!==h&&(t=Math.floor(h/e.width),n=h%e.width),1===e.getBitXY(t,n)&&l.whitePixelsMask1.push(i[h])}for(let h=0;h<o.length;h++){let e=0,n=0;0!==h&&(e=Math.floor(h/t.width),n=h%t.width),1===t.getBitXY(e,n)&&l.whitePixelsMask2.push(o[h])}return l}function Vo(t,e){let n=[];for(let r=0;r<t.height;r++)for(let i=0;i<t.width;i++){let t=[r,i];n.push([t[0]+e[0],t[1]+e[1]])}return n}function Ho(t){let e,n=Go(this),r=Go(t);if(e=n>=r?jo(this,n):jo(t,r),0===n||0===r)return e;let i=this,a=t;for(;n!==r;)if(n>r){if(i=i.parent,null===i)return e;n-=1}else{if(a=a.parent,null===a)return e;r-=1}for(;i!==a&&null!==i&&null!==a;)if(i=i.parent,a=a.parent,null===i||null===a)return e;return i!==a?e:i}function Go(t){let e=0,n=t;for(;null!=n.parent;)n=n.parent,e++;return e}function jo(t,e){let n=t;for(;e>0;)n=n.parent,e-=1;return n}No.prototype.localMin=function(t,e){let n=this[t][e],r=[t,e];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]<n&&(n=this[i][t],r=[i,t]);return{position:r,value:n}},No.prototype.localMax=function(t,e){let n=this[t][e],r=[t,e];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]>n&&(n=this[i][t],r=[i,t]);return{position:r,value:n}},No.prototype.localSearch=function(t,e,n){let r=[];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]===n&&r.push([i,t]);return r};const Yo={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Xo=[[-1,0,1],[-2,0,2],[-1,0,1]],Wo=[[-1,-2,-1],[0,0,0],[1,2,1]],qo={bitDepth:32,mode:"periodic"};function $o(t){return function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},Yo,e);const n=t.width,r=t.height,i=t.maxValue,a={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(a),s=o.convolution(Wo,qo),l=o.convolution(Xo,qo),h=l.hypotenuse(s),c=t.constructor,u=new c(n,r,{kind:"GREY",bitDepth:32}),d=new c(n,r,{kind:"GREY",bitDepth:32}),f=new c(n,r,{kind:"GREY"});for(var m=1;m<n-1;m++)for(var p=1;p<r-1;p++){var g=(Math.round(Math.atan2(l.getValueXY(m,p,0),s.getValueXY(m,p,0))*(5/Math.PI))+5)%5;0===g&&(h.getValueXY(m,p,0)<=h.getValueXY(m,p-1,0)||h.getValueXY(m,p,0)<=h.getValueXY(m,p+1,0))||1===g&&(h.getValueXY(m,p,0)<=h.getValueXY(m-1,p+1,0)||h.getValueXY(m,p,0)<=h.getValueXY(m+1,p-1,0))||2===g&&(h.getValueXY(m,p,0)<=h.getValueXY(m-1,p,0)||h.getValueXY(m,p,0)<=h.getValueXY(m+1,p,0))||3===g&&(h.getValueXY(m,p,0)<=h.getValueXY(m-1,p-1,0)||h.getValueXY(m,p,0)<=h.getValueXY(m+1,p+1,0))||u.setValueXY(m,p,0,h.getValueXY(m,p,0))}for(m=0;m<n*r;++m){var v=u.data[m],_=0;v>e.highThreshold&&(_++,f.data[m]=i),v>e.lowThreshold&&_++,d.data[m]=_}var w=[];for(m=1;m<n-1;++m)for(p=1;p<r-1;++p)if(1===d.getValueXY(m,p,0))t:for(var y=m-1;y<m+2;++y)for(var b=p-1;b<p+2;++b)if(2===d.getValueXY(y,b,0)){w.push([m,p]),f.setValueXY(m,p,0,i);break t}for(;w.length>0;){var x=[];for(m=0;m<w.length;++m)for(p=-1;p<2;++p)for(y=-1;y<2;++y)if(0!==p||0!==y){var M=w[m][0]+p,S=w[m][1]+y;1===d.getValueXY(M,S,0)&&0===f.getValueXY(M,S,0)&&(x.push([M,S]),f.setValueXY(M,S,0,i))}w=x}return f}(this,t)}function Zo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{position:n}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!n&&(n=t.getRelativePosition(this),!n))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=El.createFrom(this,{width:t.width,height:t.height,alpha:1,position:n,parent:this});for(let r=0;r<t.width;r++)for(let i=0;i<t.height;i++){for(let t=0;t<this.channels;t++){let a=this.getValueXY(r+n[0],i+n[1],t);e.setValueXY(r,i,t,a)}t.getBitXY(r,i)||e.setValueXY(r,i,this.components,0)}return e}{let e=El.createFrom(this,{width:t.width,height:t.height,position:n,parent:this});for(let r=0;r<t.height;r++)for(let i=0;i<t.width;i++)t.getBitXY(i,r)&&this.getBitXY(i+n[0],r+n[1])&&e.setBitXY(i,r);return e}}var Ko=n(7872),Qo=n.n(Ko);function Jo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{x:e=0,y:n=0,inPlace:r=!0}=t,i=r?this:El.createFrom(this);this.checkProcessable("floodFill",{bitDepth:1});if(this.getBitXY(e,n))return i;const a=new(Qo());for(a.push(new ts(e,n));a.length>0;){const t=a.shift();i.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&(!i.getBitXY(e,t.y)&&!this.getBitXY(e,t.y));e++)i.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&a.push(new ts(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&a.push(new ts(e,t.y-1));for(let e=t.x-1;e>=0&&(!i.getBitXY(e,t.y)&&!this.getBitXY(e,t.y));e++)i.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&a.push(new ts(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&a.push(new ts(e,t.y-1))}return i}function ts(t,e){this.x=t,this.y=e}function es(){return es=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},es.apply(null,arguments)}function ns(t,e,n){var r=[],i=(n/=100)*(e/=100),a=t/60,o=i*(1-Math.abs(a%2-1)),s=n-i;return r=a>=0&&a<1?[i,o,0]:a>=1&&a<2?[o,i,0]:a>=2&&a<3?[0,i,o]:t>=3&&a<4?[0,o,i]:t>=4&&a<5?[o,0,i]:t>=5&&a<=6?[i,0,o]:[0,0,0],{r:Math.round(255*(r[0]+s)),g:Math.round(255*(r[1]+s)),b:Math.round(255*(r[2]+s))}}function rs(t,e,n){var r=function(t,e,n){return{h:t,s:2*(e*=(n<50?n:100-n)/100)/(n+e)*100,v:n+e}}(t,e,n);return ns(r.h,r.s,r.v)}var is={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function as(t){return function(t){var e=is[t.toLowerCase()];if(!e)return;return{r:e[0],g:e[1],b:e[2],a:100}}(t)||function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}(t)||function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}(t)||function(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */).map(Number);return{r:n[0],g:n[1],b:n[2],a:100}}}(t)||function(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */).map(Number);return{r:n[0],g:n[1],b:n[2],a:100*n[3]}}}(t)||function(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */);return es({},rs(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)),{a:100})}}(t)||function(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */),r=parseInt(n[0],10),i=parseInt(n[1],10),a=parseInt(n[2],10),o=parseInt(100*parseFloat(n[3]),10);return es({},rs(r,i,a),{a:o})}}(t)}function os(t){let e=as(t);return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function ss(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function ls(t,e,n){let r,i,a,o,s,l;return n/=100,0===(e/=100)?o=s=l=255*n:(i=n<=.5?n*(e+1):n+e-n*e,r=2*n-i,a=t/360,o=ss(r,i,a+1/3),s=ss(r,i,a),l=ss(r,i,a-1/3)),{r:o,g:s,b:l}}function hs(t){let{color:e,colors:n,randomColors:r,numberColors:i=50}=t;if(e&&!Array.isArray(e)&&(e=os(e)),e)return[e];if(n)return n=n.map((function(t){return Array.isArray(t)?t:os(t)})),n;if(r){n=new Array(i);for(let t=0;t<i;t++)n[t]=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}return function(t){let e=new Array(t),n=0;for(let r=0;r<360;r+=360/t){n++;let t=ls(r,100,30+n%4*15);e[n-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}(i)}function cs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{color:r="blue",colors:i,font:a="12px Helvetica",rotate:o=0}=n;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:xr}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(r&&!Array.isArray(r)&&(r=os(r)),i=i?i.map((function(t){return Array.isArray(t)?t:os(t)})):[r],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(a)||(a=[a]),Array.isArray(o)||(o=[o]);let s=this.getCanvas().getContext("2d");for(let l=0;l<t.length;l++){s.save();let n=i[l%i.length];s.fillStyle=`rgba(${n[0]},${n[1]},${n[2]},${n[3]/this.maxValue})`,s.font=a[l%a.length];let r=e[l];s.translate(r[0],r[1]),s.rotate(o[l%o.length]/180*Math.PI),s.fillText(t[l],0,0),s.restore()}return this.data=Uint8Array.from(s.getImageData(0,0,this.width,this.height).data),this}function us(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{alpha:n=255,labels:r=[],labelsPosition:i=[],labelColor:a="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:xr});let s=hs(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let l=0;l<t.length;l++){let e=t[l],r=s[l%s.length];for(let t=0;t<e.width;t++)for(let i=0;i<e.height;i++)if(e.getBitXY(t,i))for(let a=0;a<Math.min(this.components,r.length);a++)if(255===n)this.setValueXY(t+e.position[0],i+e.position[1],a,r[a]);else{let o=this.getValueXY(t+e.position[0],i+e.position[1],a);o=Math.round((o*(255-n)+r[a]*n)/255),this.setValueXY(t+e.position[0],i+e.position[1],a,o)}}if(Array.isArray(r)&&r.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=a,e.font=o;for(let n=0;n<Math.min(t.length,r.length);n++){let a=i[n]?i[n]:t[n].position;e.fillText(r[n],a[0],a[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function ds(t,e){let n=new Array(t);for(let r=0;r<t;r++)n[r]=new Array(e).fill(0);return n}const fs=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],ms=[[0,1,0],[1,1,1],[0,1,0]];class ps{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kind:e="cross",shape:n,size:r,width:i,height:a,filled:o=!0}=t;if(r&&(i=r,a=r),n)switch(n.toLowerCase()){case"square":case"rectangle":this.matrix=function(t,e,n){const r=ds(e,t);if(n.filled)for(let i=0;i<e;i++)for(let e=0;e<t;e++)r[i][e]=1;else{for(let n of[0,e-1])for(let e=0;e<t;e++)r[n][e]=1;for(let n=0;n<e;n++)for(let e of[0,t-1])r[n][e]=1}return r}(i,a,{filled:o});break;case"circle":case"ellipse":this.matrix=function(t,e,n){const r=ds(e,t);let i=1-e%2,a=1-t%2,o=Math.floor((t-1)/2),s=Math.floor((e-1)/2),l=o*o,h=s*s;if(n.filled)for(let c=0;c<=s;c++){for(let e=o-Math.floor(Math.sqrt(l-l*c*c/h));e<=o;e++)r[s-c][e]=1,r[s+c+i][e]=1,r[s-c][t-e-1]=1,r[s+c+i][t-e-1]=1}else{for(let e=0;e<=s;e++){let n=o-Math.floor(Math.sqrt(l-l*e*e/h));r[s-e][n]=1,r[s+e+i][n]=1,r[s-e][t-n-1]=1,r[s+e+i][t-n-1]=1}for(let t=0;t<=o;t++){let n=s-Math.floor(Math.sqrt(h-h*t*t/l));r[n][o-t]=1,r[n][o+t+a]=1,r[e-n-1][o-t]=1,r[e-n-1][o+t+a]=1}}return r}(i,a,{filled:o});break;case"triangle":this.matrix=function(t,e,n){if(!n.filled)throw new Error("Non filled triangle is not implemented");const r=ds(e,t);for(let i=0;i<e;i++){let n=Math.floor((1-i/e)*t/2);for(let e=n;e<t-n;e++)r[i][e]=1}return r}(i,a,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${n}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=fs;break;case"smallcross":this.matrix=ms;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2|0,this.halfWidth=this.width/2|0}getPoints(){let t=this.matrix,e=[];for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)t[n][r]&&e.push([r-this.halfWidth,n-this.halfHeight]);return e}getMask(){let t=new El(this.width,this.height,{kind:kr});for(let e=0;e<this.matrix.length;e++)for(let n=0;n<this.matrix[0].length;n++)this.matrix[e][n]&&t.setBitXY(n,e);return t}}function gs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{shape:n}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let r=hs(Object.assign({},e,{numberColors:t.length})),i=new ps(n).getPoints(),a=Math.min(this.channels,r[0].length);for(let o=0;o<t.length;o++){let e=r[o%r.length],n=t[o][0],s=t[o][1];for(let t=0;t<i.length;t++){let r=i[t][0],o=i[t][1];if(n+r>=0&&s+o>=0&&n+r<this.width&&s+o<this.height){let t=(n+r+(s+o)*this.width)*this.channels;for(let n=0;n<a;n++)this.data[t+n]=e[n]}}}return this}function vs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:n=[this.maxValue,0,0],closed:r=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let i=Math.min(this.channels,n.length);for(let a=0;a<t.length-1+r;a++){let e=t[a],r=t[(a+1)%t.length],o=r[0]-e[0],s=r[1]-e[1],l=Math.max(Math.abs(o),Math.abs(s)),h=o/l,c=s/l,u=e[0],d=e[1];for(let t=0;t<=l;t++){let t=Math.round(u),e=Math.round(d);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let r=(t+e*this.width)*this.channels;for(let t=0;t<i;t++)this.data[r+t]=n[t]}u+=h,d+=c}}return this}function _s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let r=hs(Object.assign({},e,{numberColors:t.length}));for(let i=0;i<t.length;i++)n.color=r[i%r.length],this.paintPolyline(t[i],n);return this}function ws(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:n=[this.maxValue,0,0],filled:r=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let i=function(t){let e=[];for(let n=0;n<t.length;n++)t[n][0]===t[(n+1)%t.length][0]&&t[n][1]===t[(n+1)%t.length][1]||t[n][0]===t[(n-1+t.length)%t.length][0]&&t[n][1]===t[(n-1+t.length)%t.length][1]||t[(n+1)%t.length][0]===t[(n-1+t.length)%t.length][0]&&t[(n-1+t.length)%t.length][1]===t[(n+1)%t.length][1]||e.push(t[n]);return e}(t);if(!1===r)return this.paintPolyline(t,e);{let r=Array(this.height);for(let t=0;t<this.height;t++){r[t]=[];for(let e=0;e<this.width;e++)r[t].push(0)}for(let t=0;t<i.length;t++){const e=ys(i[t],i[(t+1)%i.length]);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)bs(n,t,e,this.height)&&(r[t][n]=0===r[t][n]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===r[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let r=Math.min(this.channels,n.length),i=(e+t*this.width)*this.channels;for(let t=0;t<r;t++)this.data[i+t]=n[t]}return this.paintPolyline(t,e)}}function ys(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const n=(e[1]-t[1])/(e[0]-t[0]);return{a:n,b:t[1]-n*t[0],vertical:!1}}}function bs(t,e,n,r){if(!0===n.vertical)return n.b<=t;if(0===n.a)return!1;{const i=(e-n.b)/n.a;return i<t&&i>=0&&i<=r}}function xs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let r=hs(Object.assign({},e,{numberColors:t.length}));for(let i=0;i<t.length;i++)n.color=r[i%r.length],this.paintPolygon(t[i],n);return this}function Ms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxSlots:e=256,channel:n,useAlpha:r=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===n){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");n=0}return Es.call(this,n,{useAlpha:r,maxSlots:e})}function Ss(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{maxSlots:e=256,useAlpha:n=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let r=new Array(n?this.components:this.channels);for(let i=0;i<r.length;i++)r[i]=Es.call(this,i,{useAlpha:n,maxSlots:e});return r}function Es(t,e){let{useAlpha:n,maxSlots:r}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let r=this.getBitXY(e,n);0===r?t[0]+=1:1===r&&(t[1]+=1)}return t}let i=Math.log2(r);if(!ji()(i))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let a=0;this.bitDepth>i&&(a=this.bitDepth-i);let o=this.data,s=aa()(Math.pow(2,Math.min(this.bitDepth,i)),0);if(n&&this.alpha){let e=this.channels-t-1;for(let n=t;n<o.length;n+=this.channels)s[o[n]>>a]+=o[n+e]/this.maxValue}else for(let l=t;l<o.length;l+=this.channels)s[o[l]>>a]++;return s}function ks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{useAlpha:e=!0,nbSlots:n=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let r=Math.log(n)/Math.log(8);if(r!==Math.floor(r))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let i=this.bitDepth-r,a=this.data,o=aa()(Math.pow(8,r),0),s=Math.pow(2,2*r),l=Math.pow(2,r);for(let h=0;h<a.length;h+=this.channels){let t=(a[h]>>i)*s+(a[h+1]>>i)*l+(a[h+2]>>i);e&&this.alpha?o[t]+=a[h+this.channels-1]/this.maxValue:o[t]++}return o}function Cs(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=aa()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)this.data[e+n]<t[n]&&(t[n]=this.data[e+n]);return t}function As(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=aa()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)this.data[e+n]>t[n]&&(t[n]=this.data[e+n]);return t}function Ps(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=aa()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)t[n]+=this.data[e+n];return t}function Ts(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getMoment",{bitDepth:[1]});let n=0;for(let r=0;r<this.width;r++)for(let i=0;i<this.height;i++)1===this.getBitXY(r,i)&&(n+=r**t*i**e);return n}function Ds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{mask:e,region:n=3,removeClosePoints:r=0,invert:i=!1,maxEquals:a=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),n*=4;let s=i?0:1,l=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],h=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],c=n<=8?1:2,u=[];for(let d=c;d<o.height-c;d++)for(let t=c;t<o.width-c;t++){if(e&&e.getBitXY(t,d)!==s)continue;let r=0,c=0,f=o.data[t+d*o.width];for(let e=0;e<n;e++)i?o.data[t+l[e]+(d+h[e])*o.width]>f&&r++:o.data[t+l[e]+(d+h[e])*o.width]<f&&r++,o.data[t+l[e]+(d+h[e])*o.width]===f&&c++;r+c===n&&c<=a&&u.push([t,d])}if(r>0)for(let d=0;d<u.length;d++)for(let t=d+1;t<u.length;t++)Math.sqrt(Math.pow(u[d][0]-u[t][0],2)+Math.pow(u[d][1]-u[t][1],2))<r&&(u[d][0]=u[d][0]+u[t][0]>>1,u[d][1]=u[d][1]+u[t][1]>>1,u.splice(t,1),t--);return u}function Is(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let r=t[n];e[n]=ai(r)}return e}function Ns(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let r=t[n];e[n]=ii(r)}return e}function Rs(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)1===this.getBitXY(e,n)&&t.push([e,n]);return t}function Ls(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++)if(1===this.getBitXY(n,e))for(t.push([n,e]),1!==this.getBitXY(n+1,e)?(t.push([n+1,e]),t.push([n+1,e+1]),1!==this.getBitXY(n,e+1)&&t.push([n,e+1])):1!==this.getBitXY(n,e+1)&&(t.push([n,e+1]),t.push([n+1,e+1]));n<this.width-2&&1===this.getBitXY(n+1,e)&&1===this.getBitXY(n+2,e);)n++;return t}function Us(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this===t)return[0,0];let n=[0,0],r=this;for(;r;){if(r===t)return n;r.position&&(n[0]+=r.position[0],n[1]+=r.position[1]),r=r.parent}return!!e.defaultFurther&&n}function Os(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let n=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&n++;return n}return this.size}function zs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sorted:n}=e;n||(t=t.slice().sort(Bs));const r=t.length,i=new Array(2*r);let a=0;for(let s=0;s<r;s++){const e=t[s];for(;a>=2&&Fs(i[a-2],i[a-1],e)<=0;)a--;i[a++]=e}const o=a+1;for(let s=r-2;s>=0;s--){const e=t[s];for(;a>=o&&Fs(i[a-2],i[a-1],e)<=0;)a--;i[a++]=e}return i.slice(0,a-1)}function Fs(t,e,n){return(e[1]-t[1])*(n[0]-t[0])-(e[0]-t[0])*(n[1]-t[1])}function Bs(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function Vs(){return zs(this.extendedPoints,{sorted:!1})}function Hs(t,e){return[t[0]-e[0],t[1]-e[1]]}function Gs(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function js(t,e,n){void 0===n&&(n=new Array(e.length));let r=Math.cos(t),i=Math.sin(t);for(let a=0;a<n.length;++a)n[a]=[r*e[a][0]-i*e[a][1],i*e[a][0]+r*e[a][1]];return n}function Ys(t){let e=0;for(let n=0;n<t.length;n++){let r=t[n][0],i=t[n][1],a=t[n===t.length-1?0:n+1][0],o=t[n===t.length-1?0:n+1][1];e+=Math.sqrt((a-r)**2+(o-i)**2)}return e}function Xs(t){let e=0;for(let n=0;n<t.length;n++){e+=t[n][0]*t[n===t.length-1?0:n+1][1]*.5,e-=t[n===t.length-1?0:n+1][0]*t[n][1]*.5}return Math.abs(e)}function Ws(t){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(let a=0;a<t.length;a++)t[a][0]<e&&(e=t[a][0]),t[a][0]>r&&(r=t[a][0]),t[a][1]<n&&(n=t[a][1]),t[a][1]>i&&(i=t[a][1]);return[[e,n],[r,i]]}function qs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{originalPoints:e=Vs.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const n=new Array(e.length);let r,i=1/0,a=0;for(let o=0;o<n.length;o++){let t=$s(e[o],e[(o+1)%n.length]);js(-t,e,n);let s=n[o][0],l=n[o][1],h=n[(o+1)%n.length][0],c=n[(o+1)%n.length][1],u=!0,d=0,f=0,m=0;for(let e=0;e<n.length;e++){let t=(n[e][0]-s)/(h-s);!0===u?(u=!1,d=t,f=t):(t<d&&(d=t),t>f&&(f=t));let r=(-(h-s)*n[e][1]+h*l-c*s)/(h-s);Math.abs(r)>Math.abs(m)&&(m=r)}let p=[s+d*(h-s),l],g=[s+f*(h-s),l],v=Math.abs(m*(d-f)*(h-s));v<i&&(a=t,i=v,r=[p,g,[g[0],g[1]-m],[p[0],p[1]-m]])}return js(a,r,r),r}function $s(t,e){let n=Gs(Hs(e,t)),r=Math.acos(n[0]);return n[1]<0?-r:r}var Zs=n(4723),Ks=n.n(Zs);var Qs=n(6427),Js=n.n(Qs);function tl(t,e){let n=Gs(Hs(e,t)),r=Math.acos(n[0]);return n[1]<0?-r:r}class el{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{scale:e=1,kind:n=""}=t;let r;switch(n){case"contour":r=this.contourMask;break;case"box":r=this.boxMask;break;case"filled":r=this.filledMask;break;case"center":r=this.centerMask;break;case"mbr":r=this.mbrFilledMask;break;case"hull":r=this.convexHullFilledMask;break;case"hullContour":r=this.convexHullMask;break;case"mbrContour":r=this.mbrMask;break;case"feret":r=this.feretMask;break;default:r=this.mask}return e<1&&(r=r.resize({factor:e}),r.parent=this.mask.parent,r.position[0]+=this.minX,r.position[1]+=this.minY),r}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2|0,this.height/2|0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let n=this.internalIDs;for(let r=0;r<t.length;r++)n.includes(t[r])||(this.computed.externalIDs.push(t[r]),this.computed.externalLengths.push(e[r]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=function(t){let e=t.map,n=e.data,r=new Set,i=new Map,a=new Set,o=[1,0,-1,0],s=[0,1,0,-1];for(let c=t.minX;c<=t.maxX;c++)for(let l=t.minY;l<=t.maxY;l++){if(n[c+l*e.width]===t.id)for(let h=0;h<4;h++){let u=c+o[h],d=l+s[h];if(u>=0&&d>=0&&u<e.width&&d<e.height){let o=u+d*e.width;if(n[o]!==t.id&&!a.has(o)){a.add(o),r.add(n[o]);let t=i.get(n[o]);t?i.set(n[o],++t):i.set(n[o],1)}}}}let l=Array.from(r),h=l.map((function(t){return i.get(t)}));return{ids:l,lengths:h}}(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=function(t){let e=new Set,n=t.map,r=n.data;for(let i of[0,t.height-1])for(let a=0;a<t.width;a++){let o=(i+t.minY)*n.width+a+t.minX;if(a-t.minX>0&&r[o]===t.id&&r[o-1]!==t.id){let t=r[o-1];e.add(t)}if(n.width-a-t.minX>1&&r[o]===t.id&&r[o+1]!==t.id){let t=r[o+1];e.add(t)}}for(let i of[0,t.width-1])for(let a=0;a<t.height;a++){let o=(a+t.minY)*n.width+i+t.minX;if(a-t.minY>0&&r[o]===t.id&&r[o-n.width]!==t.id){let t=r[o-n.width];e.add(t)}if(n.height-a-t.minY>1&&r[o]===t.id&&r[o+n.width]!==t.id){let t=r[o+n.width];e.add(t)}}return Array.from(e)}(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=function(t){let e=[t.id],n=t.map,r=n.data;if(t.height>2)for(let a=0;a<t.width;a++){let i=t.minY*n.width+a+t.minX;if(e.includes(r[i])){let a=r[i+n.width];e.includes(a)||t.boxIDs.includes(a)||e.push(a)}}let i=new Array(4);for(let a=1;a<t.width-1;a++)for(let o=1;o<t.height-1;o++){let s=(o+t.minY)*n.width+a+t.minX;if(e.includes(r[s])){i[0]=r[s-1],i[1]=r[s+1],i[2]=r[s-n.width],i[3]=r[s+n.width];for(let n=0;n<4;n++){let r=i[n];e.includes(r)||t.boxIDs.includes(r)||e.push(r)}}}return e}(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=function(t){let e=0,n=t.map,r=n.data,i=[0];t.height>1&&(i[1]=t.height-1);for(let o of i)for(let i=1;i<t.width-1;i++){r[(o+t.minY)*n.width+i+t.minX]===t.id&&e++}let a=[0];t.width>1&&(a[1]=t.width-1);for(let o of a)for(let i=0;i<t.height;i++){r[(i+t.minY)*n.width+o+t.minX]===t.id&&e++}return e}(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=function(t){let e=0,n=t.map,r=n.data;for(let i=1;i<t.width-1;i++)for(let a=1;a<t.height-1;a++){let o=(a+t.minY)*n.width+i+t.minX;r[o]===t.id&&(t.externalIDs.includes(r[o-1])||t.externalIDs.includes(r[o+1])||t.externalIDs.includes(r[o-n.width])||t.externalIDs.includes(r[o+n.width]))&&e++}return e+t.box}(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=function(t){let e=0,n=t.map.width,r=t.map.data;for(let i=1;i<t.width-1;i++)for(let a=1;a<t.height-1;a++){let o=(a+t.minY)*n+i+t.minX;t.internalIDs.includes(r[o])&&r[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=function(t){let e=0,n=t.map,r=n.data;for(let i=1;i<t.width-1;i++)for(let a=1;a<t.height-1;a++){let o=(a+t.minY)*n.width+i+t.minX;r[o]===t.id&&(r[o-1]===t.id&&r[o+1]===t.id&&r[o-n.width]===t.id&&r[o+n.width]===t.id||e++)}return e+t.box}(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)this.map.data[e+this.minX+(n+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&n>0&&n<this.height-1&&this.map.data[e-1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,n));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)this.map.data[e+this.minX+(n+this.minY)*this.map.width]===this.id&&t.setBitXY(e,n);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){let r=e+this.minX+(n+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[r])&&t.setBitXY(e,n)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new ps({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let n=0;n<this.width;n++)for(let e=0;e<this.height;e++)this.map.data[n+this.minX+(e+this.minY)*this.map.width]===this.id&&(n>0&&n<this.width-1&&e>0&&e<this.height-1&&this.map.data[n-1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[n+1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[n+this.minX+(e-1+this.minY)*this.map.width]===this.id&&this.map.data[n+this.minX+(e+1+this.minY)*this.map.width]===this.id||(t.push([n,e]),t.push([n+1,e]),t.push([n,e+1]),t.push([n+1,e+1])));const e=zs(t);this.computed.convexHull={polyline:e,surface:Xs(e),perimeter:Ys(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new El(this.width+1,this.height+1,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++)1!==Js()(t.polyline,[n,r])&&e.setBitXY(n,r);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=qs({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],n=t[1],r=t[2],i=Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2),a=Math.sqrt((r[0]-n[0])**2+(r[1]-n[1])**2);this.computed.mbr={width:i,height:a,elongation:1-i/a,aspectRatio:i/a,surface:i*a,perimeter:2*(i+a),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{originalPoints:e=Vs.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const n=new Array(e.length);let r=1/0,i=0,a=[];for(let h=0;h<e.length;h++){let t=tl(e[h],e[(h+1)%e.length]);js(-t,e,n);let o=0,s=[];for(let r=0;r<e.length;r++){let t=Math.abs(n[h][1]-n[r][1]);t>o&&(o=t,s=[],s.push([n[r][0],n[h][1]],[n[r][0],n[r][1]]))}o<r&&(r=o,i=t,a=s)}js(i,a,a);let o=0,s=[],l=0;for(let h=0;h<e.length-1;h++)for(let t=h+1;t<e.length;t++){let n=(e[h][0]-e[t][0])**2+(e[h][1]-e[t][1])**2;n>l&&(l=n,o=Math.sqrt(n),s=[e[h],e[t]])}return{min:r,minLine:a,max:o,maxLine:s,aspectRatio:r/o}}({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=function(t){let e=t.map,n=e.data,r=0,i=0,a=0,o=0;for(let s=0;s<t.width;s++)for(let l=0;l<t.height;l++){let h=(l+t.minY)*e.width+s+t.minX;if(n[h]===t.id){let c=0;switch((0===s||t.externalIDs.includes(n[h-1]))&&c++,(s===t.width-1||t.externalIDs.includes(n[h+1]))&&c++,(0===l||t.externalIDs.includes(n[h-e.width]))&&c++,(l===t.height-1||t.externalIDs.includes(n[h+e.width]))&&c++,c){case 1:r++;break;case 2:i++;break;case 3:a++;break;case 4:o++}}}return{one:r,two:i,three:a,four:o}}(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new El(this.width+1,this.height+1,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=function(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}(this.mbr.rectangle);if(t.length>0){const e=Ws(t),n=new El(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:kr,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=function(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let n=Ws(t),r=n[0][0],i=n[0][1];for(let a=0;a<t.length;a++)e[a][0]=t[a][0]-r,e[a][1]=t[a][1]-i;return e}(t),n.paintPolyline(t,{closed:!0}),this.computed.mbrMask=n}else this.computed.mbrMask=new El(1,1,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new El(this.width,this.height,{kind:kr,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++)1!==Js()(e,[n,r])&&t.setBitXY(n,r);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let r=(e+this.minY)*this.map.width+n+this.minX;this.map.data[r]===this.id&&t.push([n,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const n=this.points;for(let r=0;r<n.length;r++)for(let i=r+1;i<n.length;i++){let a=Math.pow(n[r][0]-n[i][0],2)+Math.pow(n[r][1]-n[i][1],2);a>=e&&(e=a,t=[n[r],n[i]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}class nl{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let o=0;o<t.length;o++)t[o]&&!e[t[o]]&&(e[t[o]]=!0,t[o]>0?this.roiMap.positive++:this.roiMap.negative++);let n={};for(let o in e)n[o]=new el(this.roiMap,1*o);let r=this.roiMap.width,i=this.roiMap.height;for(let o=0;o<i;o++)for(let e=0;e<r;e++){let i=o*r+e;if(0!==t[i]){const r=n[t[i]];e<r.minX&&(r.minX=e),e>r.maxX&&(r.maxX=e),o<r.minY&&(r.minY=o),o>r.maxY&&(r.maxY=o),r.meanX+=e,r.meanY+=o,r.surface++}}let a=[];for(let o in e)n[o].meanX/=n[o].surface,n[o].meanY/=n[o].surface,a.push(n[o]);return a}}function rl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{algorithm:e="commonBorderLength",minCommonBorderLength:n=5,maxCommonBorderLength:r=100,minCommonBorderRatio:i=.3,maxCommonBorderRatio:a=1}=t;let o=function(t,e,i){return t[i]>=n&&t[i]<=r};"function"===typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,n){let r=Math.min(t[n]/t[e],1);return r>=i&&r<=a});const s=this,l=s.commonBorderLength;let h={},c={};for(let g of Object.keys(l)){let t=l[g],e=Object.keys(t);for(let n of e)if(n!==g&&o(t,g,n)){let t=n;c[n]&&(t=c[n]);let e=g;if(c[g]&&(e=c[g]),Number(t)!==e){let n=Math.min(t,e),r=Math.max(t,e);if(h[n]||(h[n]={}),h[n][r]=!0,c[r]=n,h[r]){for(let t of Object.keys(h[r]))h[n][t]=!0,c[t]=n;delete h[r]}}}}let u=s.minMax,d=-u.min,f=u.max+d,m=new Array(f+1).fill(0);for(let g of Object.keys(c))m[Number(g)+d]=c[g];let p=s.data;for(let g=0;g<p.length;g++){let t=p[g];if(0!==t){let e=m[t+d];0!==e&&(p[g]=e)}}return s.computed={},s}class il{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let n=0;n<this.data.length;n++)this.data[n]<t&&(t=this.data[n]),this.data[n]>e&&(e=this.data[n]);return{min:t,max:e}}get commonBorderLength(){return function(t){let e=t.data,n=[1,0,-1,0],r=[0,1,0,-1],i=t.minMax,a=-i.min,o=i.max+a,s=[];for(let h=0;h<=o;h++)s.push(Object.create(null));for(let h=0;h<t.width;h++)for(let i=0;i<t.height;i++){let o=e[h+i*t.width];if(0!==o){let l=Object.create(null),c=!1;for(let u=0;u<4;u++){let d=h+n[u],f=i+r[u];if(d>=0&&f>=0&&d<t.width&&f<t.height){let n=e[d+f*t.width];o!==n&&(c=!0,0!==n&&void 0===l[n]&&(l[n]=!0,s[n+a][o]?s[n+a][o]++:s[n+a][o]=1))}else c=!0}c&&(s[o+a][o]?s[o+a][o]++:s[o+a][o]=1)}}let l={};for(let h=0;h<s.length;h++)Object.keys(s[h]).length>0&&(l[h-a]=s[h]);return l}(this)}mergeRoi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rl.call(this,t)}mergeRois(t){const e=t[0],n=t.slice(1);for(let r=0;r<this.data.length;r++)n.includes(this.data[r])&&(this.data[r]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let n=0;n<this.data.length;n+=this.width){let r={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=r;let i={},a={},o=[],s=this.data[n],l=0;for(let t=n;t<n+this.width;t++){let e=this.data[t];s!==e&&(s=e,o.push(l),l=0),l++,e>0?(r.positivePixel++,i[e]||(i[e]=!0)):e<0?(r.negativePixel++,a[e]||(a[e]=!0)):r.zeroPixel++}o.push(l),r.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],r.positiveRoiIDs=Object.keys(i),r.negativeRoiIDs=Object.keys(a),r.positiveRoi=r.positiveRoiIDs.length,r.negativeRoi=r.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let n=0;n<this.width;n++){let r={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=r;let i={},a={},o=[],s=this.data[n],l=0;for(let t=n;t<n+this.data.length;t+=this.width){let e=this.data[t];s!==e&&(s=e,o.push(l),l=0),l++,e>0?(r.positivePixel++,i[e]||(i[e]=!0)):e<0?(r.negativePixel++,a[e]||(a[e]=!0)):r.zeroPixel++}o.push(l),r.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],r.positiveRoiIDs=Object.keys(i),r.negativeRoiIDs=Object.keys(a),r.positiveRoi=r.positiveRoiIDs.length,r.negativeRoi=r.negativeRoiIDs.length}return t}}function al(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{allowCorners:n=!1}=e,r=65535;let i=new Int16Array(t.size),a=0,o=0,s=new Uint16Array(65536),l=new Uint16Array(65536);for(let c=0;c<t.width;c++)for(let e=0;e<t.height;e++)0===i[e*t.width+c]&&h(c,e);function h(e,h){let c=0,u=0,d=t.getBitXY(e,h),f=d?++a:--o;if(a>32767||o<-32768)throw new Error("Too many regions of interest");for(s[0]=e,l[0]=h;c<=u;){let e=s[c&r],a=l[c&r];if(i[a*t.width+e]=f,e>0&&0===i[a*t.width+e-1]&&t.getBitXY(e-1,a)===d&&(u++,s[u&r]=e-1,l[u&r]=a,i[a*t.width+e-1]=-32768),a>0&&0===i[(a-1)*t.width+e]&&t.getBitXY(e,a-1)===d&&(u++,s[u&r]=e,l[u&r]=a-1,i[(a-1)*t.width+e]=-32768),e<t.width-1&&0===i[a*t.width+e+1]&&t.getBitXY(e+1,a)===d&&(u++,s[u&r]=e+1,l[u&r]=a,i[a*t.width+e+1]=-32768),a<t.height-1&&0===i[(a+1)*t.width+e]&&t.getBitXY(e,a+1)===d&&(u++,s[u&r]=e,l[u&r]=a+1,i[(a+1)*t.width+e]=-32768),n&&(e>0&&a>0&&0===i[(a-1)*t.width+e-1]&&t.getBitXY(e-1,a-1)===d&&(u++,s[u&r]=e-1,l[u&r]=a-1,i[(a-1)*t.width+e-1]=-32768),e<t.width-1&&a>0&&0===i[(a-1)*t.width+e+1]&&t.getBitXY(e+1,a-1)===d&&(u++,s[u&r]=e+1,l[u&r]=a-1,i[(a-1)*t.width+e+1]=-32768),e>0&&a<t.height-1&&0===i[(a+1)*t.width+e-1]&&t.getBitXY(e-1,a+1)===d&&(u++,s[u&r]=e-1,l[u&r]=a+1,i[(a+1)*t.width+e-1]=-32768),e<t.width-1&&a<t.height-1&&0===i[(a+1)*t.width+e+1]&&t.getBitXY(e+1,a+1)===d&&(u++,s[u&r]=e+1,l[u&r]=a+1,i[(a+1)*t.width+e+1]=-32768)),c++,u-c>r)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new il(t,i)}var ol=n(6788),sl=n.n(ol);const ll=[-1,0],hl=[0,-1],cl=[null,null],ul=[-1,-1,0,1],dl=[0,-1,-1,-1],fl=[null,null,null,null];function ml(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{allowCorners:n=!1}=e;let r,i,a,o=4;if(n&&(o=8),8===o)r=ul,i=dl,a=fl;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);r=ll,i=hl,a=cl}const s=t.size,l=t.width,h=t.height,c=new Array(s),u=new Uint32Array(s),d=new(sl());let f=1;for(let m=0;m<h;m++)for(let e=0;e<l;e++){const n=e+m*l;if(t.getBit(n)){let t=null;for(let n=0;n<a.length;n++){const o=e+r[n],s=m+i[n];if(o>=0&&s>=0&&o<l&&s<h){let e=c[o+s*l];e?(a[n]=e,(!t||a[n].value<t.value)&&(t=a[n])):a[n]=null}}if(t){c[n]=t;for(let e=0;e<a.length;e++)a[e]&&a[e]!==t&&d.union(t,a[e])}else c[n]=d.add(f++)}}for(let m=0;m<h;m++)for(let e=0;e<l;e++){const n=e+m*l;t.getBit(n)&&(u[n]=d.find(c[n]).value)}return new il(t,u)}function pl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{allowCorner:e=!0,onlyTop:n=!1,invert:r=!1}=t,i=this;i.checkProcessable("fromMaxima",{components:[1]});let a=0,o=0,s=new Int16Array(i.size),l=new Int8Array(i.size),h=new Float32Array(i.size),c=1048575,u=new Uint16Array(1048576),d=new Uint16Array(1048576),f=0,m=0,p=new Uint16Array(1048576),g=new Uint16Array(1048576),v=0,_=0;for(!function(t){let{maxima:n=!0}=t;for(let r=1;r<i.height-1;r++)for(let t=1;t<i.width-1;t++){let h=t+r*i.width;if(0===l[h]){let l=n?i.data[h]:-i.data[t+r*i.width];if(i.data[r*i.width+t-1]>l)continue;if(i.data[r*i.width+t+1]>l)continue;if(i.data[(r-1)*i.width+t]>l)continue;if(i.data[(r+1)*i.width+t]>l)continue;if(e){if(i.data[(r-1)*i.width+t-1]>l)continue;if(i.data[(r-1)*i.width+t+1]>l)continue;if(i.data[(r+1)*i.width+t-1]>l)continue;if(i.data[(r+1)*i.width+t+1]>l)continue}s[h]=n?++a:--o,w(t,r)||(n?--a:++o)}}}(i);f<m;){y(u[f&c],d[f&c],2),f++}return new il(i,s);function w(t,e){let n=m;v=0,_=1,p[0]=t,g[0]=e;let r=!0;for(;v<_;){r&=y(p[v&c],g[v&c],1),v++}if(!r){for(let t=0;t<_;t++){let e=p[t&c],n=g[t&c]*i.width+e;s[n]=0}m=n}return r}function y(t,e,r){let a=s[e*i.width+t],o=i.data[e*i.width+t];for(let f=e-1;f<=e+1;f++)for(let e=t-1;e<=t+1;e++){let t=f*i.width+e;if(0===l[t])switch(l[t]=1,h[t]=i.data[t]-o,r){case 1:if(0===h[t]){if(0===e||0===f||e===i.width-1||f===i.height-1)return!1;s[t]=a,p[_&c]=e,g[_&c]=f,_++}else{if(h[t]>0)return!1;n||(s[t]=a,u[m&c]=e,d[m&c]=f,m++)}break;case 2:h[t]<=0&&(s[t]=a,u[m&c]=e,d[m&c]=f,m++);break;default:throw new Error("unreachable")}}return!0}}function gl(t){let e=new ps(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=new Int16Array(this.size),r=0,i=e.getPoints();for(let a=0;a<t.length;a++){r++;let e=t[a][0],o=t[a][1];for(let t=0;t<i.length;t++){let a=i[t][0],s=i[t][1];e+a>=0&&o+s>=0&&e+a<this.width&&o+s<this.height&&(n[e+a+(o+s)*this.width]=r)}}return new il(this,n)}var vl=n(1512),_l=n.n(vl);const wl=[1,0,-1,0,1,1,-1,-1],yl=[0,1,0,-1,1,-1,1,-1];function bl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{points:e,mask:n,image:r,fillMaxValue:i=this.maxValue,invert:a=!1}=t,o=r||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),a=!a,e||(e=o.getLocalMaxima({invert:a,mask:n}));let s=a?0:1,l=new Int16Array(o.size),h=o.width,c=o.height,u=new(_l())({comparator:(t,e)=>t[2]-e[2],strategy:_l().BinaryHeapStrategy});for(let d=0;d<e.length;d++){let t=e[d][0]+e[d][1]*h;l[t]=d+1;let n=o.data[t];(a&&n<=i||!a&&n>=i)&&u.queue([e[d][0],e[d][1],n])}for(;u.length>0;){let t=u.dequeue(),e=t[0]+t[1]*h;for(let r=0;r<4;r++){let d=t[0]+wl[r],f=t[1]+yl[r];if(d>=0&&f>=0&&d<h&&f<c){let c=d+f*h;if(!n||n.getBit(c)===s){let n=o.data[c];(a&&n<=i||!a&&n>=i)&&0===l[c]&&(l[c]=l[e],u.queue([t[0]+wl[r],t[1]+yl[r],n]))}}}}return new il(o,l)}class xl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t),n=pl.call(this._image,t);this._layers[e.label]=new nl(n,e)}fromPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this._options,e),r=gl.call(this._image,t,e);return this._layers[n.label]=new nl(r,n),this}putMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new il(this._image,t),r=Object.assign({},this._options,e);return this._layers[r.label]=new nl(n,r),this}fromWaterShed(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t),n=bl.call(this._image,t);this._layers[e.label]=new nl(n,e)}fromMask(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this._options,e),r=al.call(this._image,t,e);return this._layers[n.label]=new nl(r,n),this}fromMaskConnectedComponentLabelingAlgorithm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this._options,e),r=ml.call(this._image,t,e);return this._layers[n.label]=new nl(r,n),this}getMap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getMap(t).rowsInfo()}colsInfo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getMap(t).rowsInfo()}getRoiIds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getRois(t);if(e){let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].id;return t}throw new Error("ROIs not found")}getRois(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{label:e=this._options.label,positive:n=!0,negative:r=!0,minSurface:i=0,maxSurface:a=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:s=Number.POSITIVE_INFINITY,minHeight:l=0,maxHeight:h=Number.POSITIVE_INFINITY,minRatio:c=0,maxRatio:u=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const d=this._layers[e].roi,f=[];for(const m of d)(m.id<0&&r||m.id>0&&n)&&m.surface>=i&&m.surface<=a&&m.width>=o&&m.width<=s&&m.height>=l&&m.height<=h&&m.ratio>=c&&m.ratio<=u&&f.push(m);return f}getRoi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{label:n=this._options.label}=e;if(!this._layers[n])throw new Error(`this Roi layer (${n}) does not exist`);const r=this._layers[n].roi.find((e=>e.id===t));if(!r)throw new Error(`found no Roi with id ${t}`);return r}getMasks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getRois(t),n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r].getMask(t);return n}getAnalysisMasks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{analysisProperty:e}=t;let n=`${e}Mask`,r=this.getRois(t);return 0!==r.length&&r[0][n]?r.map((t=>t[n])):[]}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{labelProperty:e,analysisProperty:n}=t;this._painted||(this._painted=this._image.rgba8());let r=this.getMasks(t);if(e){const n=this.getRois(t);t.labels=n.map((t=>function(t){let e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").split(".");for(let n of e){if(void 0===t[n])return;t=t[n]}return t}(t,e)));const r=Math.max(...t.labels);let i=!1,a=!1;if(e.includes("surface")?i=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(a=!0),isFinite(r)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(a||i)){e=i?`${t.unit}^2`:t.unit;let n=i?"m^2":"m",r=i?t.pixelSize**2:t.pixelSize;const a=Ks().swiftConverter(n,e);t.labels=t.labels.map((t=>a(r*t)))}t.labels=r>50?t.labels.map((t=>Math.round(t)+e)):r>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=n.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(r,t),n){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new El(this._image.width,this._image.height,{kind:"BINARY"}),n=this.getMasks(t);for(let r=0;r<n.length;r++){let t=n[r];for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++)t.getBitXY(n,r)&&e.setBitXY(n+t.position[0],r+t.position[1])}return e}resetPainted(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const n=this.getMap(e);return n.mergeRois(t),this.putMap(n.data,e),this}findCorrespondingRoi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRois(e),r=[];for(let i=0;i<n.length;i++){let e=n[i],a=Ml(e.minX,e.minY,e.points,t,Math.sign(e.id));r.push(a)}return r}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function Ml(t,e,n,r,i){let a={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let o=0;o<n.length;o++){let i=n[o],s=i[0]+t+(i[1]+e)*r.width,l=r.data[s];(l>0||l<0)&&(a.id.includes(l)?a.surface[a.id.indexOf(l)]+=1:(a.id.push(l),a.surface.push(1)))}for(let o=0;o<a.id.length;o++){Math.sign(a.id[o])===i?a.same+=a.surface[o]:a.opposite+=a.surface[o],a.roiSurfaceCovered[o]=a.surface[o]/n.length}return a.total=a.opposite+a.same,a}const Sl=Object.prototype.toString;class El{constructor(t,e,n,i){if(1===arguments.length?(i=t,({width:t,height:e,data:n}=i)):n&&!n.length&&(i=n,({data:n}=i)),void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i={}),"object"!==typeof i||null===i)throw new TypeError("options must be an object");if(!Number.isInteger(t)||t<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new RangeError("height must be a positive integer");const{kind:a=Cr}=i;if("string"!==typeof a)throw new TypeError("kind must be a string");const o=function(t){const e=Ar[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}(a),s=Object.assign({},i);for(const r in o)void 0===s[r]&&(s[r]=o[r]);!function(t){const{components:e,alpha:n,bitDepth:i,colorModel:a}=t;if(!Number.isInteger(e)||e<=0)throw new RangeError(`invalid components: ${e}. Must be a positive integer`);if(0!==n&&1!==n&&"boolean"!==typeof n)throw new TypeError(`invalid alpha: ${n}: must be a boolean, 0 or 1`);if(!Pr.includes(i))throw new RangeError(`invalid bitDepth: ${i}. Must be one of ${Pr.join(", ")}`);if(!r[a])throw new RangeError(`invalid colorModel: ${a}. Must be one of ${Object.keys(r).join(", ")}`)}(s);const{components:l,bitDepth:h,colorModel:c}=s,u=s.alpha+0,d=t*e,f=l+u,m=32===h?Number.MAX_VALUE:2**h-1;if(void 0===n)n=function(t,e,n,r,i,a){const o=r*t;let s;switch(i){case 1:s=new Uint8Array(Math.ceil(o/8));break;case 8:s=new Uint8Array(o);break;case 16:s=new Uint16Array(o);break;case 32:s=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${i}`)}if(n)for(let l=e;l<s.length;l+=r)s[l]=a;return s}(d,l,u,f,h,m);else{const t=function(t,e,n){let r=e*t;return 1===n&&(r=Math.ceil(r/8)),r}(d,f,h);if(n.length!==t)throw new RangeError(`incorrect data size: ${n.length}. Should be ${t}`)}this.width=t,this.height=e,this.data=n,this.size=d,this.components=l,this.alpha=u,this.bitDepth=h,this.maxValue=m,this.colorModel=c,this.channels=f,this.meta=i.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:i.parent||null}),this.position=i.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===Sl.call(t)}static fromCanvas(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new El(e.width,e.height,e.data)}static createFrom(t,e){const n=yi(t);return Object.assign(n,{parent:t,position:[0,0]},e),new El(n)}getRoiManager(t){return new xl(this,t)}clone(){const t=this.data.slice();return new El(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let r=(e*this.width+n)*this.channels;t.call(this,r)}}}function kl(t,e,n){let r,i,a,o,s=new Array(e);n||(n=100),n*=-1;let l=(e-1)/2,h=2*t*t;for(r=0;r<e;r++)for(s[r]=new Array(e),o=(r-l)*(r-l),i=0;i<e;i++)a=(i-l)*(i-l),s[r][i]=Math.round(n*(1-(a+o)/h)*Math.exp(-(a+o)/h));return s}!function(t){for(const e in wi)t.prototype[e]=wi[e]}(El),function(t){for(const e in l)t.prototype[e]=l[e]}(El),function(t){for(const e in vr)t.prototype[e]=vr[e]}(El),El.prototype.checkProcessable=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{bitDepth:n,alpha:r,colorModel:i,components:a,channels:o}=e;if("string"!==typeof t||0===t.length)throw new TypeError("processName must be a string");if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${n}`);if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${r}`);if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${i}`);if(a&&(Array.isArray(a)||(a=[a]),!a.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${a}`;throw 1===a.length&&1===a[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)},El.prototype.getRGBAData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const n=this.width*this.height*4;let r=e?new Uint8ClampedArray(n):new Uint8Array(n);return 1===this.bitDepth?function(t,e){for(let n=0;n<t.size;n++){const r=t.getBit(n);e[4*n]=255*r,e[4*n+1]=255*r,e[4*n+2]=255*r}}(this,r):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?function(t,e){const n=t.min[0],r=t.max[0],i=r-n;for(let a=0;a<t.size;a++){const r=Math.floor(255*(t.data[a]-n)/i);e[4*a]=r,e[4*a+1]=r,e[4*a+2]=r}}(this,r):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[xr]}),function(t,e){const n=Math.min(...t.min),r=Math.max(...t.max),i=r-n;for(let a=0;a<t.size;a++){const r=Math.floor(255*(t.data[3*a]-n)/i),o=Math.floor(255*(t.data[3*a+1]-n)/i),s=Math.floor(255*(t.data[3*a+2]-n)/i);e[4*a]=r,e[4*a+1]=o,e[4*a+2]=s}}(this,r))):1===this.components?function(t,e){for(let n=0;n<t.size;n++)e[4*n]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+1]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+2]=t.data[n*t.channels]>>>t.bitDepth-8}(this,r):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[xr]}),function(t,e){for(let n=0;n<t.size;n++)e[4*n]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+1]=t.data[n*t.channels+1]>>>t.bitDepth-8,e[4*n+2]=t.data[n*t.channels+2]>>>t.bitDepth-8}(this,r)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),function(t,e){for(let n=0;n<t.size;n++)e[4*n+3]=t.data[n*t.channels+t.components]>>t.bitDepth-8}(this,r)):function(t,e){for(let n=0;n<t.size;n++)e[4*n+3]=255}(this,r),r},El.load=function(t,e){if("string"===typeof t)return function(t,e){const n=t.slice(0,64).match(mi);let r;r=null!==n?Promise.resolve(function(t){let e,n,r,i,a=.75*t.length,o=t.length,s=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);const l=new Uint8Array(a);for(let h=0;h<o;h+=4)e=cr[t.charCodeAt(h)],n=cr[t.charCodeAt(h+1)],r=cr[t.charCodeAt(h+2)],i=cr[t.charCodeAt(h+3)],l[s++]=e<<2|n>>4,l[s++]=(15&n)<<4|r>>2,l[s++]=(3&r)<<6|63&i;return l}(t.slice(n[0].length))):function(t){let{withCredentials:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){let i=new self.XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.withCredentials=e,i.onload=function(t){200!==this.status?r(t):n(this.response)},i.onerror=r,i.send()}))}(t,e);return r.then((r=>pi(new Uint8Array(r),n?t:void 0,e&&e.ignorePalette)))}(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(pi(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(pi(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')},El.extendMethod=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{inPlace:r=!1,returnThis:i=!0,partialArgs:a=[]}=n;return El.prototype[t]=r?function(){this.computed=null;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];let o=e.apply(this,[...a,...n]);return i?this:o}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(this,[...a,...n])},El},El.extendProperty=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{partialArgs:r=[]}=n;return yr.get=function(){if(null===this.computed)this.computed={};else if(wr()(t,this.computed))return this.computed[t];let n=e.apply(this,r);return this.computed[t]=n,n},Object.defineProperty(El.prototype,t,yr),El},function(t){let e={inPlace:!0};t.extendMethod("invert",Si),t.extendMethod("abs",Mi),t.extendMethod("level",oa,e),t.extendMethod("add",ca,e),t.extendMethod("subtract",ua,e),t.extendMethod("subtractImage",da),t.extendMethod("multiply",ma,e),t.extendMethod("divide",pa,e),t.extendMethod("hypotenuse",fa),t.extendMethod("background",xa),t.extendMethod("flipX",Ei),t.extendMethod("flipY",ki),t.extendMethod("blurFilter",Ci),t.extendMethod("medianFilter",Ii),t.extendMethod("gaussianFilter",Ni),t.extendMethod("sobelFilter",na),t.extendMethod("gradientFilter",ea),t.extendMethod("scharrFilter",ra),t.extendMethod("dilate",Ma),t.extendMethod("erode",Aa),t.extendMethod("open",Na),t.extendMethod("close",Ra),t.extendMethod("topHat",La),t.extendMethod("blackHat",Ua),t.extendMethod("morphologicalGradient",Oa),t.extendMethod("warpingFourPoints",Ha),t.extendMethod("crop",Ga),t.extendMethod("cropAlpha",ja),t.extendMethod("resize",Za).extendMethod("scale",Za),t.extendMethod("hsv",Ka),t.extendMethod("hsl",Qa),t.extendMethod("cmyk",Ja),t.extendMethod("rgba8",to),t.extendMethod("grey",ro).extendMethod("gray",ro),t.extendMethod("mask",go),t.extendMethod("pad",vo),t.extendMethod("colorDepth",_o),t.extendMethod("setBorder",Eo,e),t.extendMethod("rotate",yo),t.extendMethod("rotateLeft",bo),t.extendMethod("rotateRight",xo),t.extendMethod("insert",So),t.extendMethod("getRow",Lo),t.extendMethod("getColumn",Uo),t.extendMethod("getMatrix",Oo),t.extendMethod("setMatrix",zo),t.extendMethod("getPixelsArray",Fo),t.extendMethod("getIntersection",Bo),t.extendMethod("getClosestCommonParent",Ho),t.extendMethod("getThreshold",mo),t.extendMethod("split",ko),t.extendMethod("getChannel",Co),t.extendMethod("combineChannels",Ao),t.extendMethod("setChannel",To),t.extendMethod("getSimilarity",Do),t.extendMethod("getPixelsGrid",Io),t.extendMethod("getBestMatch",Ro),t.extendMethod("cannyEdge",$o),t.extendMethod("convolution",ta),t.extendMethod("extract",Zo),t.extendMethod("floodFill",Jo),t.extendMethod("paintLabels",cs,e),t.extendMethod("paintMasks",us,e),t.extendMethod("paintPoints",gs,e),t.extendMethod("paintPolyline",vs,e),t.extendMethod("paintPolylines",_s,e),t.extendMethod("paintPolygon",ws,e),t.extendMethod("paintPolygons",xs,e),t.extendMethod("countAlphaPixels",Os),t.extendMethod("monotoneChainConvexHull",Vs),t.extendMethod("minimalBoundingRectangle",qs),t.extendMethod("getHistogram",Ms).extendProperty("histogram",Ms),t.extendMethod("getHistograms",Ss).extendProperty("histograms",Ss),t.extendMethod("getColorHistogram",ks).extendProperty("colorHistogram",ks),t.extendMethod("getMin",Cs).extendProperty("min",Cs),t.extendMethod("getMax",As).extendProperty("max",As),t.extendMethod("getSum",Ps).extendProperty("sum",Ps),t.extendMethod("getMoment",Ts).extendProperty("moment",Ts),t.extendMethod("getLocalMaxima",Ds),t.extendMethod("getMedian",Ns).extendProperty("median",Ns),t.extendMethod("getMean",Is).extendProperty("mean",Is),t.extendMethod("getPoints",Rs).extendProperty("points",Rs),t.extendMethod("getExtendedPoints",Ls).extendProperty("extendedPoints",Ls),t.extendMethod("getRelativePosition",Us)}(El);var Cl=n(7600),Al=n.n(Cl);const Pl={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function Tl(t,e,n){return t.post("data",[e,n]).then((function(t){for(let e in t)t[e]=new El(t[e]);return t}))}const Dl={run:function(t,e,n){e=Object.assign({},Pl,e);const r=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const i=Tl(r,t,e);return"function"===typeof n&&i.then(n),i}))):Tl(r,t,e)},work:function(){worker.on("data",(function(t,e,n){e=new IJS(e);const r={},i=[],a=e.grey(),o=a.sobelFilter();f("sobel",o);const s=o.level().mask({threshold:n.threshold});f("mask",s);const l=o.getRoiManager();l.fromMask(s);const h=l.getMask(n.roi);f("realMask",h);const c=a.getPixelsGrid({sampling:n.sampling,mask:h}),u=e.getBackground(c.xyS,c.zS,n.regression);f("background",u);const d=e.subtract(u);function f(t,e){n.include.includes(t)&&(r[t]=e,i.push(e.data.buffer))}r.result=d,i.push(d.data.buffer),t(r,i)}))}},Il=Dl;class Nl{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!==typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let n,r,i={};function a(){n||(this.checkUrl(),r=this.url,n=new(Al())(e.work,{deps:r}),i.manager=n);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return e.run.call(i,...a)}a.reset=function(){n&&(n.terminate(),n=new(Al())(e.work,{deps:r}),i.manager=n)},Nl.prototype[t]=a}}!function(t){t.extendMethod("background",Il)}(Nl);const Rl=new Nl,Ll={grey:no,threshold:fo}},7288:(t,e,n)=>{"use strict";const r=n(1169),i=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),a=t=>{const e=r(t);return i.has(e&&e.ext)?e:null};t.exports=a,t.exports.default=a,Object.defineProperty(a,"minimumBytes",{value:r.minimumBytes})},9643:(t,e,n)=>{"use strict";n.r(e),n.d(e,{IOBuffer:()=>s});n(63);function r(t){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(t)}const i=new TextEncoder;const a=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class s{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1;"number"===typeof t?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const r=e.offset?e.offset>>>0:0,i=t.byteLength-r;let a=r;(ArrayBuffer.isView(t)||t instanceof s)&&(t.byteLength!==t.buffer.byteLength&&(a=t.byteOffset+r),t=t.buffer),this.lastWrittenByte=n?i:0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,i),this._mark=0,this._marks=[]}available(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=t,this}back(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(t)){const e=2*(this.offset+t),n=new Uint8Array(e);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(t,"uint8")}readArray(t,e){const n=o[e].BYTES_PER_ELEMENT*t,r=this.byteOffset+this.offset,i=this.buffer.slice(r,r+n);if(this.littleEndian===a&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(r,r+n));t.reverse();const i=new o[e](t.buffer);return this.offset+=n,i.reverse(),i}const s=new o[e](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e="";for(let n=0;n<t;n++)e+=this.readChar();return e}readUtf8(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return r(this.readBytes(t))}decodeText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return r(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return i.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},63:function(){"use strict";!function(t){if(t.TextEncoder&&t.TextDecoder)return!1;function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8";if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fatal:!1};if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{stream:!1}).stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let e=0;const n=t.length;let r=0,i=Math.max(32,n+(n>>1)+7),a=new Uint8Array(i>>3<<3);for(;e<n;){let o=t.charCodeAt(e++);if(o>=55296&&o<=56319){if(e<n){const n=t.charCodeAt(e);56320===(64512&n)&&(++e,o=((1023&o)<<10)+(1023&n)+65536)}if(o>=55296&&o<=56319)continue}if(r+4>a.length){i+=8,i*=1+e/t.length*2,i=i>>3<<3;const n=new Uint8Array(i);n.set(a),a=n}if(0!==(4294967168&o)){if(0===(4294965248&o))a[r++]=o>>6&31|192;else if(0===(4294901760&o))a[r++]=o>>12&15|224,a[r++]=o>>6&63|128;else{if(0!==(4292870144&o))continue;a[r++]=o>>18&7|240,a[r++]=o>>12&63|128,a[r++]=o>>6&63|128}a[r++]=63&o|128}else a[r++]=o}return a.slice(0,r)},Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(n.prototype,"fatal",{value:!1}),Object.defineProperty(n.prototype,"ignoreBOM",{value:!1}),n.prototype.decode=function(t){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{stream:!1}).stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const e=new Uint8Array(t);let n=0;const r=e.length,i=[];for(;n<r;){const t=e[n++];if(0===t)break;if(0===(128&t))i.push(t);else if(192===(224&t)){const r=63&e[n++];i.push((31&t)<<6|r)}else if(224===(240&t)){const r=63&e[n++],a=63&e[n++];i.push((31&t)<<12|r<<6|a)}else if(240===(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,i.push(r>>>10&1023|55296),r=56320|1023&r),i.push(r)}}return String.fromCharCode.apply(null,i)},t.TextEncoder=e,t.TextDecoder=n}("undefined"!==typeof window?window:"undefined"!==typeof self?self:this)},6889:(t,e,n)=>{"use strict";n.r(e),n.d(e,{isAnyArray:()=>i});const r=Object.prototype.toString;function i(t){const e=r.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},2516:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},1328:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!==typeof t||t!==t||t===1/0||t===-1/0)}},9867:(t,e,n)=>{var r=n(1328);t.exports=Number.isInteger||function(t){return"number"===typeof t&&r(t)&&Math.floor(t)===t}},3194:(t,e,n)=>{var r=n(8734),i=n(4914);t.exports={encode:r,decode:i}},4914:t=>{var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,n=799,r=3406,i=2276,a=1567,o=3784,s=5793,l=2896;function h(){}function c(t,e){for(var n,r,i=0,a=[],o=16;o>0&&!t[o-1];)o--;a.push({children:[],index:0});var s,l=a[0];for(n=0;n<o;n++){for(r=0;r<t[n];r++){for((l=a.pop()).children[l.index]=e[i];l.index>0;){if(0===a.length)throw new Error("Could not recreate Huffman Table");l=a.pop()}for(l.index++,a.push(l);a.length<=n;)a.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;i++}n+1<o&&(a.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return a[0].children}function u(e,n,r,i,a,o,s,l,h,c){r.precision,r.samplesPerLine,r.scanLines;var u=r.mcusPerLine,d=r.progressive,f=(r.maxH,r.maxV,n),m=0,p=0;function g(){if(p>0)return p--,m>>p&1;if(255==(m=e[n++])){var t=e[n++];if(t)throw new Error("unexpected marker: "+(m<<8|t).toString(16))}return p=7,m>>>7}function v(t){for(var e,n=t;null!==(e=g());){if("number"===typeof(n=n[e]))return n;if("object"!==typeof n)throw new Error("invalid huffman sequence")}return null}function _(t){for(var e=0;t>0;){var n=g();if(null===n)return;e=e<<1|n,t--}return e}function w(t){var e=_(t);return e>=1<<t-1?e:e+(-1<<t)+1}var y=0;var b,x=0;function M(t,e,n,r,i){var a=n%u,o=(n/u|0)*t.v+r,s=a*t.h+i;void 0===t.blocks[o]&&c.tolerantDecoding||e(t,t.blocks[o][s])}function S(t,e,n){var r=n/t.blocksPerLine|0,i=n%t.blocksPerLine;void 0===t.blocks[r]&&c.tolerantDecoding||e(t,t.blocks[r][i])}var E,k,C,A,P,T,D=i.length;T=d?0===o?0===l?function(t,e){var n=v(t.huffmanTableDC),r=0===n?0:w(n)<<h;e[0]=t.pred+=r}:function(t,e){e[0]|=g()<<h}:0===l?function(e,n){if(y>0)y--;else for(var r=o,i=s;r<=i;){var a=v(e.huffmanTableAC),l=15&a,c=a>>4;if(0!==l)n[t[r+=c]]=w(l)*(1<<h),r++;else{if(c<15){y=_(c)+(1<<c)-1;break}r+=16}}}:function(e,n){for(var r=o,i=s,a=0;r<=i;){var l=t[r],c=n[l]<0?-1:1;switch(x){case 0:var u=v(e.huffmanTableAC),d=15&u;if(a=u>>4,0===d)a<15?(y=_(a)+(1<<a),x=4):(a=16,x=1);else{if(1!==d)throw new Error("invalid ACn encoding");b=w(d),x=a?2:3}continue;case 1:case 2:n[l]?n[l]+=(g()<<h)*c:0===--a&&(x=2==x?3:0);break;case 3:n[l]?n[l]+=(g()<<h)*c:(n[l]=b<<h,x=0);break;case 4:n[l]&&(n[l]+=(g()<<h)*c)}r++}4===x&&0===--y&&(x=0)}:function(e,n){var r=v(e.huffmanTableDC),i=0===r?0:w(r);n[0]=e.pred+=i;for(var a=1;a<64;){var o=v(e.huffmanTableAC),s=15&o,l=o>>4;if(0!==s)n[t[a+=l]]=w(s),a++;else{if(l<15)break;a+=16}}};var I,N,R,L,U=0;for(N=1==D?i[0].blocksPerLine*i[0].blocksPerColumn:u*r.mcusPerColumn,a||(a=N);U<N;){for(k=0;k<D;k++)i[k].pred=0;if(y=0,1==D)for(E=i[0],P=0;P<a;P++)S(E,T,U),U++;else for(P=0;P<a;P++){for(k=0;k<D;k++)for(R=(E=i[k]).h,L=E.v,C=0;C<L;C++)for(A=0;A<R;A++)M(E,T,U,C,A);if(++U===N)break}if(U===N)do{if(255===e[n]&&0!==e[n+1])break;n+=1}while(n<e.length-2);if(p=0,(I=e[n]<<8|e[n+1])<65280)throw new Error("marker was not found");if(!(I>=65488&&I<=65495))break;n+=2}return n-f}function d(t,h){var c,u,d=[],f=h.blocksPerLine,m=h.blocksPerColumn,p=f<<3,v=new Int32Array(64),_=new Uint8Array(64);function w(t,c,u){var d,f,m,p,g,v,_,w,y,b,x=h.quantizationTable,M=u;for(b=0;b<64;b++)M[b]=t[b]*x[b];for(b=0;b<8;++b){var S=8*b;0!=M[1+S]||0!=M[2+S]||0!=M[3+S]||0!=M[4+S]||0!=M[5+S]||0!=M[6+S]||0!=M[7+S]?(d=s*M[0+S]+128>>8,f=s*M[4+S]+128>>8,m=M[2+S],p=M[6+S],g=l*(M[1+S]-M[7+S])+128>>8,w=l*(M[1+S]+M[7+S])+128>>8,v=M[3+S]<<4,_=M[5+S]<<4,y=d-f+1>>1,d=d+f+1>>1,f=y,y=m*o+p*a+128>>8,m=m*a-p*o+128>>8,p=y,y=g-_+1>>1,g=g+_+1>>1,_=y,y=w+v+1>>1,v=w-v+1>>1,w=y,y=d-p+1>>1,d=d+p+1>>1,p=y,y=f-m+1>>1,f=f+m+1>>1,m=y,y=g*i+w*r+2048>>12,g=g*r-w*i+2048>>12,w=y,y=v*n+_*e+2048>>12,v=v*e-_*n+2048>>12,_=y,M[0+S]=d+w,M[7+S]=d-w,M[1+S]=f+_,M[6+S]=f-_,M[2+S]=m+v,M[5+S]=m-v,M[3+S]=p+g,M[4+S]=p-g):(y=s*M[0+S]+512>>10,M[0+S]=y,M[1+S]=y,M[2+S]=y,M[3+S]=y,M[4+S]=y,M[5+S]=y,M[6+S]=y,M[7+S]=y)}for(b=0;b<8;++b){var E=b;0!=M[8+E]||0!=M[16+E]||0!=M[24+E]||0!=M[32+E]||0!=M[40+E]||0!=M[48+E]||0!=M[56+E]?(d=s*M[0+E]+2048>>12,f=s*M[32+E]+2048>>12,m=M[16+E],p=M[48+E],g=l*(M[8+E]-M[56+E])+2048>>12,w=l*(M[8+E]+M[56+E])+2048>>12,v=M[24+E],_=M[40+E],y=d-f+1>>1,d=d+f+1>>1,f=y,y=m*o+p*a+2048>>12,m=m*a-p*o+2048>>12,p=y,y=g-_+1>>1,g=g+_+1>>1,_=y,y=w+v+1>>1,v=w-v+1>>1,w=y,y=d-p+1>>1,d=d+p+1>>1,p=y,y=f-m+1>>1,f=f+m+1>>1,m=y,y=g*i+w*r+2048>>12,g=g*r-w*i+2048>>12,w=y,y=v*n+_*e+2048>>12,v=v*e-_*n+2048>>12,_=y,M[0+E]=d+w,M[56+E]=d-w,M[8+E]=f+_,M[48+E]=f-_,M[16+E]=m+v,M[40+E]=m-v,M[24+E]=p+g,M[32+E]=p-g):(y=s*u[b+0]+8192>>14,M[0+E]=y,M[8+E]=y,M[16+E]=y,M[24+E]=y,M[32+E]=y,M[40+E]=y,M[48+E]=y,M[56+E]=y)}for(b=0;b<64;++b){var k=128+(M[b]+8>>4);c[b]=k<0?0:k>255?255:k}}g(p*m*8);for(var y=0;y<m;y++){var b=y<<3;for(c=0;c<8;c++)d.push(new Uint8Array(p));for(var x=0;x<f;x++){w(h.blocks[y][x],_,v);var M=0,S=x<<3;for(u=0;u<8;u++){var E=d[b+u];for(c=0;c<8;c++)E[S+c]=_[M++]}}}return d}function f(t){return t<0?0:t>255?255:t}h.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var n=1e3*this.opts.maxResolutionInMP*1e3,r=0;e.length;function i(){var t=e[r]<<8|e[r+1];return r+=2,t}function a(){var t=i(),n=e.subarray(r,r+t-2);return r+=n.length,n}function o(t){var e,n,r=1,i=1;for(n in t.components)t.components.hasOwnProperty(n)&&(r<(e=t.components[n]).h&&(r=e.h),i<e.v&&(i=e.v));var a=Math.ceil(t.samplesPerLine/8/r),o=Math.ceil(t.scanLines/8/i);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];var s=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/r),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/i),h=a*e.h,c=o*e.v,u=[];g(256*(c*h));for(var d=0;d<c;d++){for(var f=[],m=0;m<h;m++)f.push(new Int32Array(64));u.push(f)}e.blocksPerLine=s,e.blocksPerColumn=l,e.blocks=u}t.maxH=r,t.maxV=i,t.mcusPerLine=a,t.mcusPerColumn=o}var s,l,h=null,f=null,m=[],p=[],v=[],_=[],w=i(),y=-1;if(this.comments=[],65496!=w)throw new Error("SOI not found");for(w=i();65497!=w;){switch(w){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=a();if(65534===w){var x=String.fromCharCode.apply(null,b);this.comments.push(x)}65504===w&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(h={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])}),65505===w&&69===b[0]&&120===b[1]&&105===b[2]&&102===b[3]&&0===b[4]&&(this.exifBuffer=b.subarray(5,b.length)),65518===w&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&0===b[5]&&(f={version:b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:for(var M=i()+r-2;r<M;){var S=e[r++];g(256);var E=new Int32Array(64);if(S>>4===0)for(W=0;W<64;W++){E[t[W]]=e[r++]}else{if(S>>4!==1)throw new Error("DQT: invalid table spec");for(W=0;W<64;W++){E[t[W]]=i()}}m[15&S]=E}break;case 65472:case 65473:case 65474:i(),(s={}).extended=65473===w,s.progressive=65474===w,s.precision=e[r++],s.scanLines=i(),s.samplesPerLine=i(),s.components={},s.componentsOrder=[];var k=s.scanLines*s.samplesPerLine;if(k>n){var C=Math.ceil((k-n)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${C}MP`)}var A,P=e[r++];for(Y=0;Y<P;Y++){A=e[r];var T=e[r+1]>>4,D=15&e[r+1],I=e[r+2];if(T<=0||D<=0)throw new Error("Invalid sampling factor, expected values above 0");s.componentsOrder.push(A),s.components[A]={h:T,v:D,quantizationIdx:I},r+=3}o(s),p.push(s);break;case 65476:var N=i();for(Y=2;Y<N;){var R=e[r++],L=new Uint8Array(16),U=0;for(W=0;W<16;W++,r++)U+=L[W]=e[r];g(16+U);var O=new Uint8Array(U);for(W=0;W<U;W++,r++)O[W]=e[r];Y+=17+U,(R>>4===0?_:v)[15&R]=c(L,O)}break;case 65501:i(),l=i();break;case 65500:i(),i();break;case 65498:i();var z=e[r++],F=[];for(Y=0;Y<z;Y++){q=s.components[e[r++]];var B=e[r++];q.huffmanTableDC=_[B>>4],q.huffmanTableAC=v[15&B],F.push(q)}var V=e[r++],H=e[r++],G=e[r++],j=u(e,r,s,F,l,V,H,G>>4,15&G,this.opts);r+=j;break;case 65535:255!==e[r]&&r--;break;default:if(255==e[r-3]&&e[r-2]>=192&&e[r-2]<=254){r-=3;break}if(224===w||225==w){if(-1!==y)throw new Error(`first unknown JPEG marker at offset ${y.toString(16)}, second unknown JPEG marker ${w.toString(16)} at offset ${(r-1).toString(16)}`);y=r-1;const t=i();if(255===e[r+t-2]){r+=t-2;break}}throw new Error("unknown JPEG marker "+w.toString(16))}w=i()}if(1!=p.length)throw new Error("only single frame JPEGs supported");for(var Y=0;Y<p.length;Y++){var X=p[Y].components;for(var W in X)X[W].quantizationTable=m[X[W].quantizationIdx],delete X[W].quantizationIdx}this.width=s.samplesPerLine,this.height=s.scanLines,this.jfif=h,this.adobe=f,this.components=[];for(Y=0;Y<s.componentsOrder.length;Y++){var q=s.components[s.componentsOrder[Y]];this.components.push({lines:d(0,q),scaleX:q.h/s.maxH,scaleY:q.v/s.maxV})}},getData:function(t,e){var n,r,i,a,o,s,l,h,c,u,d,m,p,v,_,w,y,b,x,M,S,E=this.width/t,k=this.height/e,C=0,A=t*e*this.components.length;g(A);var P=new Uint8Array(A);switch(this.components.length){case 1:for(n=this.components[0],u=0;u<e;u++)for(o=n.lines[0|u*n.scaleY*k],c=0;c<t;c++)d=o[0|c*n.scaleX*E],P[C++]=d;break;case 2:for(n=this.components[0],r=this.components[1],u=0;u<e;u++)for(o=n.lines[0|u*n.scaleY*k],s=r.lines[0|u*r.scaleY*k],c=0;c<t;c++)d=o[0|c*n.scaleX*E],P[C++]=d,d=s[0|c*r.scaleX*E],P[C++]=d;break;case 3:for(S=!0,this.adobe&&this.adobe.transformCode?S=!0:"undefined"!==typeof this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],u=0;u<e;u++)for(o=n.lines[0|u*n.scaleY*k],s=r.lines[0|u*r.scaleY*k],l=i.lines[0|u*i.scaleY*k],c=0;c<t;c++)S?(d=o[0|c*n.scaleX*E],m=s[0|c*r.scaleX*E],b=f(d+1.402*((p=l[0|c*i.scaleX*E])-128)),x=f(d-.3441363*(m-128)-.71413636*(p-128)),M=f(d+1.772*(m-128))):(b=o[0|c*n.scaleX*E],x=s[0|c*r.scaleX*E],M=l[0|c*i.scaleX*E]),P[C++]=b,P[C++]=x,P[C++]=M;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(S=!1,this.adobe&&this.adobe.transformCode?S=!0:"undefined"!==typeof this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],a=this.components[3],u=0;u<e;u++)for(o=n.lines[0|u*n.scaleY*k],s=r.lines[0|u*r.scaleY*k],l=i.lines[0|u*i.scaleY*k],h=a.lines[0|u*a.scaleY*k],c=0;c<t;c++)S?(d=o[0|c*n.scaleX*E],m=s[0|c*r.scaleX*E],p=l[0|c*i.scaleX*E],v=h[0|c*a.scaleX*E],_=255-f(d+1.402*(p-128)),w=255-f(d-.3441363*(m-128)-.71413636*(p-128)),y=255-f(d+1.772*(m-128))):(_=o[0|c*n.scaleX*E],w=s[0|c*r.scaleX*E],y=l[0|c*i.scaleX*E],v=h[0|c*a.scaleX*E]),P[C++]=255-_,P[C++]=255-w,P[C++]=255-y,P[C++]=255-v;break;default:throw new Error("Unsupported color mode")}return P},copyToImageData:function(t,e){var n,r,i,a,o,s,l,h,c,u=t.width,d=t.height,m=t.data,p=this.getData(u,d),g=0,v=0;switch(this.components.length){case 1:for(r=0;r<d;r++)for(n=0;n<u;n++)i=p[g++],m[v++]=i,m[v++]=i,m[v++]=i,e&&(m[v++]=255);break;case 3:for(r=0;r<d;r++)for(n=0;n<u;n++)l=p[g++],h=p[g++],c=p[g++],m[v++]=l,m[v++]=h,m[v++]=c,e&&(m[v++]=255);break;case 4:for(r=0;r<d;r++)for(n=0;n<u;n++)o=p[g++],s=p[g++],i=p[g++],l=255-f(o*(1-(a=p[g++])/255)+a),h=255-f(s*(1-a/255)+a),c=255-f(i*(1-a/255)+a),m[v++]=l,m[v++]=h,m[v++]=c,e&&(m[v++]=255);break;default:throw new Error("Unsupported color mode")}}};var m=0,p=0;function g(){var t=m+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);if(t>p){var e=Math.ceil((t-p)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${e}MB`)}m=t}return h.resetMaxMemoryUsage=function(t){m=0,p=t},h.getBytesAllocated=function(){return m},h.requestMemoryAllocation=g,h}();t.exports=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...n},i=new Uint8Array(t),a=new e;a.opts=r,e.resetMaxMemoryUsage(1024*r.maxMemoryUsageInMB*1024),a.parse(i);var o=r.formatAsRGBA?4:3,s=a.width*a.height*o;try{e.requestMemoryAllocation(s);var l={width:a.width,height:a.height,exifBuffer:a.exifBuffer,data:r.useTArray?new Uint8Array(s):Buffer.alloc(s)};a.comments.length>0&&(l.comments=a.comments)}catch(h){if(h instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+s);if(h instanceof ReferenceError&&"Buffer is not defined"===h.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw h}return a.copyToImageData(l,r.formatAsRGBA),l}},8734:t=>{function e(t){Math.round;var e,n,r,i,a,o=Math.floor,s=new Array(64),l=new Array(64),h=new Array(64),c=new Array(64),u=new Array(65535),d=new Array(65535),f=new Array(64),m=new Array(64),p=[],g=0,v=7,_=new Array(64),w=new Array(64),y=new Array(64),b=new Array(256),x=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function I(t,e){for(var n=0,r=0,i=new Array,a=1;a<=16;a++){for(var o=1;o<=t[a];o++)i[e[r]]=[],i[e[r]][0]=n,i[e[r]][1]=a,r++,n++;n*=2}return i}function N(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(g|=1<<v),n--,--v<0&&(255==g?(R(255),R(0)):R(g),v=7,g=0)}function R(t){p.push(t)}function L(t){R(t>>8&255),R(255&t)}function U(t,e,n,r,i){for(var a,o=i[0],s=i[240],l=function(t,e){var n,r,i,a,o,s,l,h,c,u,d=0;for(c=0;c<8;++c){n=t[d],r=t[d+1],i=t[d+2],a=t[d+3],o=t[d+4],s=t[d+5],l=t[d+6];var m=n+(h=t[d+7]),p=n-h,g=r+l,v=r-l,_=i+s,w=i-s,y=a+o,b=a-o,x=m+y,M=m-y,S=g+_,E=g-_;t[d]=x+S,t[d+4]=x-S;var k=.707106781*(E+M);t[d+2]=M+k,t[d+6]=M-k;var C=.382683433*((x=b+w)-(E=v+p)),A=.5411961*x+C,P=1.306562965*E+C,T=.707106781*(S=w+v),D=p+T,I=p-T;t[d+5]=I+A,t[d+3]=I-A,t[d+1]=D+P,t[d+7]=D-P,d+=8}for(d=0,c=0;c<8;++c){n=t[d],r=t[d+8],i=t[d+16],a=t[d+24],o=t[d+32],s=t[d+40],l=t[d+48];var N=n+(h=t[d+56]),R=n-h,L=r+l,U=r-l,O=i+s,z=i-s,F=a+o,B=a-o,V=N+F,H=N-F,G=L+O,j=L-O;t[d]=V+G,t[d+32]=V-G;var Y=.707106781*(j+H);t[d+16]=H+Y,t[d+48]=H-Y;var X=.382683433*((V=B+z)-(j=U+R)),W=.5411961*V+X,q=1.306562965*j+X,$=.707106781*(G=z+U),Z=R+$,K=R-$;t[d+40]=K+W,t[d+24]=K-W,t[d+8]=Z+q,t[d+56]=Z-q,d++}for(c=0;c<64;++c)u=t[c]*e[c],f[c]=u>0?u+.5|0:u-.5|0;return f}(t,e),h=0;h<64;++h)m[M[h]]=l[h];var c=m[0]-n;n=m[0],0==c?N(r[0]):(N(r[d[a=32767+c]]),N(u[a]));for(var p=63;p>0&&0==m[p];p--);if(0==p)return N(o),n;for(var g,v=1;v<=p;){for(var _=v;0==m[v]&&v<=p;++v);var w=v-_;if(w>=16){g=w>>4;for(var y=1;y<=g;++y)N(s);w&=15}a=32767+m[v],N(i[(w<<4)+d[a]]),N(u[a]),v++}return 63!=p&&N(o),n}function O(t){if(t<=0&&(t=1),t>100&&(t=100),a!=t){(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=o((e[n]*t+50)/100);r<1?r=1:r>255&&(r=255),s[M[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var u=o((i[a]*t+50)/100);u<1?u=1:u>255&&(u=255),l[M[a]]=u}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,m=0;m<8;m++)for(var p=0;p<8;p++)h[f]=1/(s[M[f]]*d[m]*d[p]*8),c[f]=1/(l[M[f]]*d[m]*d[p]*8),f++})(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),a=t}}this.encode=function(t,a){var o;(new Date).getTime();a&&O(a),p=new Array,g=0,v=7,L(65496),L(65504),L(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),L(1),L(1),R(0),R(0),"undefined"!==typeof(o=t.comments)&&o.constructor===Array&&o.forEach((t=>{if("string"===typeof t){L(65534);var e,n=t.length;for(L(n+2),e=0;e<n;e++)R(t.charCodeAt(e))}})),function(t){if(t){L(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?L(t.length+2):(L(t.length+5+2),R(69),R(120),R(105),R(102),R(0));for(var e=0;e<t.length;e++)R(t[e])}}(t.exifBuffer),function(){L(65499),L(132),R(0);for(var t=0;t<64;t++)R(s[t]);R(1);for(var e=0;e<64;e++)R(l[e])}(),function(t,e){L(65472),L(17),R(8),L(e),L(t),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)}(t.width,t.height),function(){L(65476),L(418),R(0);for(var t=0;t<16;t++)R(S[t+1]);for(var e=0;e<=11;e++)R(E[e]);R(16);for(var n=0;n<16;n++)R(k[n+1]);for(var r=0;r<=161;r++)R(C[r]);R(1);for(var i=0;i<16;i++)R(A[i+1]);for(var a=0;a<=11;a++)R(P[a]);R(17);for(var o=0;o<16;o++)R(T[o+1]);for(var s=0;s<=161;s++)R(D[s])}(),L(65498),L(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var u=0,d=0,f=0;g=0,v=7,this.encode.displayName="_encode_";for(var m,b,M,I,z,F,B,V,H,G=t.data,j=t.width,Y=t.height,X=4*j,W=0;W<Y;){for(m=0;m<X;){for(F=z=X*W+m,B=-1,V=0,H=0;H<64;H++)F=z+(V=H>>3)*X+(B=4*(7&H)),W+V>=Y&&(F-=X*(W+1+V-Y)),m+B>=X&&(F-=m+B-X+4),b=G[F++],M=G[F++],I=G[F++],_[H]=(x[b]+x[M+256|0]+x[I+512|0]>>16)-128,w[H]=(x[b+768|0]+x[M+1024|0]+x[I+1280|0]>>16)-128,y[H]=(x[b+1280|0]+x[M+1536|0]+x[I+1792|0]>>16)-128;u=U(_,h,u,e,r),d=U(w,c,d,n,i),f=U(y,c,f,n,i),m+=32}W+=8}if(v>=0){var q=[];q[1]=v+1,q[0]=(1<<v+1)-1,N(q)}return L(65497),Buffer.from(p)},function(){(new Date).getTime();t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)b[e]=t(e)}(),e=I(S,E),n=I(A,P),r=I(k,C),i=I(T,D),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var r=t;r<e;r++)d[32767+r]=n,u[32767+r]=[],u[32767+r][1]=n,u[32767+r][0]=r;for(var i=-(e-1);i<=-t;i++)d[32767+i]=n,u[32767+i]=[],u[32767+i][1]=n,u[32767+i][0]=e-1+i;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256|0]=38470*t,x[t+512|0]=7471*t+32768,x[t+768|0]=-11059*t,x[t+1024|0]=-21709*t,x[t+1280|0]=32768*t+8421375,x[t+1536|0]=-27439*t,x[t+1792|0]=-5329*t}(),O(t),(new Date).getTime()}()}t.exports=function(t,n){"undefined"===typeof n&&(n=50);return{data:new e(n).encode(t,n),width:t.width,height:t.height}}},1512:t=>{t.exports=function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};e[o][0].call(h.exports,(function(t){var n=e[o][1][t];return i(n||t)}),h,h.exports,t,e,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){var r,i,a,o,s,l=function(t,e){for(var n in e)h.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},h={}.hasOwnProperty;r=t("./PriorityQueue/AbstractPriorityQueue"),i=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),a=t("./PriorityQueue/BHeapStrategy"),(s=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return l(e,t),e}(r)).ArrayStrategy=i,s.BinaryHeapStrategy=o,s.BHeapStrategy=a,e.exports=s},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,n){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,n){var r;r=function(t,e,n){var r,i,a;for(i=0,r=t.length;i<r;)n(t[a=i+r>>>1],e)>=0?i=a+1:r=a;return i},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=r(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,n){e.exports=function(){function t(t){var e,n,r,i,a,o,s,l;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,s=0;1<<s<this.pageSize;)s+=1;if(1<<s!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=s,this._emptyMemoryPageTemplate=e=[],n=0,a=this.pageSize;0<=a?n<a:n>a;0<=a?++n:--n)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(r=0,i=(o=t.initialValues).length;r<i;r++)l=o[r],this.queue(l)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var n;for(n=t>>this._shift;n>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[n][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var n,r,i,a;for(n=this.comparator;t>1&&(r=t&this._mask,t<this.pageSize||r>3?i=t&~this._mask|r>>1:r<2?(i=t-this.pageSize>>this._shift,i+=i&~(this._mask>>1),i|=this.pageSize>>1):i=t-2,!(n(a=this._read(i),e)<0));)this._write(i,e),this._write(t,a),t=i},t.prototype._bubbleDown=function(t,e){var n,r,i,a,o;for(o=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?n=r=t+2:t&this.pageSize>>1?(n=(t&~this._mask)>>1,r=1+(n=1+(n|=t&this._mask>>1)<<this._shift)):r=(n=t+(t&this._mask))+1,n!==r&&r<=this.length)if(i=this._read(n),a=this._read(r),o(i,e)<0&&o(i,a)<=0)this._write(n,e),this._write(t,i),t=n;else{if(!(o(a,e)<0))break;this._write(r,e),this._write(t,a),t=r}else{if(!(n<=this.length))break;if(!(o(i=this._read(n),e)<0))break;this._write(n,e),this._write(t,i),t=n}},t}()},{}],5:[function(t,e,n){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,n;if(this.data.length>0)for(t=e=1,n=this.data.length;1<=n?e<n:e>n;t=1<=n?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,n;t>0&&(e=t-1>>>1,this.comparator(this.data[t],this.data[e])<0);)n=this.data[e],this.data[e]=this.data[t],this.data[t]=n,t=e},t.prototype._bubbleDown=function(t){var e,n,r,i,a;for(e=this.data.length-1;i=1+(n=1+(t<<1)),r=t,n<=e&&this.comparator(this.data[n],this.data[r])<0&&(r=n),i<=e&&this.comparator(this.data[i],this.data[r])<0&&(r=i),r!==t;)a=this.data[r],this.data[r]=this.data[t],this.data[t]=a,t=r},t}()},{}]},{},[1])(1)},4723:function(t){t.exports=function(){"use strict";function t(t){return"string"===typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function n(t){return e(t)}function r(t){return t}function i(t){var e={};return t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}))}function a(t,e){if(e.length!==t.length)return!1;for(var n=0;n<t.length;n++){if(e[n].compareArray&&!e[n].compareArray(t[n]))return!1;if(e[n]!==t[n])return!1}return!0}function o(t,e){Object.keys(e).forEach((function(n){t[n]=e[n]}))}function s(){for(var t=1,e=0,n=0;n<arguments.length;n++){var r=arguments[n];e+=c(r),t*=r}return 0!==e?h(t,e):t}function l(t,e){if(0===e)throw new Error("Divide by zero");var n=Math.pow(10,c(e));return s(t,n/(n*e))}function h(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function c(t){if(!isFinite(t))return 0;for(var e=0;t%1!==0;)t*=10,e++;return e}function u(){var t;if(!this)return t=Object.create(u.prototype),u.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function d(t,e){throw new u("Incompatible units: "+t+" and "+e)}u.prototype=Object.create(Error.prototype,{constructor:{value:u}});var f={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","\u03bc","\xb5","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","\u03a9","\u2126"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},m=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],p="<1>",g=[p];function v(t,e){var r=e[1],i=e[3]||[],a=e[4]||[];if(!n(r))throw new u(t+": Invalid unit definition. 'scalar' must be a number");i.forEach((function(e){if(void 0===f[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),a.forEach((function(e){if(void 0===f[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var _={},w={},y={},b={},x={};for(var M in f)if(f.hasOwnProperty(M)){var S=f[M];if("prefix"===S[2]){_[M]=S[1];for(var E=0;E<S[0].length;E++)w[S[0][E]]=M}else{v(M,S),y[M]={scalar:S[1],numerator:S[3],denominator:S[4]};for(var k=0;k<S[0].length;k++)b[S[0][k]]=M}x[M]=S[0][0]}function C(t){var e,n=[],r=Object.keys(f);if("undefined"===typeof t)for(e=0;e<r.length;e++)-1===["","prefix"].indexOf(f[r[e]][2])&&n.push(r[e].substr(1,r[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new u("Kind not recognized");for(e=0;e<r.length;e++)f[r[e]][2]===t&&n.push(r[e].substr(1,r[e].length-2))}return n.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))}function A(t){if(!b[t])throw new u("Unit not recognized");return f[b[t]][0]}var P=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function T(){if(this.signature)return this.signature;for(var t=D.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function D(){if(!this.isBase())return D.call(this.toBase());for(var t,e,n=new Array(P.length),r=0;r<n.length;r++)n[r]=0;for(var i=0;i<this.numerator.length;i++)(t=f[this.numerator[i]])&&(e=P.indexOf(t[2]))>=0&&(n[e]=n[e]+1);for(var a=0;a<this.denominator.length;a++)(t=f[this.denominator[a]])&&(e=P.indexOf(t[2]))>=0&&(n[e]=n[e]-1);return n}var I="[+-]",N="\\d+",R="\\."+N,L=new RegExp("^("+I+"?\\s*(?:(?:"+N+"(?:"+R+")?)|(?:"+R+"))(?:[Ee]"+I+"?"+N+")?)?\\s*([^/]*)(?:/(.+))?$"),U="\\^|\\*{2}",O="[01234]",z=new RegExp("([^ \\*\\d]+?)(?:"+U+")?(-?"+O+"(?![a-zA-Z]))"),F=new RegExp("([^ \\*\\d]+?)(?:"+U+")?("+O+"(?![a-zA-Z]))");function B(e){t(e)||(e=e.toString()),e=e.trim();var n=L.exec(e);if(!n)throw new u(e+": Quantity not recognized");var r=n[1];r?(r=r.replace(/\s/g,""),this.scalar=parseFloat(r)):this.scalar=1;for(var i,a,o,s=n[2],l=n[3];n=z.exec(s);){if(i=parseFloat(n[2]),isNaN(i))throw new u("Unit exponent is not a number");if(0===i&&!j.test(n[1]))throw new u("Unit not recognized");a=n[1]+" ",o="";for(var h=0;h<Math.abs(i);h++)o+=a;i>=0?s=s.replace(n[0],o):(l=l?l+o:o,s=s.replace(n[0],""))}for(;n=F.exec(l);){if(i=parseFloat(n[2]),isNaN(i))throw new u("Unit exponent is not a number");if(0===i&&!j.test(n[1]))throw new u("Unit not recognized");a=n[1]+" ",o="";for(var c=0;c<i;c++)o+=a;l=l.replace(n[0],o)}s&&(this.numerator=W(s.trim())),l&&(this.denominator=W(l.trim()))}var V=Object.keys(w).sort((function(t,e){return e.length-t.length})).join("|"),H=Object.keys(b).sort((function(t,e){return e.length-t.length})).join("|"),G="("+V+")??("+H+")(?:\\b|$)",j=new RegExp("^\\s*("+G+"[\\s\\*]*)+$"),Y=new RegExp(G,"g"),X={};function W(t){var e=X[t];if(e)return e;var n,r=[];if(!j.test(t))throw new u("Unit not recognized");for(;n=Y.exec(t);)r.push(n.slice(1));return r=(r=(r=r.map((function(t){return w[t[0]]?[w[t[0]],b[t[1]]]:[b[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),X[t]=r,r}function q(e){if(!t(e))throw new u("Argument should be a string");try{return this(e)}catch(n){return null}}function $(t){return t instanceof Z}function Z(t,e){if(K.apply(null,arguments),!$(this))return new Z(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=g,this.denominator=g,Q(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:g,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:g):e?(B.call(this,e),this.scalar=t):B.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new u("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new u("Cannot multiply by temperatures");if(!a(this.denominator,g))throw new u("Cannot divide with temperatures")}if(this.initValue=t,J.call(this),this.isTemperature()&&this.baseScalar<0)throw new u("Temperatures must not be less than absolute zero")}function K(e,r){if(r){if(!n(e)||!t(r))throw new u("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||n(e)||$(e)||Q(e)))throw new u("Only string, number or quantity accepted as single initialization value")}function Q(t){return t&&"object"===typeof t&&t.hasOwnProperty("scalar")}function J(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=T.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}Z.prototype={constructor:Z};var tt={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function et(){return i(Object.keys(tt).map((function(t){return tt[t]})))}function nt(t,e){var n=t.units(),r=e.to(n),i=Z(at(n));return Z({scalar:t.scalar-r.scalar,numerator:i.numerator,denominator:i.denominator})}function rt(t,e){var n=e.to(at(t.units()));return Z({scalar:t.scalar-n.scalar,numerator:t.numerator,denominator:t.denominator})}function it(t,e){var n=e.to(at(t.units()));return Z({scalar:t.scalar+n.scalar,numerator:t.numerator,denominator:t.denominator})}function at(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new u("Unknown type for temp conversion from: "+t)}function ot(t,e){var n,r=st(t),i=e.units();if("degK"===i)n=r.scalar;else if("degC"===i)n=r.scalar;else if("degF"===i)n=9*r.scalar/5;else{if("degR"!==i)throw new u("Unknown type for degree conversion to: "+i);n=9*r.scalar/5}return Z({scalar:n,numerator:e.numerator,denominator:e.denominator})}function st(t){var e,n=t.units();if(n.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===n)e=t.scalar;else if("tempC"===n)e=t.scalar;else if("tempF"===n)e=5*t.scalar/9;else{if("tempR"!==n)throw new u("Unknown type for temp conversion from: "+n);e=5*t.scalar/9}return Z({scalar:e,numerator:["<kelvin>"],denominator:g})}function lt(t,e){var n,r=e.units();if("tempK"===r)n=t.baseScalar;else if("tempC"===r)n=t.baseScalar-273.15;else if("tempF"===r)n=9*t.baseScalar/5-459.67;else{if("tempR"!==r)throw new u("Unknown type for temp conversion to: "+r);n=9*t.baseScalar/5}return Z({scalar:n,numerator:e.numerator,denominator:e.denominator})}function ht(t){var e,n=t.units();if(n.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===n)e=t.scalar;else if("tempC"===n)e=t.scalar+273.15;else if("tempF"===n)e=5*(t.scalar+459.67)/9;else{if("tempR"!==n)throw new u("Unknown type for temp conversion from: "+n);e=5*t.scalar/9}return Z({scalar:e,numerator:["<temp-K>"],denominator:g})}function ct(t,e){var n,i=Z(t),a=Z(e);return i.eq(a)?r:(n=i.isTemperature()?function(t){return i.mul(t).to(a).scalar}:function(t){return t*i.baseScalar/a.baseScalar},function(t){var e,r,i;if(Array.isArray(t)){for(r=t.length,i=[],e=0;e<r;e++)i.push(n(t[e]));return i}return n(t)})}Z.prototype.kind=function(){return tt[this.signature.toString()]},o(Z.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&a(this.denominator,g)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),o(Z.prototype,{to:function(e){var n,r;return void 0===e||null===e?this:t(e)?(n=this._conversionCache[e])?n:(r=Z(e)).units()===this.units()?this:(this.isCompatible(r)?r=r.isTemperature()?lt(this,r):r.isDegrees()?ot(this,r):Z({scalar:l(this.baseScalar,r.baseScalar),numerator:r.numerator,denominator:r.denominator}):this.isInverse(r)?r=this.inverse().to(e):d(this.units(),r.units()),this._conversionCache[e]=r,r):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return ht(this);var t=ut[this.units()];return t||(t=dt(this.numerator,this.denominator),ut[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new u("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=Z(e)),n(e)&&(e=Z(e+" "+this.units())),this.isUnitless()?e.isUnitless()||d(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new u("Divide by zero");return Z(s(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var ut={};function dt(t,e){for(var n,r=[],i=[],a=1,o=0;o<t.length;o++)n=t[o],_[n]?a=s(a,_[n]):y[n]&&(a*=y[n].scalar,y[n].numerator&&r.push(y[n].numerator),y[n].denominator&&i.push(y[n].denominator));for(var l=0;l<e.length;l++)n=e[l],_[n]?a/=_[n]:y[n]&&(a/=y[n].scalar,y[n].numerator&&i.push(y[n].numerator),y[n].denominator&&r.push(y[n].denominator));return Z({scalar:a,numerator:r=r.reduce((function(t,e){return t.concat(e)}),[]),denominator:i=i.reduce((function(t,e){return t.concat(e)}),[])})}function ft(t,e,n,r){function i(t){return t!==p}t=t.filter(i),n=n.filter(i),e=e.filter(i),r=r.filter(i);var a={};function o(t,e){for(var n,r,i,o=0;o<t.length;o++)if(_[t[o]]?(n=t[o+1],r=t[o],i=_[r],o++):(n=t[o],r=null,i=1),n&&n!==p)if(a[n]){a[n][0]+=e;var s=a[n][2]?_[a[n][2]]:1;a[n][1===e?3:4]*=l(i,s)}else a[n]=[e,n,r,1,1]}o(t,1),o(e,-1),o(n,1),o(r,-1);var s=[],h=[],c=1;for(var u in a)if(a.hasOwnProperty(u)){var d,f=a[u];if(f[0]>0)for(d=0;d<f[0];d++)s.push(null===f[2]?f[1]:[f[2],f[1]]);else if(f[0]<0)for(d=0;d<-f[0];d++)h.push(null===f[2]?f[1]:[f[2],f[1]]);c*=l(f[3],f[4])}return 0===s.length&&(s=g),0===h.length&&(h=g),[s=s.reduce((function(t,e){return t.concat(e)}),[]),h=h.reduce((function(t,e){return t.concat(e)}),[]),c]}function mt(){}function pt(t,e){return(t+" "+e).trim()}Z.parse=q,Z.getUnits=C,Z.getAliases=A,Z.mulSafe=s,Z.divSafe=l,Z.getKinds=et,Z.swiftConverter=ct,Z.Error=u,o(Z.prototype,{add:function(e){if(t(e)&&(e=Z(e)),this.isCompatible(e)||d(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new u("Cannot add two temperatures");return this.isTemperature()?it(this,e):e.isTemperature()?it(e,this):Z({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=Z(e)),this.isCompatible(e)||d(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return nt(this,e);if(this.isTemperature())return rt(this,e);if(e.isTemperature())throw new u("Cannot subtract a temperature from a differential degree unit");return Z({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(n(e))return Z({scalar:s(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=Z(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new u("Cannot multiply by temperatures");var r=this,i=e;r.isCompatible(i)&&400!==r.signature&&(i=i.to(r));var a=ft(r.numerator,r.denominator,i.numerator,i.denominator);return Z({scalar:s(r.scalar,i.scalar,a[2]),numerator:a[0],denominator:a[1]})},div:function(e){if(n(e)){if(0===e)throw new u("Divide by zero");return Z({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=Z(e)),0===e.scalar)throw new u("Divide by zero");if(e.isTemperature())throw new u("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new u("Cannot divide with temperatures");var r=this,i=e;r.isCompatible(i)&&400!==r.signature&&(i=i.to(r));var a=ft(r.numerator,r.denominator,i.denominator,i.numerator);return Z({scalar:s(r.scalar,a[2])/i.scalar,numerator:a[0],denominator:a[1]})},inverse:function(){if(this.isTemperature())throw new u("Cannot divide with temperatures");if(0===this.scalar)throw new u("Divide by zero");return Z({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),o(Z.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(Z(e)):(this.isCompatible(e)||d(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),o(Z.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return a(t,g)}))},isCompatible:function(e){return t(e)?this.isCompatible(Z(e)):!!$(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==p&&-1===m.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),mt.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,n,r){if(e){var i=e[n];return r===t.length-1?i?i.data:void 0:i}}),this)},mt.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(n,r,i){var a=n[r];return void 0===a&&(a=n[r]={}),i===t.length-1?(a.data=e,e):a}),this)},Z.formatter=pt,o(Z.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=a(this.numerator,g),e=a(this.denominator,g);if(t&&e)return this._units="",this._units;var n=vt(this.numerator),r=vt(this.denominator);return this._units=n+(e?"":"/"+r),this._units},toString:function(e,r){var i;if(n(e))i=this.units(),r=e;else if(t(e))i=e;else if($(e))return this.toPrec(e).toString(r);var a=this.to(i);return a=((void 0!==r?h(a.scalar,r):a.scalar)+" "+a.units()).trim()},format:function(t,e){1===arguments.length&&"function"===typeof t&&(e=t,t=void 0),e=e||Z.formatter;var n=this.to(t);return e.call(this,n.scalar,n.units())}});var gt=new mt;function vt(t){var e=gt.get(t);return e||(e=a(t,g)?"1":wt(_t(t)).join("*"),gt.set(t,e),e)}function _t(t){for(var e,n,r=[],i=0;i<t.length;i++)e=t[i],n=t[i+1],_[e]?(r.push(x[e]+x[n]),i++):r.push(x[e]);return r}function wt(t){return t.reduce((function(t,e){var n=t[e];return n||t.push(n=t[e]=[e,0]),n[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}return Z.version="1.8.0",Z}()},9080:t=>{!function(){function e(t){for(var e=0,i=t.length-1,a=void 0,o=void 0,s=void 0,l=r(e,i);;){if(i<=e)return t[l];if(i==e+1)return t[e]>t[i]&&n(t,e,i),t[l];for(t[a=r(e,i)]>t[i]&&n(t,a,i),t[e]>t[i]&&n(t,e,i),t[a]>t[e]&&n(t,a,e),n(t,a,e+1),o=e+1,s=i;;){do{o++}while(t[e]>t[o]);do{s--}while(t[s]>t[e]);if(s<o)break;n(t,o,s)}n(t,e,s),s<=l&&(e=o),s>=l&&(i=s-1)}}var n=function(t,e,n){var r;return r=[t[n],t[e]],t[e]=r[0],t[n]=r[1],r},r=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},4404:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var r=n(6889);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!(0,r.isAnyArray)(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,i=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(i<0||i>=t.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],l=i+1;l<o;l++)t[l]<s&&(s=t[l]);return s}(t),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,i=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(i<0||i>=t.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],l=i+1;l<o;l++)t[l]>s&&(s=t[l]);return s}(t);if(i===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?i:0:o,l=n.max,h=void 0===l?n.autoMinMax?a:1:l;if(s>=h)throw new RangeError("min option must be smaller than max option");for(var c=(h-s)/(a-i),u=0;u<t.length;u++)e[u]=(t[u]-i)*c+s;return e}},6788:t=>{"use strict";function e(t){this.value=t,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(t){var n=this.nodes.get(t);return n||(n=new e(t),this.nodes.set(t,n)),n}union(t,e){const n=this.find(t),r=this.find(e);n!==r&&(n.rank<r.rank?n.parent=r:n.rank>r.rank?r.parent=n:(r.parent=n,n.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var n=t;null!==n.parent;){var r=n;n=n.parent,r.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}},9233:(t,e,n)=>{"use strict";function r(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}function i(t,e){return Math.sqrt(r(t,e))}n.r(e),n.d(e,{euclidean:()=>i,squaredEuclidean:()=>r})},8772:(t,e,n)=>{"use strict";var r=n(9122),i={DEBUG:!1,ifft2DArray:function(t,e,n){var i=new Array(e*n),a=e/2,o=2*(n-1);r.init(a);for(var s={re:new Array(a),im:new Array(a)},l=0;l<n;l++){for(var h=a-1;h>=0;h--)s.re[h]=t[2*h*n+l],s.im[h]=t[(2*h+1)*n+l];r.bt(s.re,s.im);for(h=a-1;h>=0;h--)i[2*h*n+l]=s.re[h],i[(2*h+1)*n+l]=s.im[h]}var c=new Array(a*o);r.init(o);var u={re:new Array(o),im:new Array(o)},d=o*a;for(h=0;h<e;h+=2){u.re[0]=i[h*n],u.im[0]=i[(h+1)*n];for(l=1;l<n;l++)u.re[l]=i[h*n+l],u.im[l]=i[(h+1)*n+l],u.re[o-l]=i[h*n+l],u.im[o-l]=-i[(h+1)*n+l];r.bt(u.re,u.im);var f=h/2*o;for(l=o-1;l>=0;l--)c[f+l]=u.re[l]/d}return c},fft2DArray:function(t,e,n,i){Object.assign({},{inplace:!0});var a=n/2+1,o=2*e,s=new Array(o*a);r.init(n);for(var l,h,c,u,d,f={re:new Array(n),im:new Array(n)},m={re:new Array(n),im:new Array(n)},p={re:new Array(n),im:new Array(n)},g=0;g<e/2;g++){l=2*g*n,f.re=t.slice(l,l+n),l=(2*g+1)*n,f.im=t.slice(l,l+n),r.fft1d(f.re,f.im),this.reconstructTwoRealFFT(f,m,p),h=4*g*a,c=(4*g+1)*a,u=(4*g+2)*a,d=(4*g+3)*a;for(var v=a-1;v>=0;v--)s[h+v]=m.re[v],s[c+v]=m.im[v],s[u+v]=p.re[v],s[d+v]=p.im[v]}m=null,p=null;var _=new Array(o*a);r.init(e);for(var w={re:new Array(e),im:new Array(e)},y=a-1;y>=0;y--){for(g=e-1;g>=0;g--)w.re[g]=s[2*g*a+y],w.im[g]=s[(2*g+1)*a+y],isNaN(w.re[g])&&(w.re[g]=0),isNaN(w.im[g])&&(w.im[g]=0);r.fft1d(w.re,w.im);for(g=e-1;g>=0;g--)_[2*g*a+y]=w.re[g],_[(2*g+1)*a+y]=w.im[g]}return _},reconstructTwoRealFFT:function(t,e,n){var r,i,a,o,s,l=t.re.length;e.re[0]=t.re[0],e.im[0]=0,n.re[0]=t.im[0],n.im[0]=0;for(var h=l/2;h>0;h--)s=l-h,r=.5*(t.re[h]-t.re[s]),i=.5*(t.re[h]+t.re[s]),a=.5*(t.im[h]-t.im[s]),o=.5*(t.im[h]+t.im[s]),e.re[h]=i,e.im[h]=a,e.re[s]=i,e.im[s]=-a,n.re[h]=o,n.im[h]=-r,n.re[s]=o,n.im[s]=r},convolute2DI:function(t,e,n,r){for(var i,a,o=0;o<n/2;o++)for(var s=0;s<r;s++)i=t[2*o*r+s]*e[2*o*r+s]-t[(2*o+1)*r+s]*e[(2*o+1)*r+s],a=t[2*o*r+s]*e[(2*o+1)*r+s]+t[(2*o+1)*r+s]*e[2*o*r+s],t[2*o*r+s]=i,t[(2*o+1)*r+s]=a},convolute:function(t,e,n,r,i){for(var a=new Array(r*n),o=0;o<n*r;o++)a[o]=t[o];a=this.fft2DArray(a,n,r);var s,l=e.length,h=e[0].length,c=new Array(r*n);for(o=0;o<r*n;o++)c[o]=0;for(var u=Math.floor((l-1)/2),d=Math.floor((h-1)/2),f=0;f<l;f++){s=(f-u+n)%n;for(var m=0;m<h;m++)c[s*r+(m-d+r)%r]=e[f][m]}c=this.fft2DArray(c,n,r);var p=2*n,g=r/2+1;return this.convolute2DI(a,c,p,g),this.ifft2DArray(a,p,g)},toRadix2:function(t,e,n){var r,i,a,o,s=n,l=e;if(0===n||0!==(n&n-1)){for(s=0;n>>++s!=0;);(s=1<<s)-n}if(0===e||0!==(e&e-1)){for(l=0;e>>++l!=0;);((l=1<<l)-e)*s}if(l==e&&s==n)return{data:t,rows:e,cols:n};var h=new Array(l*s),c=Math.floor((l-e)/2)-e,u=Math.floor((s-n)/2)-n;for(r=0;r<l;r++)for(a=r*s,o=(r-c)%e*n,i=0;i<s;i++)h[a+i]=t[o+(i-u)%n];return{data:h,rows:l,cols:s}},crop:function(t,e,n,r,i,a){if(e==r&&n==i)return t;Object.assign({},a);var o,s,l,h,c=new Array(i*r),u=Math.floor((e-r)/2),d=Math.floor((n-i)/2);for(l=0;l<r;l++)for(o=l*i,s=(l+u)*n,h=0;h<i;h++)c[o+h]=t[s+(h+d)];return c}};t.exports=i},9122:function(t,e){(function(){var t,n="0.3.0",r="2013-03";(t=e).toString=function(){return"version "+n+", released "+r};for(var i=0,a=null,o=null,s={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");i=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,e){s.fft(t,e,1)},ifft1d:function(t,e){var n=1/i;s.fft(t,e,-1);for(var r=0;r<i;r++)t[r]*=n,e[r]*=n},bt1d:function(t,e){s.fft(t,e,-1)},fft2d:function(t,e){for(var n=[],r=[],a=0,o=0;o<i;o++){a=o*i;for(var l=0;l<i;l++)n[l]=t[l+a],r[l]=e[l+a];s.fft1d(n,r);for(var h=0;h<i;h++)t[h+a]=n[h],e[h+a]=r[h]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)a=c+u*i,n[u]=t[a],r[u]=e[a];s.fft1d(n,r);for(var d=0;d<i;d++)t[a=c+d*i]=n[d],e[a]=r[d]}},ifft2d:function(t,e){for(var n=[],r=[],a=0,o=0;o<i;o++){a=o*i;for(var l=0;l<i;l++)n[l]=t[l+a],r[l]=e[l+a];s.ifft1d(n,r);for(var h=0;h<i;h++)t[h+a]=n[h],e[h+a]=r[h]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)a=c+u*i,n[u]=t[a],r[u]=e[a];s.ifft1d(n,r);for(var d=0;d<i;d++)t[a=c+d*i]=n[d],e[a]=r[d]}},fft:function(t,e,n){for(var r,s,l,h,c,u,d,f,m,p=i>>2,g=0;g<i;g++)g<(h=a[g])&&(c=t[g],t[g]=t[h],t[h]=c,c=e[g],e[g]=e[h],e[h]=c);for(var v=1;v<i;v<<=1){s=0,r=i/(v<<1);for(var _=0;_<v;_++){u=o[s+p],d=n*o[s];for(var w=_;w<i;w+=v<<1)f=u*t[l=w+v]+d*e[l],m=u*e[l]-d*t[l],t[l]=t[w]-f,t[w]+=f,e[l]=e[w]-m,e[w]+=m;s+=r}}},_initArray:function(){a="undefined"!==typeof Uint32Array?new Uint32Array(i):[],o="undefined"!==typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,n=0;for(a[0]=0;++t<i;){for(n=i>>1;n<=e;)e-=n,n>>=1;e+=n,a[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,n=i>>3,r=t+e,a=Math.sin(Math.PI/i),s=2*a*a,l=Math.sqrt(s*(2-s)),h=o[e]=1,c=o[0]=0;a=2*s;for(var u=1;u<n;u++)s+=a*(h-=s),l-=a*(c+=l),o[u]=c,o[e-u]=h;0!==n&&(o[n]=Math.sqrt(.5));for(var d=0;d<e;d++)o[t-d]=o[d];for(var f=0;f<r;f++)o[f+t]=-o[f]}},l=["init","fft1d","ifft1d","fft2d","ifft2d"],h=0;h<l.length;h++)t[l[h]]=s[l[h]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},1013:(t,e,n)=>{"use strict";e.FFTUtils=n(8772),n(9122)},4456:(t,e,n)=>{"use strict";const{squaredEuclidean:r}=n(9233),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const n=r(t,e);return Math.exp(-n/this.divisor)}}},813:t=>{"use strict";const e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return Math.pow(this.scale*n+this.constant,this.degree)}}},6052:t=>{"use strict";const e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return Math.tanh(this.alpha*n+this.constant)}}},47:(t,e,n)=>{"use strict";const{Matrix:r,MatrixTransposeView:i}=n(6832),a=n(4456),o=n(813),s=n(6052),l=n(8168),h=n(194),c=n(9250),u=n(5623),d={gaussian:a,rbf:a,polynomial:o,poly:o,anova:l,cauchy:h,exponential:c,histogram:u,min:u,laplacian:n(320),multiquadratic:n(480),rational:n(4476),sigmoid:s,mlp:s};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"===typeof t){t=t.toLowerCase();var n=d[t];if(!n)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new n(e)}else{if("object"!==typeof t||"function"!==typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=r.checkMatrix(t),e=void 0===e?t:r.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new i(e));const n=new r(t.rows,e.rows);if(t===e)for(let r=0;r<t.rows;r++)for(let e=r;e<t.rows;e++){const i=this.kernelFunction.compute(t.getRow(r),t.getRow(e));n.set(r,e,i),n.set(e,r,i)}else for(let r=0;r<t.rows;r++)for(let i=0;i<e.rows;i++)n.set(r,i,this.kernelFunction.compute(t.getRow(r),e.getRow(i)));return n}}},8168:t=>{"use strict";const e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var n=0,r=Math.min(t.length,e.length),i=1;i<=r;++i)n+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[i-1],i)-Math.pow(e[i-1],i),2)),this.degree);return n}}},194:(t,e,n)=>{"use strict";const{squaredEuclidean:r}=n(9233),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){return 1/(1+r(t,e)/(this.sigma*this.sigma))}}},9250:(t,e,n)=>{"use strict";const{euclidean:r}=n(9233),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const n=r(t,e);return Math.exp(-n/this.divisor)}}},5623:t=>{"use strict";t.exports=class{compute(t,e){for(var n=Math.min(t.length,e.length),r=0,i=0;i<n;++i)r+=Math.min(t[i],e[i]);return r}}},320:(t,e,n)=>{"use strict";const{euclidean:r}=n(9233),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){const n=r(t,e);return Math.exp(-n/this.sigma)}}},480:(t,e,n)=>{"use strict";const{squaredEuclidean:r}=n(9233),i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){return Math.sqrt(r(t,e)+this.constant*this.constant)}}},4476:(t,e,n)=>{"use strict";const{squaredEuclidean:r}=n(9233),i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){const n=r(t,e);return 1-n/(n+this.constant)}}},8239:(t,e,n)=>{var r=n(1013).FFTUtils;function i(t){var e,n,r=t;if("number"!=typeof t[0]){e=t.length,n=t[0].length,r=new Array(e*n);for(var i=0;i<e;i++)for(var a=0;a<n;a++)r[i*n+a]=t[i][a]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,n=o)}return{data:r,rows:e,cols:n}}t.exports={fft:function(t,e,n){var a,o,s=i(t),l=s.data,h=Object.assign({normalize:!1,divisor:1,rows:s.rows,cols:s.cols},n);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+a+" "+o);a=h.rows,o=h.cols;var c,u,d=h.divisor,f=e.length,m=e[0].length;if(h.normalize)for(d=0,c=0;c<f;c++)for(u=0;u<m;u++)d+=e[c][u];if(0===d)throw new RangeError("convolution: The divisor is equal to zero");var p=r.toRadix2(l,a,o),g=r.convolute(p.data,e,p.rows,p.cols);if(g=r.crop(g,p.rows,p.cols,a,o),0!=d&&1!=d)for(c=0;c<g.length;c++)g[c]/=d;return g},direct:function(t,e,n){var r,a,o=i(t),s=o.data,l=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},n);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+r+" "+a);r=l.rows,a=l.cols;var h,c,u,d,f,m,p=l.divisor,g=e.length,v=e[0].length;if(l.normalize)for(p=0,h=0;h<g;h++)for(c=0;c<v;c++)p+=e[h][c];if(0===p)throw new RangeError("convolution: The divisor is equal to zero");var _=new Array(r*a),w=Math.floor(g/2),y=Math.floor(v/2);for(d=0;d<r;d++)for(u=0;u<a;u++){for(f=0,c=0;c<g;c++)for(h=0;h<v;h++)m=e[g-c-1][v-h-1],f+=s[(d+c-w+r)%r*a+(u+h-y+a)%a]*m;_[d*a+u]=f/p}return _},kernelFactory:{LoG:function(t,e,n){var r=1e3;n&&n.factor&&(r=n.factor);var i,a,o,s,l=new Array(e);r*=-1;var h=(e-1)/2,c=2*t*t;for(i=0;i<e;i++)for(l[i]=new Array(e),s=(i-h)*(i-h),a=0;a<e;a++)o=-((a-h)*(a-h)+s)/c,l[i][a]=Math.round(r*(1+o)*Math.exp(o));return l}},matrix2Array:i}},6832:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6889),i=n(4404);const a=" ".repeat(2),o=" ".repeat(4);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{maxRows:n=15,maxColumns:r=10,maxNumSize:i=8,padMinus:s="auto"}=e;return`${t.constructor.name} {\n${a}[\n${o}${function(t,e,n,r,i){const{rows:a,columns:s}=t,h=Math.min(a,e),c=Math.min(s,n),u=[];if("auto"===i){i=!1;t:for(let e=0;e<h;e++)for(let n=0;n<c;n++)if(t.get(e,n)<0){i=!0;break t}}for(let o=0;o<h;o++){let e=[];for(let n=0;n<c;n++)e.push(l(t.get(o,n),r,i));u.push(`${e.join(" ")}`)}c!==s&&(u[u.length-1]+=` ... ${s-n} more columns`);h!==a&&u.push(`... ${a-e} more rows`);return u.join(`\n${o}`)}(t,n,r,i,s)}\n${a}]\n${a}rows: ${t.rows}\n${a}columns: ${t.columns}\n}`}function l(t,e,n){return(t>=0&&n?` ${h(t,e-1)}`:h(t,e)).padEnd(e)}function h(t,e){let n=t.toString();if(n.length<=e)return n;let r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function c(t,e,n){let r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function u(t,e,n){let r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function m(t,e){if(!r.isAnyArray(e))throw new TypeError("row indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.rows)throw new RangeError("row indices are out of range")}function p(t,e){if(!r.isAnyArray(e))throw new TypeError("column indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.columns)throw new RangeError("column indices are out of range")}function g(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(_("startRow",e),_("endRow",n),_("startColumn",r),_("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];for(let r=0;r<t;r++)n.push(e);return n}function _(t,e){if("number"!==typeof e)throw new TypeError(`${t} must be a number`)}function w(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class y{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let r=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n[i*e+t]);return r}static rowVector(t){let e=new x(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new x(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new x(t,e)}static ones(t,e){return new x(t,e).fill(1)}static rand(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let i=new x(t,e);for(let a=0;a<t;a++)for(let t=0;t<e;t++)i.set(a,t,r());return i}static randInt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");const{min:r=0,max:i=1e3,random:a=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(r>=i)throw new RangeError("min must be smaller than max");let o=i-r,s=new x(t,e);for(let l=0;l<t;l++)for(let t=0;t<e;t++){let e=r+Math.round(a()*o);s.set(l,t,e)}return s}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let r=Math.min(t,e),i=this.zeros(t,e);for(let a=0;a<r;a++)i.set(a,a,n);return i}static diag(t,e,n){let r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);let i=Math.min(r,e,n),a=this.zeros(e,n);for(let o=0;o<i;o++)a.set(o,o,t[o]);return a}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new x(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.min(t.get(a,n),e.get(a,n)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new this(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.max(t.get(a,n),e.get(a,n)));return i}static checkMatrix(t){return y.isMatrix(t)?t:new x(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!==typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);let i=t.get(e,n);for(let r=n;r<t.columns;r++)t.set(e,r,t.get(e,r)/i);for(let r=e+1;r<t.rows;r++){let i=t.get(r,n)/t.get(e,n);t.set(r,n,0);for(let a=n+1;a<t.columns;a++)t.set(r,a,t.get(r,a)-t.get(e,a)*i)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(0===t.maxRow(r))r--;else{let i=0,a=!1;for(;i<n&&!1===a;)1===t.get(r,i)?a=!0:i++;for(let n=0;n<r;n++){let a=t.get(n,i);for(let o=i;o<e;o++){let e=t.get(n,o)-a*t.get(r,o);t.set(n,o,e)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new x(this.rows*e,this.columns*n);for(let i=0;i<e;i++)for(let t=0;t<n;t++)r.setSubMatrix(this,this.rows*i,this.columns*t);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return x.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=d(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){c(this,t),c(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){u(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return x.columnVector(this.getColumn(t))}setColumn(t,e){u(this,t),e=f(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){u(this,t),u(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){c(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){u(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){c(this,t),w(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){c(this,t),w(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius";switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){y.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=x.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,i=new x(e,r),a=new Float64Array(n);for(let o=0;o<r;o++){for(let e=0;e<n;e++)a[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let r=0;r<n;r++)e+=this.get(t,r)*a[r];i.set(t,o,e)}}return i}strassen2x2(t){t=x.checkMatrix(t);let e=new x(2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),a=t.get(0,1),o=this.get(1,0),s=t.get(1,0),l=this.get(1,1),h=t.get(1,1),c=(n+l)*(r+h),u=(o+l)*r,d=n*(a-h),f=l*(s-r),m=(n+i)*h,p=c+f-m+(i-l)*(s+h),g=d+m,v=u+f,_=c-u+d+(o-n)*(r+a);return e.set(0,0,p),e.set(0,1,g),e.set(1,0,v),e.set(1,1,_),e}strassen3x3(t){t=x.checkMatrix(t);let e=new x(3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),l=this.get(2,0),h=this.get(2,1),c=this.get(2,2),u=t.get(0,0),d=t.get(0,1),f=t.get(0,2),m=t.get(1,0),p=t.get(1,1),g=t.get(1,2),v=t.get(2,0),_=t.get(2,1),w=t.get(2,2),y=(n-a)*(-d+p),b=(-n+a+o)*(u-d+p),M=(a+o)*(-u+d),S=n*u,E=(-n+l+h)*(u-f+g),k=(-n+l)*(f-g),C=(l+h)*(-u+f),A=(-i+h+c)*(p+v-_),P=(i-c)*(p-_),T=i*v,D=(h+c)*(-v+_),I=(-i+o+s)*(g+v-w),N=(i-s)*(g-w),R=(o+s)*(-v+w),L=S+T+r*m,U=(n+r+i-a-o-h-c)*p+b+M+S+A+T+D,O=S+E+C+(n+r+i-o-s-l-h)*g+T+I+R,z=y+o*(-u+d+m-p-g-v+w)+b+S+T+I+N,F=y+b+M+S+s*_,B=T+I+N+R+a*f,V=S+E+k+h*(-u+f+m-p-g-v+_)+A+P+T,H=A+P+T+D+l*d,G=S+E+k+C+c*w;return e.set(0,0,L),e.set(0,1,U),e.set(0,2,O),e.set(1,0,z),e.set(1,1,F),e.set(1,2,B),e.set(2,0,V),e.set(2,1,H),e.set(2,2,G),e}mmulStrassen(t){t=x.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,i=t.rows,a=t.columns;function o(t,e,n){let r=t.rows,i=t.columns;if(r===e&&i===n)return t;{let r=y.zeros(e,n);return r=r.setSubMatrix(t,0,0),r}}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${a} matrix: dimensions do not match.`);let s=Math.max(n,i),l=Math.max(r,a);return e=o(e,s,l),function t(e,n,r,i){if(r<=512||i<=512)return e.mmul(n);r%2===1&&i%2===1?(e=o(e,r+1,i+1),n=o(n,r+1,i+1)):r%2===1?(e=o(e,r+1,i),n=o(n,r+1,i)):i%2===1&&(e=o(e,r,i+1),n=o(n,r,i+1));let a=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),l=e.subMatrix(0,a-1,0,s-1),h=n.subMatrix(0,a-1,0,s-1),c=e.subMatrix(0,a-1,s,e.columns-1),u=n.subMatrix(0,a-1,s,n.columns-1),d=e.subMatrix(a,e.rows-1,0,s-1),f=n.subMatrix(a,n.rows-1,0,s-1),m=e.subMatrix(a,e.rows-1,s,e.columns-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),g=t(y.add(l,m),y.add(h,p),a,s),v=t(y.add(d,m),h,a,s),_=t(l,y.sub(u,p),a,s),w=t(m,y.sub(f,h),a,s),b=t(y.add(l,c),p,a,s),x=t(y.sub(d,l),y.add(h,u),a,s),M=t(y.sub(c,m),y.add(f,p),a,s),S=y.add(g,w);S.sub(b),S.add(M);let E=y.add(_,b),k=y.add(v,w),C=y.sub(g,v);C.add(_),C.add(x);let A=y.zeros(2*S.rows,2*S.columns);return A=A.setSubMatrix(S,0,0),A=A.setSubMatrix(E,S.rows,0),A=A.setSubMatrix(k,0,S.columns),A=A.setSubMatrix(C,S.rows,S.columns),A.subMatrix(0,r-1,0,i-1)}(e,t=o(t,s,l),s,l)}scaleRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let a=0;a<this.rows;a++){const t=this.getRow(a);t.length>0&&i(t,{min:e,max:n,output:t}),r.setRow(a,t)}return r}scaleColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let a=0;a<this.columns;a++){const t=this.getColumn(a);t.length&&i(t,{min:e,max:n,output:t}),r.setColumn(a,t)}return r}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),r=this.get(e,this.columns-1-n);this.set(e,n,r),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),r=this.get(this.rows-1-n,e);this.set(n,e,r),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=x.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,i=t.columns,a=new x(e*r,n*i);for(let o=0;o<e;o++)for(let e=0;e<n;e++)for(let n=0;n<r;n++)for(let s=0;s<i;s++)a.set(r*o+n,i*e+s,this.get(o,e)*t.get(n,s));return a}kroneckerSum(t){if(t=x.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(x.eye(n,n)),i=x.eye(e,e).kroneckerProduct(t);return r.add(i)}transpose(){let t=new x(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){g(this,t,e,n,r);let i=new x(e-t+1,r-n+1);for(let a=t;a<=e;a++)for(let e=n;e<=r;e++)i.set(a-t,e-n,this.get(a,e));return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new x(t.length,n-e+1);for(let i=0;i<t.length;i++)for(let a=e;a<=n;a++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,a-e,this.get(t[i],a))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new x(n-e+1,t.length);for(let i=0;i<t.length;i++)for(let a=e;a<=n;a++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(a-e,i,this.get(a,t[i]))}return r}setSubMatrix(t,e,n){if((t=x.checkMatrix(t)).isEmpty())return this;g(this,e,e+t.rows-1,n,n+t.columns-1);for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}selection(t,e){m(this,t),p(this,e);let n=new x(t.length,e.length);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<e.length;t++){let a=e[t];n.set(r,t,this.get(i,a))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new x(this.rows,this.columns))}static copy(t,e){for(const[n,r,i]of t.entries())e.set(n,r,i);return e}sum(t){switch(t){case"row":return function(t){let e=v(t.rows);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){let e=v(t.columns);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=v(t.rows,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){let e=v(t.columns,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:i=this.mean(t)}=e;if("boolean"!==typeof n)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!r.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,a=[];for(let o=0;o<r;o++){let r=0,s=0,l=0;for(let e=0;e<i;e++)l=t.get(o,e)-n[o],r+=l,s+=l*l;e?a.push((s-r*r/i)/(i-1)):a.push((s-r*r/i)/i)}return a}(this,n,i);case"column":if(!r.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,a=[];for(let o=0;o<i;o++){let i=0,s=0,l=0;for(let e=0;e<r;e++)l=t.get(e,o)-n[o],i+=l,s+=l*l;e?a.push((s-i*i/r)/(r-1)):a.push((s-i*i/r)/r)}return a}(this,n,i);case void 0:if("number"!==typeof i)throw new TypeError("mean must be a number");return function(t,e,n){const r=t.rows,i=t.columns,a=r*i;let o=0,s=0,l=0;for(let h=0;h<r;h++)for(let e=0;e<i;e++)l=t.get(h,e)-n,o+=l,s+=l*l;return e?(s-o*o/a)/(a-1):(s-o*o/a)/a}(this,n,i);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"===typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}center(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{center:n=this.mean(t)}=e;switch(t){case"row":if(!r.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}(this,n),this;case"column":if(!r.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}(this,n),this;case void 0:if("number"!==typeof n)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}scale(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.rows;n++){let r=0;for(let e=0;e<t.columns;e++)r+=t.get(n,e)**2/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!r.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.columns;n++){let r=0;for(let e=0;e<t.rows;e++)r+=t.get(e,n)**2/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!r.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let n=0;for(let r=0;r<t.columns;r++)for(let i=0;i<t.rows;i++)n+=t.get(i,r)**2/e;return Math.sqrt(n)}(this);else if("number"!==typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return s(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function b(t,e){return t-e}y.prototype.klass="Matrix","undefined"!==typeof Symbol&&(y.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return s(this)}),y.random=y.rand,y.randomInt=y.randInt,y.diagonal=y.diag,y.prototype.diagonal=y.prototype.diag,y.identity=y.eye,y.prototype.negate=y.prototype.neg,y.prototype.tensorProduct=y.prototype.kroneckerProduct;class x extends y{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),x.isMatrix(t))this.#t(t.rows,t.columns),x.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!r.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if("number"!==typeof(e=(t=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");if(!n[r].every((t=>"number"===typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[r]))}this.rows=t,this.columns=e}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return c(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){u(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let r=0;r<t;r++)n[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)n[r-1]=this.data[e][r];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){"undefined"===typeof e&&(e=t,t=this.columns),u(this,t,!0),e=f(this,e);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"===typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"===typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"===typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"===typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"===typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"===typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"===typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"===typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"===typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"===typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"===typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"===typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t.get(e,n));return this}}(y,x);class M extends y{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return x.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),x.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=x.copy(t,new x(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new x(t,t);else if(this.#e=new x(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new M(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())t.set(e,n,r);return t}toMatrix(){return new x(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,r]of t.entries())r||e.push(n);e.reverse();for(const n of e)this.removeCross(n);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=++r);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const r=new M(n);for(let i=0,a=0,o=0;o<e;o++)r.set(i,a,t[o]),++i>=n&&(i=++a);return r}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}M.prototype.klassType="SymmetricMatrix";class S extends M{static isDistanceMatrix(t){return M.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new M(this)}clone(){const t=new S(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())e!==n&&t.set(e,n,r);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=1+ ++r);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const r=new this(n);for(let i=1,a=0,o=0;o<e;o++)r.set(i,a,t[o]),++i>=n&&(i=1+ ++a);return r}}S.prototype.klassSubType="DistanceMatrix";class E extends y{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class k extends E{constructor(t,e,n){m(t,e),p(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class C extends y{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rows:n=1}=e;if(t.length%n!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let r=this._calculateIndex(t,e);return this.data[r]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class A extends y{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class P{constructor(t){let e,n,r,i,a,o,s,l,h,c=(t=A.checkMatrix(t)).clone(),u=c.rows,d=c.columns,f=new Float64Array(u),m=1;for(e=0;e<u;e++)f[e]=e;for(l=new Float64Array(u),n=0;n<d;n++){for(e=0;e<u;e++)l[e]=c.get(e,n);for(e=0;e<u;e++){for(h=Math.min(e,n),a=0,r=0;r<h;r++)a+=c.get(e,r)*l[r];l[e]-=a,c.set(e,n,l[e])}for(i=n,e=n+1;e<u;e++)Math.abs(l[e])>Math.abs(l[i])&&(i=e);if(i!==n){for(r=0;r<d;r++)o=c.get(i,r),c.set(i,r,c.get(n,r)),c.set(n,r,o);s=f[i],f[i]=f[n],f[n]=s,m=-m}if(n<u&&0!==c.get(n,n))for(e=n+1;e<u;e++)c.set(e,n,c.get(e,n)/c.get(n,n))}this.LU=c,this.pivotVector=f,this.pivotSign=m}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=x.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,r,i,a=t.columns,o=t.subMatrixRow(this.pivotVector,0,a-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i));for(i=s-1;i>=0;i--){for(r=0;r<a;r++)o.set(i,r,o.get(i,r)/e.get(i,i));for(n=0;n<i;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new x(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i>e?r.set(i,e,t.get(i,e)):i===e?r.set(i,e,1):r.set(i,e,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new x(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i<=e?r.set(i,e,t.get(i,e)):r.set(i,e,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function T(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class D{constructor(t){let e,n,r,i,a=(t=A.checkMatrix(t)).clone(),o=t.rows,s=t.columns,l=new Float64Array(s);for(r=0;r<s;r++){let t=0;for(e=r;e<o;e++)t=T(t,a.get(e,r));if(0!==t){for(a.get(r,r)<0&&(t=-t),e=r;e<o;e++)a.set(e,r,a.get(e,r)/t);for(a.set(r,r,a.get(r,r)+1),n=r+1;n<s;n++){for(i=0,e=r;e<o;e++)i+=a.get(e,r)*a.get(e,n);for(i=-i/a.get(r,r),e=r;e<o;e++)a.set(e,n,a.get(e,n)+i*a.get(e,r))}}l[r]=-t}this.QR=a,this.Rdiag=l}solve(t){t=x.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r,i,a,o,s=t.columns,l=t.clone(),h=e.columns;for(a=0;a<h;a++)for(i=0;i<s;i++){for(o=0,r=a;r<n;r++)o+=e.get(r,a)*l.get(r,i);for(o=-o/e.get(a,a),r=a;r<n;r++)l.set(r,i,l.get(r,i)+o*e.get(r,a))}for(a=h-1;a>=0;a--){for(i=0;i<s;i++)l.set(a,i,l.get(a,i)/this.Rdiag[a]);for(r=0;r<a;r++)for(i=0;i<s;i++)l.set(r,i,l.get(r,i)-l.get(a,i)*e.get(r,a))}return l.subMatrix(0,h-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,r=n.columns,i=new x(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?i.set(t,e,n.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,n,r,i=this.QR,a=i.rows,o=i.columns,s=new x(a,o);for(n=o-1;n>=0;n--){for(t=0;t<a;t++)s.set(t,n,0);for(s.set(n,n,1),e=n;e<o;e++)if(0!==i.get(n,n)){for(r=0,t=n;t<a;t++)r+=i.get(t,n)*s.get(t,e);for(r=-r/i.get(n,n),t=n;t<a;t++)s.set(t,e,s.get(t,e)+r*i.get(t,n))}}return s}}class I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t=A.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:a=!0,autoTranspose:o=!1}=e;let s,l=Boolean(i),h=Boolean(a),c=!1;if(n<r)if(o){s=t.transpose(),n=s.rows,r=s.columns,c=!0;let e=l;l=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let u=Math.min(n,r),d=Math.min(n+1,r),f=new Float64Array(d),m=new x(n,u),p=new x(r,r),g=new Float64Array(r),v=new Float64Array(n),_=new Float64Array(d);for(let x=0;x<d;x++)_[x]=x;let w=Math.min(n-1,r),y=Math.max(0,Math.min(r-2,n)),b=Math.max(w,y);for(let x=0;x<b;x++){if(x<w){f[x]=0;for(let t=x;t<n;t++)f[x]=T(f[x],s.get(t,x));if(0!==f[x]){s.get(x,x)<0&&(f[x]=-f[x]);for(let t=x;t<n;t++)s.set(t,x,s.get(t,x)/f[x]);s.set(x,x,s.get(x,x)+1)}f[x]=-f[x]}for(let t=x+1;t<r;t++){if(x<w&&0!==f[x]){let e=0;for(let r=x;r<n;r++)e+=s.get(r,x)*s.get(r,t);e=-e/s.get(x,x);for(let r=x;r<n;r++)s.set(r,t,s.get(r,t)+e*s.get(r,x))}g[t]=s.get(x,t)}if(l&&x<w)for(let t=x;t<n;t++)m.set(t,x,s.get(t,x));if(x<y){g[x]=0;for(let t=x+1;t<r;t++)g[x]=T(g[x],g[t]);if(0!==g[x]){g[x+1]<0&&(g[x]=0-g[x]);for(let t=x+1;t<r;t++)g[t]/=g[x];g[x+1]+=1}if(g[x]=-g[x],x+1<n&&0!==g[x]){for(let t=x+1;t<n;t++)v[t]=0;for(let t=x+1;t<n;t++)for(let e=x+1;e<r;e++)v[t]+=g[e]*s.get(t,e);for(let t=x+1;t<r;t++){let e=-g[t]/g[x+1];for(let r=x+1;r<n;r++)s.set(r,t,s.get(r,t)+e*v[r])}}if(h)for(let t=x+1;t<r;t++)p.set(t,x,g[t])}}let M=Math.min(r,n+1);if(w<r&&(f[w]=s.get(w,w)),n<M&&(f[M-1]=0),y+1<M&&(g[y]=s.get(y,M-1)),g[M-1]=0,l){for(let t=w;t<u;t++){for(let e=0;e<n;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<u;e++){let r=0;for(let i=t;i<n;i++)r+=m.get(i,t)*m.get(i,e);r=-r/m.get(t,t);for(let i=t;i<n;i++)m.set(i,e,m.get(i,e)+r*m.get(i,t))}for(let e=t;e<n;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<n;e++)m.set(e,t,0);m.set(t,t,1)}}if(h)for(let x=r-1;x>=0;x--){if(x<y&&0!==g[x])for(let t=x+1;t<r;t++){let e=0;for(let n=x+1;n<r;n++)e+=p.get(n,x)*p.get(n,t);e=-e/p.get(x+1,x);for(let n=x+1;n<r;n++)p.set(n,t,p.get(n,t)+e*p.get(n,x))}for(let t=0;t<r;t++)p.set(t,x,0);p.set(x,x,1)}let S=M-1,E=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+E*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(g[t])<=e||Number.isNaN(g[t])){g[t]=0;break}}if(t===M-2)e=4;else{let n;for(n=M-1;n>=t&&n!==t;n--){let e=(n!==M?Math.abs(g[n]):0)+(n!==t+1?Math.abs(g[n-1]):0);if(Math.abs(f[n])<=E*e){f[n]=0;break}}n===t?e=3:n===M-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=g[M-2];g[M-2]=0;for(let n=M-2;n>=t;n--){let i=T(f[n],e),a=f[n]/i,o=e/i;if(f[n]=i,n!==t&&(e=-o*g[n-1],g[n-1]=a*g[n-1]),h)for(let t=0;t<r;t++)i=a*p.get(t,n)+o*p.get(t,M-1),p.set(t,M-1,-o*p.get(t,n)+a*p.get(t,M-1)),p.set(t,n,i)}break}case 2:{let e=g[t-1];g[t-1]=0;for(let r=t;r<M;r++){let i=T(f[r],e),a=f[r]/i,o=e/i;if(f[r]=i,e=-o*g[r],g[r]=a*g[r],l)for(let e=0;e<n;e++)i=a*m.get(e,r)+o*m.get(e,t-1),m.set(e,t-1,-o*m.get(e,r)+a*m.get(e,t-1)),m.set(e,r,i)}break}case 3:{const e=Math.max(Math.abs(f[M-1]),Math.abs(f[M-2]),Math.abs(g[M-2]),Math.abs(f[t]),Math.abs(g[t])),i=f[M-1]/e,a=f[M-2]/e,o=g[M-2]/e,s=f[t]/e,c=g[t]/e,u=((a+i)*(a-i)+o*o)/2,d=i*o*(i*o);let v=0;0===u&&0===d||(v=u<0?0-Math.sqrt(u*u+d):Math.sqrt(u*u+d),v=d/(u+v));let _=(s+i)*(s-i)+v,w=s*c;for(let y=t;y<M-1;y++){let e=T(_,w);0===e&&(e=Number.MIN_VALUE);let i=_/e,a=w/e;if(y!==t&&(g[y-1]=e),_=i*f[y]+a*g[y],g[y]=i*g[y]-a*f[y],w=a*f[y+1],f[y+1]=i*f[y+1],h)for(let t=0;t<r;t++)e=i*p.get(t,y)+a*p.get(t,y+1),p.set(t,y+1,-a*p.get(t,y)+i*p.get(t,y+1)),p.set(t,y,e);if(e=T(_,w),0===e&&(e=Number.MIN_VALUE),i=_/e,a=w/e,f[y]=e,_=i*g[y]+a*f[y+1],f[y+1]=-a*g[y]+i*f[y+1],w=a*g[y+1],g[y+1]=i*g[y+1],l&&y<n-1)for(let t=0;t<n;t++)e=i*m.get(t,y)+a*m.get(t,y+1),m.set(t,y+1,-a*m.get(t,y)+i*m.get(t,y+1)),m.set(t,y,e)}g[M-2]=_;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=S;e++)p.set(e,t,-p.get(e,t));for(;t<S&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<r-1)for(let n=0;n<r;n++)e=p.get(n,t+1),p.set(n,t+1,p.get(n,t)),p.set(n,t,e);if(l&&t<n-1)for(let r=0;r<n;r++)e=m.get(r,t+1),m.set(r,t+1,m.get(r,t)),m.set(r,t,e);t++}M--}}if(c){let t=p;p=m,m=t}this.m=n,this.n=r,this.s=f,this.U=m,this.V=p}solve(t){let e=t,n=this.threshold,r=this.s.length,i=x.zeros(r,r);for(let u=0;u<r;u++)Math.abs(this.s[u])<=n?i.set(u,u,0):i.set(u,u,1/this.s[u]);let a=this.U,o=this.rightSingularVectors,s=o.mmul(i),l=o.rows,h=a.rows,c=x.zeros(l,h);for(let u=0;u<l;u++)for(let t=0;t<h;t++){let e=0;for(let n=0;n<r;n++)e+=s.get(u,n)*a.get(t,n);c.set(u,t,e)}return c.mmul(e)}solveForDiagonal(t){return this.solve(x.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,i=new x(n,this.s.length);for(let h=0;h<n;h++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e&&i.set(h,n,t.get(h,n)/this.s[n]);let a=this.U,o=a.rows,s=a.columns,l=new x(n,o);for(let h=0;h<n;h++)for(let t=0;t<o;t++){let e=0;for(let n=0;n<s;n++)e+=i.get(h,n)*a.get(t,n);l.set(h,t,e)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function N(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=A.checkMatrix(t),e=A.checkMatrix(e),n?new I(t).solve(e):t.isSquare()?new P(t).solve(e):new D(t).solve(e)}function R(t,e){let n=[];for(let r=0;r<t;r++)r!==e&&n.push(r);return n}function L(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-9;if(t>(arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-9))return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<r&&t.set(e,0,0);return t.to1DArray()}}class U{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{assumeSymmetric:n=!1}=e;if(!(t=A.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r,i,a=t.columns,o=new x(a,a),s=new Float64Array(a),l=new Float64Array(a),h=t,c=!1;if(c=!!n||t.isSymmetric(),c){for(r=0;r<a;r++)for(i=0;i<a;i++)o.set(r,i,h.get(r,i));!function(t,e,n,r){let i,a,o,s,l,h,c,u;for(l=0;l<t;l++)n[l]=r.get(t-1,l);for(s=t-1;s>0;s--){for(u=0,o=0,h=0;h<s;h++)u+=Math.abs(n[h]);if(0===u)for(e[s]=n[s-1],l=0;l<s;l++)n[l]=r.get(s-1,l),r.set(s,l,0),r.set(l,s,0);else{for(h=0;h<s;h++)n[h]/=u,o+=n[h]*n[h];for(i=n[s-1],a=Math.sqrt(o),i>0&&(a=-a),e[s]=u*a,o-=i*a,n[s-1]=i-a,l=0;l<s;l++)e[l]=0;for(l=0;l<s;l++){for(i=n[l],r.set(l,s,i),a=e[l]+r.get(l,l)*i,h=l+1;h<=s-1;h++)a+=r.get(h,l)*n[h],e[h]+=r.get(h,l)*i;e[l]=a}for(i=0,l=0;l<s;l++)e[l]/=o,i+=e[l]*n[l];for(c=i/(o+o),l=0;l<s;l++)e[l]-=c*n[l];for(l=0;l<s;l++){for(i=n[l],a=e[l],h=l;h<=s-1;h++)r.set(h,l,r.get(h,l)-(i*e[h]+a*n[h]));n[l]=r.get(s-1,l),r.set(s,l,0)}}n[s]=o}for(s=0;s<t-1;s++){if(r.set(t-1,s,r.get(s,s)),r.set(s,s,1),o=n[s+1],0!==o){for(h=0;h<=s;h++)n[h]=r.get(h,s+1)/o;for(l=0;l<=s;l++){for(a=0,h=0;h<=s;h++)a+=r.get(h,s+1)*r.get(h,l);for(h=0;h<=s;h++)r.set(h,l,r.get(h,l)-a*n[h])}}for(h=0;h<=s;h++)r.set(h,s+1,0)}for(l=0;l<t;l++)n[l]=r.get(t-1,l),r.set(t-1,l,0);r.set(t-1,t-1,1),e[0]=0}(a,l,s,o),function(t,e,n,r){let i,a,o,s,l,h,c,u,d,f,m,p,g,v,_,w;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let y=0,b=0,x=Number.EPSILON;for(h=0;h<t;h++){for(b=Math.max(b,Math.abs(n[h])+Math.abs(e[h])),c=h;c<t&&!(Math.abs(e[c])<=x*b);)c++;if(c>h)do{for(i=n[h],u=(n[h+1]-i)/(2*e[h]),d=T(u,1),u<0&&(d=-d),n[h]=e[h]/(u+d),n[h+1]=e[h]*(u+d),f=n[h+1],a=i-n[h],o=h+2;o<t;o++)n[o]-=a;for(y+=a,u=n[c],m=1,p=m,g=m,v=e[h+1],_=0,w=0,o=c-1;o>=h;o--)for(g=p,p=m,w=_,i=m*e[o],a=m*u,d=T(u,e[o]),e[o+1]=_*d,_=e[o]/d,m=u/d,u=m*n[o]-_*i,n[o+1]=a+_*(m*i+_*n[o]),l=0;l<t;l++)a=r.get(l,o+1),r.set(l,o+1,_*r.get(l,o)+m*a),r.set(l,o,m*r.get(l,o)-_*a);u=-_*w*g*v*e[h]/f,e[h]=_*u,n[h]=m*u}while(Math.abs(e[h])>x*b);n[h]=n[h]+y,e[h]=0}for(o=0;o<t-1;o++){for(l=o,u=n[o],s=o+1;s<t;s++)n[s]<u&&(l=s,u=n[s]);if(l!==o)for(n[l]=n[o],n[o]=u,s=0;s<t;s++)u=r.get(s,o),r.set(s,o,r.get(s,l)),r.set(s,l,u)}}(a,l,s,o)}else{let t=new x(a,a),e=new Float64Array(a);for(i=0;i<a;i++)for(r=0;r<a;r++)t.set(r,i,h.get(r,i));!function(t,e,n,r){let i,a,o,s,l,h,c,u=0,d=t-1;for(h=u+1;h<=d-1;h++){for(c=0,s=h;s<=d;s++)c+=Math.abs(e.get(s,h-1));if(0!==c){for(o=0,s=d;s>=h;s--)n[s]=e.get(s,h-1)/c,o+=n[s]*n[s];for(a=Math.sqrt(o),n[h]>0&&(a=-a),o-=n[h]*a,n[h]=n[h]-a,l=h;l<t;l++){for(i=0,s=d;s>=h;s--)i+=n[s]*e.get(s,l);for(i/=o,s=h;s<=d;s++)e.set(s,l,e.get(s,l)-i*n[s])}for(s=0;s<=d;s++){for(i=0,l=d;l>=h;l--)i+=n[l]*e.get(s,l);for(i/=o,l=h;l<=d;l++)e.set(s,l,e.get(s,l)-i*n[l])}n[h]=c*n[h],e.set(h,h-1,c*a)}}for(s=0;s<t;s++)for(l=0;l<t;l++)r.set(s,l,s===l?1:0);for(h=d-1;h>=u+1;h--)if(0!==e.get(h,h-1)){for(s=h+1;s<=d;s++)n[s]=e.get(s,h-1);for(l=h;l<=d;l++){for(a=0,s=h;s<=d;s++)a+=n[s]*r.get(s,l);for(a=a/n[h]/e.get(h,h-1),s=h;s<=d;s++)r.set(s,l,r.get(s,l)+a*n[s])}}}(a,t,e,o),function(t,e,n,r,i){let a,o,s,l,h,c,u,d,f,m,p,g,v,_,w,y=t-1,b=0,x=t-1,M=Number.EPSILON,S=0,E=0,k=0,C=0,A=0,P=0,T=0,D=0;for(a=0;a<t;a++)for((a<b||a>x)&&(n[a]=i.get(a,a),e[a]=0),o=Math.max(a-1,0);o<t;o++)E+=Math.abs(i.get(a,o));for(;y>=b;){for(l=y;l>b&&(P=Math.abs(i.get(l-1,l-1))+Math.abs(i.get(l,l)),0===P&&(P=E),!(Math.abs(i.get(l,l-1))<M*P));)l--;if(l===y)i.set(y,y,i.get(y,y)+S),n[y]=i.get(y,y),e[y]=0,y--,D=0;else if(l===y-1){if(u=i.get(y,y-1)*i.get(y-1,y),k=(i.get(y-1,y-1)-i.get(y,y))/2,C=k*k+u,T=Math.sqrt(Math.abs(C)),i.set(y,y,i.get(y,y)+S),i.set(y-1,y-1,i.get(y-1,y-1)+S),d=i.get(y,y),C>=0){for(T=k>=0?k+T:k-T,n[y-1]=d+T,n[y]=n[y-1],0!==T&&(n[y]=d-u/T),e[y-1]=0,e[y]=0,d=i.get(y,y-1),P=Math.abs(d)+Math.abs(T),k=d/P,C=T/P,A=Math.sqrt(k*k+C*C),k/=A,C/=A,o=y-1;o<t;o++)T=i.get(y-1,o),i.set(y-1,o,C*T+k*i.get(y,o)),i.set(y,o,C*i.get(y,o)-k*T);for(a=0;a<=y;a++)T=i.get(a,y-1),i.set(a,y-1,C*T+k*i.get(a,y)),i.set(a,y,C*i.get(a,y)-k*T);for(a=b;a<=x;a++)T=r.get(a,y-1),r.set(a,y-1,C*T+k*r.get(a,y)),r.set(a,y,C*r.get(a,y)-k*T)}else n[y-1]=d+k,n[y]=d+k,e[y-1]=T,e[y]=-T;y-=2,D=0}else{if(d=i.get(y,y),f=0,u=0,l<y&&(f=i.get(y-1,y-1),u=i.get(y,y-1)*i.get(y-1,y)),10===D){for(S+=d,a=b;a<=y;a++)i.set(a,a,i.get(a,a)-d);P=Math.abs(i.get(y,y-1))+Math.abs(i.get(y-1,y-2)),d=f=.75*P,u=-.4375*P*P}if(30===D&&(P=(f-d)/2,P=P*P+u,P>0)){for(P=Math.sqrt(P),f<d&&(P=-P),P=d-u/((f-d)/2+P),a=b;a<=y;a++)i.set(a,a,i.get(a,a)-P);S+=P,d=f=u=.964}for(D+=1,h=y-2;h>=l&&(T=i.get(h,h),A=d-T,P=f-T,k=(A*P-u)/i.get(h+1,h)+i.get(h,h+1),C=i.get(h+1,h+1)-T-A-P,A=i.get(h+2,h+1),P=Math.abs(k)+Math.abs(C)+Math.abs(A),k/=P,C/=P,A/=P,h!==l)&&!(Math.abs(i.get(h,h-1))*(Math.abs(C)+Math.abs(A))<M*(Math.abs(k)*(Math.abs(i.get(h-1,h-1))+Math.abs(T)+Math.abs(i.get(h+1,h+1)))));)h--;for(a=h+2;a<=y;a++)i.set(a,a-2,0),a>h+2&&i.set(a,a-3,0);for(s=h;s<=y-1&&(_=s!==y-1,s!==h&&(k=i.get(s,s-1),C=i.get(s+1,s-1),A=_?i.get(s+2,s-1):0,d=Math.abs(k)+Math.abs(C)+Math.abs(A),0!==d&&(k/=d,C/=d,A/=d)),0!==d);s++)if(P=Math.sqrt(k*k+C*C+A*A),k<0&&(P=-P),0!==P){for(s!==h?i.set(s,s-1,-P*d):l!==h&&i.set(s,s-1,-i.get(s,s-1)),k+=P,d=k/P,f=C/P,T=A/P,C/=k,A/=k,o=s;o<t;o++)k=i.get(s,o)+C*i.get(s+1,o),_&&(k+=A*i.get(s+2,o),i.set(s+2,o,i.get(s+2,o)-k*T)),i.set(s,o,i.get(s,o)-k*d),i.set(s+1,o,i.get(s+1,o)-k*f);for(a=0;a<=Math.min(y,s+3);a++)k=d*i.get(a,s)+f*i.get(a,s+1),_&&(k+=T*i.get(a,s+2),i.set(a,s+2,i.get(a,s+2)-k*A)),i.set(a,s,i.get(a,s)-k),i.set(a,s+1,i.get(a,s+1)-k*C);for(a=b;a<=x;a++)k=d*r.get(a,s)+f*r.get(a,s+1),_&&(k+=T*r.get(a,s+2),r.set(a,s+2,r.get(a,s+2)-k*A)),r.set(a,s,r.get(a,s)-k),r.set(a,s+1,r.get(a,s+1)-k*C)}}}if(0===E)return;for(y=t-1;y>=0;y--)if(k=n[y],C=e[y],0===C)for(l=y,i.set(y,y,1),a=y-1;a>=0;a--){for(u=i.get(a,a)-k,A=0,o=l;o<=y;o++)A+=i.get(a,o)*i.get(o,y);if(e[a]<0)T=u,P=A;else if(l=a,0===e[a]?i.set(a,y,0!==u?-A/u:-A/(M*E)):(d=i.get(a,a+1),f=i.get(a+1,a),C=(n[a]-k)*(n[a]-k)+e[a]*e[a],c=(d*P-T*A)/C,i.set(a,y,c),i.set(a+1,y,Math.abs(d)>Math.abs(T)?(-A-u*c)/d:(-P-f*c)/T)),c=Math.abs(i.get(a,y)),M*c*c>1)for(o=a;o<=y;o++)i.set(o,y,i.get(o,y)/c)}else if(C<0)for(l=y-1,Math.abs(i.get(y,y-1))>Math.abs(i.get(y-1,y))?(i.set(y-1,y-1,C/i.get(y,y-1)),i.set(y-1,y,-(i.get(y,y)-k)/i.get(y,y-1))):(w=O(0,-i.get(y-1,y),i.get(y-1,y-1)-k,C),i.set(y-1,y-1,w[0]),i.set(y-1,y,w[1])),i.set(y,y-1,0),i.set(y,y,1),a=y-2;a>=0;a--){for(m=0,p=0,o=l;o<=y;o++)m+=i.get(a,o)*i.get(o,y-1),p+=i.get(a,o)*i.get(o,y);if(u=i.get(a,a)-k,e[a]<0)T=u,A=m,P=p;else if(l=a,0===e[a]?(w=O(-m,-p,u,C),i.set(a,y-1,w[0]),i.set(a,y,w[1])):(d=i.get(a,a+1),f=i.get(a+1,a),g=(n[a]-k)*(n[a]-k)+e[a]*e[a]-C*C,v=2*(n[a]-k)*C,0===g&&0===v&&(g=M*E*(Math.abs(u)+Math.abs(C)+Math.abs(d)+Math.abs(f)+Math.abs(T))),w=O(d*A-T*m+C*p,d*P-T*p-C*m,g,v),i.set(a,y-1,w[0]),i.set(a,y,w[1]),Math.abs(d)>Math.abs(T)+Math.abs(C)?(i.set(a+1,y-1,(-m-u*i.get(a,y-1)+C*i.get(a,y))/d),i.set(a+1,y,(-p-u*i.get(a,y)-C*i.get(a,y-1))/d)):(w=O(-A-f*i.get(a,y-1),-P-f*i.get(a,y),T,C),i.set(a+1,y-1,w[0]),i.set(a+1,y,w[1]))),c=Math.max(Math.abs(i.get(a,y-1)),Math.abs(i.get(a,y))),M*c*c>1)for(o=a;o<=y;o++)i.set(o,y-1,i.get(o,y-1)/c),i.set(o,y,i.get(o,y)/c)}for(a=0;a<t;a++)if(a<b||a>x)for(o=a;o<t;o++)r.set(a,o,i.get(a,o));for(o=t-1;o>=b;o--)for(a=b;a<=x;a++){for(T=0,s=b;s<=Math.min(o,x);s++)T+=r.get(a,s)*i.get(s,o);r.set(a,o,T)}}(a,l,s,o,t)}this.n=a,this.e=l,this.d=s,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,r=this.e,i=this.d,a=new x(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)a.set(t,e,0);a.set(t,t,i[t]),r[t]>0?a.set(t,t+1,r[t]):r[t]<0&&a.set(t,t-1,r[t])}return a}}function O(t,e,n,r){let i,a;return Math.abs(n)>Math.abs(r)?(i=r/n,a=n+i*r,[(t+i*e)/a,(e-i*t)/a]):(i=n/r,a=r+i*n,[(i*t+e)/a,(i*e-t)/a])}class z{constructor(t){if(!(t=A.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,r,i=t,a=i.rows,o=new x(a,a),s=!0;for(n=0;n<a;n++){let t=0;for(r=0;r<n;r++){let a=0;for(e=0;e<r;e++)a+=o.get(r,e)*o.get(n,e);a=(i.get(n,r)-a)/o.get(r,r),o.set(n,r,a),t+=a*a}for(t=i.get(n,n)-t,s&=t>0,o.set(n,n,Math.sqrt(Math.max(t,0))),r=n+1;r<a;r++)o.set(n,r,0)}this.L=o,this.positiveDefinite=Boolean(s)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=A.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let r,i,a,o=t.columns,s=t.clone();for(a=0;a<n;a++)for(i=0;i<o;i++){for(r=0;r<a;r++)s.set(a,i,s.get(a,i)-s.get(r,i)*e.get(a,r));s.set(a,i,s.get(a,i)/e.get(a,a))}for(a=n-1;a>=0;a--)for(i=0;i<o;i++){for(r=a+1;r<n;r++)s.set(a,i,s.get(a,i)-s.get(r,i)*e.get(r,a));s.set(a,i,s.get(a,i)/e.get(a,a))}return s}get lowerTriangularMatrix(){return this.L}}class F{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=A.checkMatrix(t);let{Y:n}=e;const{scaleScores:i=!1,maxIterations:a=1e3,terminationCriteria:o=1e-10}=e;let s;if(n){if(n=r.isAnyArray(n)&&"number"===typeof n[0]?x.columnVector(n):A.checkMatrix(n),n.rows!==t.rows)throw new Error("Y should have the same number of rows as X");s=n.getColumnVector(0)}else s=t.getColumnVector(0);let l,h,c,u,d=1;for(let r=0;r<a&&d>o;r++)c=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),c=c.div(c.norm()),l=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),r>0&&(d=l.clone().sub(u).pow(2).sum()),u=l.clone(),n?(h=n.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),h=h.div(h.norm()),s=n.mmul(h).div(h.transpose().mmul(h).get(0,0))):s=l;if(n){let e=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));e=e.div(e.norm());let r=t.clone().sub(l.clone().mmul(e.transpose())),i=s.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),a=n.clone().sub(l.clone().mulS(i.get(0,0)).mmul(h.transpose()));this.t=l,this.p=e.transpose(),this.w=c.transpose(),this.q=h,this.u=s,this.s=l.transpose().mmul(l),this.xResidual=r,this.yResidual=a,this.betas=i}else this.w=c.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=i?l.clone().div(this.s.get(0,0)):l,this.xResidual=t.sub(l.mmul(c.transpose()))}}e.AbstractMatrix=y,e.CHO=z,e.CholeskyDecomposition=z,e.DistanceMatrix=S,e.EVD=U,e.EigenvalueDecomposition=U,e.LU=P,e.LuDecomposition=P,e.Matrix=x,e.MatrixColumnSelectionView=class extends E{constructor(t,e){p(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class extends E{constructor(t,e){u(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class extends E{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class extends E{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class extends E{constructor(t,e){m(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class extends E{constructor(t,e){c(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=k,e.MatrixSubView=class extends E{constructor(t,e,n,r,i){g(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class extends E{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=F,e.Nipals=F,e.QR=D,e.QrDecomposition=D,e.SVD=I,e.SingularValueDecomposition=I,e.SymmetricMatrix=M,e.WrapperMatrix1D=C,e.WrapperMatrix2D=A,e.correlation=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new x(t);let i=!1;if("object"!==typeof e||x.isMatrix(e)||r.isAnyArray(e)?e=new x(e):(n=e,e=t,i=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:a=!0,scale:o=!0}=n;a&&(t.center("column"),i||e.center("column")),o&&(t.scale("column"),i||e.scale("column"));const s=t.standardDeviation("column",{unbiased:!0}),l=i?s:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e);for(let r=0;r<h.rows;r++)for(let e=0;e<h.columns;e++)h.set(r,e,h.get(r,e)*(1/(s[r]*l[e]))*(1/(t.rows-1)));return h},e.covariance=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new x(t);let i=!1;if("object"!==typeof e||x.isMatrix(e)||r.isAnyArray(e)?e=new x(e):(n=e,e=t,i=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:a=!0}=n;a&&(t=t.center("column"),i||(e=e.center("column")));const o=t.transpose().mmul(e);for(let r=0;r<o.rows;r++)for(let e=0;e<o.columns;e++)o.set(r,e,o.get(r,e)*(1/(t.rows-1)));return o},e.default=x,e.determinant=function t(e){if((e=x.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,r,i,a;if(2===e.columns)return n=e.get(0,0),r=e.get(0,1),i=e.get(1,0),a=e.get(1,1),n*a-r*i;if(3===e.columns){let a,o,s;return a=new k(e,[1,2],[1,2]),o=new k(e,[1,2],[0,2]),s=new k(e,[1,2],[0,1]),n=e.get(0,0),r=e.get(0,1),i=e.get(0,2),n*t(a)-r*t(o)+i*t(s)}return new P(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=A.checkMatrix(t),e?new I(t).inverse():N(t,x.eye(t.rows))},e.linearDependencies=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{thresholdValue:n=1e-9,thresholdError:r=1e-9}=e;let i=(t=x.checkMatrix(t)).rows,a=new x(i,i);for(let o=0;o<i;o++){let e=x.columnVector(t.getRow(o)),s=t.subMatrixRow(R(i,o)).transpose(),l=new I(s).solve(e),h=x.sub(e,s.mmul(l)).abs().max();a.setRow(o,L(h,l,o,n,r))}return a},e.pseudoInverse=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.EPSILON;if((t=x.checkMatrix(t)).isEmpty())return t.transpose();let n=new I(t,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,a=n.diagonal;for(let o=0;o<a.length;o++)Math.abs(a[o])>e?a[o]=1/a[o]:a[o]=0;return i.mmul(x.diag(a).mmul(r.transpose()))},e.solve=N,e.wrap=function(t,e){if(r.isAnyArray(t))return t[0]&&r.isAnyArray(t[0])?new A(t):new C(t,e);throw new Error("the argument is not an array")}},5198:t=>{t.exports=function(t,e){t=t||0;for(var n=new Array(t),r=0;r<t;r++)n[r]=e;return n}},3122:t=>{t.exports=function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1)}},2730:(t,e,n)=>{"use strict";var r=n(5043),i=n(8853);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(t,e){h(t,e),h(t+"Capture",e)}function h(t,e){for(s[t]=e,t=0;t<e.length;t++)o.add(e[t])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(t,e,n,r,i,a,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new p(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new p(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new p(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new p(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new p(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new p(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new p(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new p(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new p(t,5,!1,t.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function w(t,e,n,r){var i=g.hasOwnProperty(e)?g[e]:null;(null!==i?0!==i.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!u.call(m,t)||!u.call(f,t)&&(d.test(t)?m[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(v,_);g[e]=new p(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(v,_);g[e]=new p(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(v,_);g[e]=new p(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new p(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new p(t,1,!1,t.toLowerCase(),null,!0,!0)}));var y=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),x=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function L(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=R&&t[R]||t["@@iterator"])?t:null}var U,O=Object.assign;function z(t){if(void 0===U)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);U=e&&e[1]||""}return"\n"+U+t}var F=!1;function B(t,e){if(!t||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&"string"===typeof h.stack){for(var i=h.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=o&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?z(t):""}function V(t){switch(t.tag){case 5:return z(t.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return t=B(t.type,!1);case 11:return t=B(t.type.render,!1);case 1:return t=B(t.type,!0);default:return""}}function H(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case M:return"Fragment";case x:return"Portal";case E:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case T:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case C:return(t.displayName||"Context")+".Consumer";case k:return(t._context.displayName||"Context")+".Provider";case A:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case D:return null!==(e=t.displayName||null)?e:H(t.type)||"Memo";case I:e=t._payload,t=t._init;try{return H(t(e))}catch(n){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function j(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function X(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function W(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Y(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function q(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function $(t,e){var n=e.checked;return O({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Z(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=j(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function K(t,e){null!=(e=e.checked)&&w(t,"checked",e,!1)}function Q(t,e){K(t,e);var n=j(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,j(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&q(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+j(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return O({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function it(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(et(n)){if(1<n.length)throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:j(n)}}function at(t,e){var n=j(e.value),r=j(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ht,ct,ut=(ct=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ht=ht||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ht.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return ct(t,e)}))}:ct);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mt=["Webkit","ms","Moz","O"];function pt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=pt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(ft).forEach((function(t){mt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var vt=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _t(t,e){if(e){if(vt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62))}}function wt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yt=null;function bt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var xt=null,Mt=null,St=null;function Et(t){if(t=wi(t)){if("function"!==typeof xt)throw Error(a(280));var e=t.stateNode;e&&(e=bi(e),xt(t.stateNode,t.type,e))}}function kt(t){Mt?St?St.push(t):St=[t]:Mt=t}function Ct(){if(Mt){var t=Mt,e=St;if(St=Mt=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function At(t,e){return t(e)}function Pt(){}var Tt=!1;function Dt(t,e,n){if(Tt)return t(e,n);Tt=!0;try{return At(t,e,n)}finally{Tt=!1,(null!==Mt||null!==St)&&(Pt(),Ct())}}function It(t,e){var n=t.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}var Nt=!1;if(c)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Nt=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch(ct){Nt=!1}function Lt(t,e,n,r,i,a,o,s,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(c){this.onError(c)}}var Ut=!1,Ot=null,zt=!1,Ft=null,Bt={onError:function(t){Ut=!0,Ot=t}};function Vt(t,e,n,r,i,a,o,s,l){Ut=!1,Ot=null,Lt.apply(Bt,arguments)}function Ht(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function jt(t){if(Ht(t)!==t)throw Error(a(188))}function Yt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ht(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return jt(i),t;if(o===r)return jt(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t))?Xt(t):null}function Xt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Xt(t);if(null!==e)return e;t=t.sibling}return null}var Wt=i.unstable_scheduleCallback,qt=i.unstable_cancelCallback,$t=i.unstable_shouldYield,Zt=i.unstable_requestPaint,Kt=i.unstable_now,Qt=i.unstable_getCurrentPriorityLevel,Jt=i.unstable_ImmediatePriority,te=i.unstable_UserBlockingPriority,ee=i.unstable_NormalPriority,ne=i.unstable_LowPriority,re=i.unstable_IdlePriority,ie=null,ae=null;var oe=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2;var he=64,ce=4194304;function ue(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ue(s):0!==(a&=o)&&(r=ue(a))}else 0!==(o=n&~i)?r=ue(o):0!==a&&(r=ue(a));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&i)&&((i=r&-r)>=(a=e&-e)||16===i&&0!==(4194240&a)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-oe(e)),r|=t[n],e&=~i;return r}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function me(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function pe(){var t=he;return 0===(4194240&(he<<=1))&&(he=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ve(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function _e(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-oe(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var we=0;function ye(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var be,xe,Me,Se,Ee,ke=!1,Ce=[],Ae=null,Pe=null,Te=null,De=new Map,Ie=new Map,Ne=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Le(t,e){switch(t){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":Pe=null;break;case"mouseover":case"mouseout":Te=null;break;case"pointerover":case"pointerout":De.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ie.delete(e.pointerId)}}function Ue(t,e,n,r,i,a){return null===t||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==e&&(null!==(e=wi(e))&&xe(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function Oe(t){var e=_i(t.target);if(null!==e){var n=Ht(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Gt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Me(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ze(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=$e(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=wi(n))&&xe(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);yt=r,n.target.dispatchEvent(r),yt=null,e.shift()}return!0}function Fe(t,e,n){ze(t)&&n.delete(e)}function Be(){ke=!1,null!==Ae&&ze(Ae)&&(Ae=null),null!==Pe&&ze(Pe)&&(Pe=null),null!==Te&&ze(Te)&&(Te=null),De.forEach(Fe),Ie.forEach(Fe)}function Ve(t,e){t.blockedOn===e&&(t.blockedOn=null,ke||(ke=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Be)))}function He(t){function e(e){return Ve(e,t)}if(0<Ce.length){Ve(Ce[0],t);for(var n=1;n<Ce.length;n++){var r=Ce[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Ae&&Ve(Ae,t),null!==Pe&&Ve(Pe,t),null!==Te&&Ve(Te,t),De.forEach(e),Ie.forEach(e),n=0;n<Ne.length;n++)(r=Ne[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Ne.length&&null===(n=Ne[0]).blockedOn;)Oe(n),null===n.blockedOn&&Ne.shift()}var Ge=y.ReactCurrentBatchConfig,je=!0;function Ye(t,e,n,r){var i=we,a=Ge.transition;Ge.transition=null;try{we=1,We(t,e,n,r)}finally{we=i,Ge.transition=a}}function Xe(t,e,n,r){var i=we,a=Ge.transition;Ge.transition=null;try{we=4,We(t,e,n,r)}finally{we=i,Ge.transition=a}}function We(t,e,n,r){if(je){var i=$e(t,e,n,r);if(null===i)jr(t,e,r,qe,n),Le(t,r);else if(function(t,e,n,r,i){switch(e){case"focusin":return Ae=Ue(Ae,t,e,n,r,i),!0;case"dragenter":return Pe=Ue(Pe,t,e,n,r,i),!0;case"mouseover":return Te=Ue(Te,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return De.set(a,Ue(De.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ie.set(a,Ue(Ie.get(a)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r))r.stopPropagation();else if(Le(t,r),4&e&&-1<Re.indexOf(t)){for(;null!==i;){var a=wi(i);if(null!==a&&be(a),null===(a=$e(t,e,n,r))&&jr(t,e,r,qe,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else jr(t,e,r,null,n)}}var qe=null;function $e(t,e,n,r){if(qe=null,null!==(t=_i(t=bt(r))))if(null===(e=Ht(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qe=t,null}function Ze(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Ke=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,r=n.length,i="value"in Ke?Ke.value:Ke.textContent,a=i.length;for(t=0;t<r&&n[t]===i[t];t++);var o=r-t;for(e=1;e<=o&&n[r-e]===i[a-e];e++);return Je=i.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function an(t){function e(e,n,r,i,a){for(var o in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,sn,ln,hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(hn),un=O({},hn,{view:0,detail:0}),dn=an(un),fn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(on=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=on=0,ln=t),on)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),mn=an(fn),pn=an(O({},fn,{dataTransfer:0})),gn=an(O({},un,{relatedTarget:0})),vn=an(O({},hn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=O({},hn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wn=an(_n),yn=an(O({},hn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Mn[t])&&!!e[t]}function En(){return Sn}var kn=O({},un,{key:function(t){if(t.key){var e=bn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?xn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Cn=an(kn),An=an(O({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=an(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Tn=an(O({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=O({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Dn),Nn=[9,13,27,32],Rn=c&&"CompositionEvent"in window,Ln=null;c&&"documentMode"in document&&(Ln=document.documentMode);var Un=c&&"TextEvent"in window&&!Ln,On=c&&(!Rn||Ln&&8<Ln&&11>=Ln),zn=String.fromCharCode(32),Fn=!1;function Bn(t,e){switch(t){case"keyup":return-1!==Nn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Hn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Gn[t.type]:"textarea"===e}function Yn(t,e,n,r){kt(r),0<(e=Xr(e,"onChange")).length&&(n=new cn("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xn=null,Wn=null;function qn(t){zr(t,0)}function $n(t){if(W(yi(t)))return t}function Zn(t,e){if("change"===t)return e}var Kn=!1;if(c){var Qn;if(c){var Jn="oninput"in document;if(!Jn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Jn="function"===typeof tr.oninput}Qn=Jn}else Qn=!1;Kn=Qn&&(!document.documentMode||9<document.documentMode)}function er(){Xn&&(Xn.detachEvent("onpropertychange",nr),Wn=Xn=null)}function nr(t){if("value"===t.propertyName&&$n(Wn)){var e=[];Yn(e,Wn,t,bt(t)),Dt(qn,e)}}function rr(t,e,n){"focusin"===t?(er(),Wn=n,(Xn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ir(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return $n(Wn)}function ar(t,e){if("click"===t)return $n(e)}function or(t,e){if("input"===t||"change"===t)return $n(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function lr(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!u.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function hr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cr(t,e){var n,r=hr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=hr(r)}}function ur(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?ur(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=q();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=q((t=e.contentWindow).document)}return e}function fr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function mr(t){var e=dr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=cr(n,a);var o=cr(n,r);i&&o&&(1!==t.rangeCount||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,_r=null,wr=!1;function yr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==gr||gr!==q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},_r&&lr(_r,r)||(_r=r,0<(r=Xr(vr,"onSelect")).length&&(e=new cn("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gr)))}function br(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Mr={},Sr={};function Er(t){if(Mr[t])return Mr[t];if(!xr[t])return t;var e,n=xr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Sr)return Mr[t]=n[e];return t}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var kr=Er("animationend"),Cr=Er("animationiteration"),Ar=Er("animationstart"),Pr=Er("transitionend"),Tr=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(t,e){Tr.set(t,e),l(e,[t])}for(var Nr=0;Nr<Dr.length;Nr++){var Rr=Dr[Nr];Ir(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Ir(kr,"onAnimationEnd"),Ir(Cr,"onAnimationIteration"),Ir(Ar,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Pr,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ur=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Or(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,o,s,l,h){if(Vt.apply(this,arguments),Ut){if(!Ut)throw Error(a(198));var c=Ot;Ut=!1,Ot=null,zt||(zt=!0,Ft=c)}}(r,e,void 0,t),t.currentTarget=null}function zr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,h=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break t;Or(i,s,h),a=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,h=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break t;Or(i,s,h),a=l}}}if(zt)throw t=Ft,zt=!1,Ft=null,t}function Fr(t,e){var n=e[pi];void 0===n&&(n=e[pi]=new Set);var r=t+"__bubble";n.has(r)||(Gr(e,t,2,!1),n.add(r))}function Br(t,e,n){var r=0;e&&(r|=4),Gr(n,t,r,e)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Hr(t){if(!t[Vr]){t[Vr]=!0,o.forEach((function(e){"selectionchange"!==e&&(Ur.has(e)||Br(e,!1,t),Br(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Vr]||(e[Vr]=!0,Br("selectionchange",!1,e))}}function Gr(t,e,n,r){switch(Ze(e)){case 1:var i=Ye;break;case 4:i=Xe;break;default:i=We}n=i.bind(null,e,n,t),i=void 0,!Nt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function jr(t,e,n,r,i){var a=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=_i(s)))return;if(5===(l=o.tag)||6===l){r=a=o;continue t}s=s.parentNode}}r=r.return}Dt((function(){var r=a,i=bt(n),o=[];t:{var s=Tr.get(t);if(void 0!==s){var l=cn,h=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Cn;break;case"focusin":h="focus",l=gn;break;case"focusout":h="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case kr:case Cr:case Ar:l=vn;break;case Pr:l=Tn;break;case"scroll":l=dn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var c=0!==(4&e),u=!c&&"scroll"===t,d=c?null!==s?s+"Capture":null:s;c=[];for(var f,m=r;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&(null!=(p=It(m,d))&&c.push(Yr(m,p,f)))),u)break;m=m.return}0<c.length&&(s=new l(s,h,null,n,i),o.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===yt||!(h=n.relatedTarget||n.fromElement)||!_i(h)&&!h[mi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(h=(h=n.relatedTarget||n.toElement)?_i(h):null)&&(h!==(u=Ht(h))||5!==h.tag&&6!==h.tag)&&(h=null)):(l=null,h=r),l!==h)){if(c=mn,p="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==t&&"pointerover"!==t||(c=An,p="onPointerLeave",d="onPointerEnter",m="pointer"),u=null==l?s:yi(l),f=null==h?s:yi(h),(s=new c(p,m+"leave",l,n,i)).target=u,s.relatedTarget=f,p=null,_i(i)===r&&((c=new c(d,m+"enter",h,n,i)).target=f,c.relatedTarget=u,p=c),u=p,l&&h)t:{for(d=h,m=0,f=c=l;f;f=Wr(f))m++;for(f=0,p=d;p;p=Wr(p))f++;for(;0<m-f;)c=Wr(c),m--;for(;0<f-m;)d=Wr(d),f--;for(;m--;){if(c===d||null!==d&&c===d.alternate)break t;c=Wr(c),d=Wr(d)}c=null}else c=null;null!==l&&qr(o,s,l,c,!1),null!==h&&null!==u&&qr(o,u,h,c,!0)}if("select"===(l=(s=r?yi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Zn;else if(jn(s))if(Kn)g=or;else{g=ir;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(t,r))?Yn(o,g,n,i):(v&&v(t,s,r),"focusout"===t&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&tt(s,"number",s.value)),v=r?yi(r):window,t){case"focusin":(jn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,_r=null);break;case"focusout":_r=vr=gr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,yr(o,n,i);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":yr(o,n,i)}var _;if(Rn)t:{switch(t){case"compositionstart":var w="onCompositionStart";break t;case"compositionend":w="onCompositionEnd";break t;case"compositionupdate":w="onCompositionUpdate";break t}w=void 0}else Hn?Bn(t,n)&&(w="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(w="onCompositionStart");w&&(On&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Hn&&(_=tn()):(Qe="value"in(Ke=i)?Ke.value:Ke.textContent,Hn=!0)),0<(v=Xr(r,w)).length&&(w=new yn(w,t,null,n,i),o.push({event:w,listeners:v}),_?w.data=_:null!==(_=Vn(n))&&(w.data=_))),(_=Un?function(t,e){switch(t){case"compositionend":return Vn(e);case"keypress":return 32!==e.which?null:(Fn=!0,zn);case"textInput":return(t=e.data)===zn&&Fn?null:t;default:return null}}(t,n):function(t,e){if(Hn)return"compositionend"===t||!Rn&&Bn(t,e)?(t=tn(),Je=Qe=Ke=null,Hn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return On&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=Xr(r,"onBeforeInput")).length&&(i=new yn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=_))}zr(o,e)}))}function Yr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xr(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=It(t,n))&&r.unshift(Yr(t,a,i)),null!=(a=It(t,e))&&r.push(Yr(t,a,i))),t=t.return}return r}function Wr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function qr(t,e,n,r,i){for(var a=e._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,h=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==h&&(s=h,i?null!=(l=It(n,a))&&o.unshift(Yr(n,l,s)):i||null!=(l=It(n,a))&&o.push(Yr(n,l,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var $r=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Kr(t){return("string"===typeof t?t:""+t).replace($r,"\n").replace(Zr,"")}function Qr(t,e,n){if(e=Kr(e),Kr(t)!==e&&n)throw Error(a(425))}function Jr(){}var ti=null,ei=null;function ni(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(t){return ai.resolve(null).then(t).catch(si)}:ri;function si(t){setTimeout((function(){throw t}))}function li(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return t.removeChild(i),void He(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);He(e)}function hi(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ci(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var ui=Math.random().toString(36).slice(2),di="__reactFiber$"+ui,fi="__reactProps$"+ui,mi="__reactContainer$"+ui,pi="__reactEvents$"+ui,gi="__reactListeners$"+ui,vi="__reactHandles$"+ui;function _i(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mi]||n[di]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ci(t);null!==t;){if(n=t[di])return n;t=ci(t)}return e}n=(t=n).parentNode}return null}function wi(t){return!(t=t[di]||t[mi])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function yi(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function bi(t){return t[fi]||null}var xi=[],Mi=-1;function Si(t){return{current:t}}function Ei(t){0>Mi||(t.current=xi[Mi],xi[Mi]=null,Mi--)}function ki(t,e){Mi++,xi[Mi]=t.current,t.current=e}var Ci={},Ai=Si(Ci),Pi=Si(!1),Ti=Ci;function Di(t,e){var n=t.type.contextTypes;if(!n)return Ci;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ii(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Ni(){Ei(Pi),Ei(Ai)}function Ri(t,e,n){if(Ai.current!==Ci)throw Error(a(168));ki(Ai,e),ki(Pi,n)}function Li(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(a(108,G(t)||"Unknown",i));return O({},n,r)}function Ui(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ci,Ti=Ai.current,ki(Ai,t),ki(Pi,Pi.current),!0}function Oi(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=Li(t,e,Ti),r.__reactInternalMemoizedMergedChildContext=t,Ei(Pi),Ei(Ai),ki(Ai,t)):Ei(Pi),ki(Pi,n)}var zi=null,Fi=!1,Bi=!1;function Vi(t){null===zi?zi=[t]:zi.push(t)}function Hi(){if(!Bi&&null!==zi){Bi=!0;var t=0,e=we;try{var n=zi;for(we=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}zi=null,Fi=!1}catch(i){throw null!==zi&&(zi=zi.slice(t+1)),Wt(Jt,Hi),i}finally{we=e,Bi=!1}}return null}var Gi=[],ji=0,Yi=null,Xi=0,Wi=[],qi=0,$i=null,Zi=1,Ki="";function Qi(t,e){Gi[ji++]=Xi,Gi[ji++]=Yi,Yi=t,Xi=e}function Ji(t,e,n){Wi[qi++]=Zi,Wi[qi++]=Ki,Wi[qi++]=$i,$i=t;var r=Zi;t=Ki;var i=32-oe(r)-1;r&=~(1<<i),n+=1;var a=32-oe(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Zi=1<<32-oe(e)+i|n<<i|r,Ki=a+t}else Zi=1<<a|n<<i|r,Ki=t}function ta(t){null!==t.return&&(Qi(t,1),Ji(t,1,0))}function ea(t){for(;t===Yi;)Yi=Gi[--ji],Gi[ji]=null,Xi=Gi[--ji],Gi[ji]=null;for(;t===$i;)$i=Wi[--qi],Wi[qi]=null,Ki=Wi[--qi],Wi[qi]=null,Zi=Wi[--qi],Wi[qi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(t,e){var n=Dh(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function sa(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,na=t,ra=hi(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,na=t,ra=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==$i?{id:Zi,overflow:Ki}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Dh(18,null,null,0)).stateNode=e,n.return=t,t.child=n,na=t,ra=null,!0);default:return!1}}function la(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ha(t){if(ia){var e=ra;if(e){var n=e;if(!sa(t,e)){if(la(t))throw Error(a(418));e=hi(n.nextSibling);var r=na;e&&sa(t,e)?oa(r,n):(t.flags=-4097&t.flags|2,ia=!1,na=t)}}else{if(la(t))throw Error(a(418));t.flags=-4097&t.flags|2,ia=!1,na=t}}}function ca(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;na=t}function ua(t){if(t!==na)return!1;if(!ia)return ca(t),ia=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!ni(t.type,t.memoizedProps)),e&&(e=ra)){if(la(t))throw da(),Error(a(418));for(;e;)oa(t,e),e=hi(e.nextSibling)}if(ca(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ra=hi(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ra=null}}else ra=na?hi(t.stateNode.nextSibling):null;return!0}function da(){for(var t=ra;t;)t=hi(t.nextSibling)}function fa(){ra=na=null,ia=!1}function ma(t){null===aa?aa=[t]:aa.push(t)}var pa=y.ReactCurrentBatchConfig;function ga(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=r,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=i.refs;null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function va(t,e){throw t=Object.prototype.toString.call(e),Error(a(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _a(t){return(0,t._init)(t._payload)}function wa(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Nh(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Oh(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function h(t,e,n,r){var a=n.type;return a===M?u(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&_a(a)===e.type)?((r=i(e,n.props)).ref=ga(t,e,n),r.return=t,r):((r=Rh(n.type,n.key,n.props,null,t.mode,r)).ref=ga(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=zh(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function u(t,e,n,r,a){return null===e||7!==e.tag?((e=Lh(n,t.mode,r,a)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Oh(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case b:return(n=Rh(e.type,e.key,e.props,null,t.mode,n)).ref=ga(t,null,e),n.return=t,n;case x:return(e=zh(e,t.mode,n)).return=t,e;case I:return d(t,(0,e._init)(e._payload),n)}if(et(e)||L(e))return(e=Lh(e,t.mode,n,null)).return=t,e;va(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?h(t,e,n,r):null;case x:return n.key===i?c(t,e,n,r):null;case I:return f(t,e,(i=n._init)(n._payload),r)}if(et(n)||L(n))return null!==i?null:u(t,e,n,r,null);va(t,n)}return null}function m(t,e,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return h(e,t=t.get(null===r.key?n:r.key)||null,r,i);case x:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i);case I:return m(t,e,n,(0,r._init)(r._payload),i)}if(et(r)||L(r))return u(e,t=t.get(n)||null,r,i,null);va(e,r)}return null}function p(i,a,s,l){for(var h=null,c=null,u=a,p=a=0,g=null;null!==u&&p<s.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var v=f(i,u,s[p],l);if(null===v){null===u&&(u=g);break}t&&u&&null===v.alternate&&e(i,u),a=o(v,a,p),null===c?h=v:c.sibling=v,c=v,u=g}if(p===s.length)return n(i,u),ia&&Qi(i,p),h;if(null===u){for(;p<s.length;p++)null!==(u=d(i,s[p],l))&&(a=o(u,a,p),null===c?h=u:c.sibling=u,c=u);return ia&&Qi(i,p),h}for(u=r(i,u);p<s.length;p++)null!==(g=m(u,i,p,s[p],l))&&(t&&null!==g.alternate&&u.delete(null===g.key?p:g.key),a=o(g,a,p),null===c?h=g:c.sibling=g,c=g);return t&&u.forEach((function(t){return e(i,t)})),ia&&Qi(i,p),h}function g(i,s,l,h){var c=L(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var u=c=null,p=s,g=s=0,v=null,_=l.next();null!==p&&!_.done;g++,_=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var w=f(i,p,_.value,h);if(null===w){null===p&&(p=v);break}t&&p&&null===w.alternate&&e(i,p),s=o(w,s,g),null===u?c=w:u.sibling=w,u=w,p=v}if(_.done)return n(i,p),ia&&Qi(i,g),c;if(null===p){for(;!_.done;g++,_=l.next())null!==(_=d(i,_.value,h))&&(s=o(_,s,g),null===u?c=_:u.sibling=_,u=_);return ia&&Qi(i,g),c}for(p=r(i,p);!_.done;g++,_=l.next())null!==(_=m(p,i,g,_.value,h))&&(t&&null!==_.alternate&&p.delete(null===_.key?g:_.key),s=o(_,s,g),null===u?c=_:u.sibling=_,u=_);return t&&p.forEach((function(t){return e(i,t)})),ia&&Qi(i,g),c}return function t(r,a,o,l){if("object"===typeof o&&null!==o&&o.type===M&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:t:{for(var h=o.key,c=a;null!==c;){if(c.key===h){if((h=o.type)===M){if(7===c.tag){n(r,c.sibling),(a=i(c,o.props.children)).return=r,r=a;break t}}else if(c.elementType===h||"object"===typeof h&&null!==h&&h.$$typeof===I&&_a(h)===c.type){n(r,c.sibling),(a=i(c,o.props)).ref=ga(r,c,o),a.return=r,r=a;break t}n(r,c);break}e(r,c),c=c.sibling}o.type===M?((a=Lh(o.props.children,r.mode,l,o.key)).return=r,r=a):((l=Rh(o.type,o.key,o.props,null,r.mode,l)).ref=ga(r,a,o),l.return=r,r=l)}return s(r);case x:t:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break t}n(r,a);break}e(r,a),a=a.sibling}(a=zh(o,r.mode,l)).return=r,r=a}return s(r);case I:return t(r,a,(c=o._init)(o._payload),l)}if(et(o))return p(r,a,o,l);if(L(o))return g(r,a,o,l);va(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Oh(o,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var ya=wa(!0),ba=wa(!1),xa=Si(null),Ma=null,Sa=null,Ea=null;function ka(){Ea=Sa=Ma=null}function Ca(t){var e=xa.current;Ei(xa),t._currentValue=e}function Aa(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Pa(t,e){Ma=t,Ea=Sa=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ws=!0),t.firstContext=null)}function Ta(t){var e=t._currentValue;if(Ea!==t)if(t={context:t,memoizedValue:e,next:null},null===Sa){if(null===Ma)throw Error(a(308));Sa=t,Ma.dependencies={lanes:0,firstContext:t}}else Sa=Sa.next=t;return e}var Da=null;function Ia(t){null===Da?Da=[t]:Da.push(t)}function Na(t,e,n,r){var i=e.interleaved;return null===i?(n.next=n,Ia(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ra(t,r)}function Ra(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var La=!1;function Ua(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function za(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fa(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Al)){var i=r.pending;return null===i?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ra(t,n)}return null===(i=r.interleaved)?(e.next=e,Ia(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ra(t,n)}function Ba(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,_e(t,n)}}function Va(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=e:a=a.next=e}else i=a=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ha(t,e,n,r){var i=t.updateQueue;La=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,h=l.next;l.next=null,null===o?a=h:o.next=h,o=l;var c=t.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=h:s.next=h,c.lastBaseUpdate=l))}if(null!==a){var u=i.baseState;for(o=0,c=h=l=null,s=a;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var m=t,p=s;switch(d=e,f=n,p.tag){case 1:if("function"===typeof(m=p.payload)){u=m.call(f,u,d);break t}u=m;break t;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=p.payload)?m.call(f,u,d):m)||void 0===d)break t;u=O({},u,d);break t;case 2:La=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(h=c=f,l=u):c=c.next=f,o|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(l=u),i.baseState=l,i.firstBaseUpdate=h,i.lastBaseUpdate=c,null!==(e=i.shared.interleaved)){i=e;do{o|=i.lane,i=i.next}while(i!==e)}else null===a&&(i.shared.lanes=0);Ul|=o,t.lanes=o,t.memoizedState=u}}function Ga(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var ja={},Ya=Si(ja),Xa=Si(ja),Wa=Si(ja);function qa(t){if(t===ja)throw Error(a(174));return t}function $a(t,e){switch(ki(Wa,e),ki(Xa,t),ki(Ya,ja),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ei(Ya),ki(Ya,e)}function Za(){Ei(Ya),Ei(Xa),Ei(Wa)}function Ka(t){qa(Wa.current);var e=qa(Ya.current),n=lt(e,t.type);e!==n&&(ki(Xa,t),ki(Ya,n))}function Qa(t){Xa.current===t&&(Ei(Ya),Ei(Xa))}var Ja=Si(0);function to(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eo=[];function no(){for(var t=0;t<eo.length;t++)eo[t]._workInProgressVersionPrimary=null;eo.length=0}var ro=y.ReactCurrentDispatcher,io=y.ReactCurrentBatchConfig,ao=0,oo=null,so=null,lo=null,ho=!1,co=!1,uo=0,fo=0;function mo(){throw Error(a(321))}function po(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function go(t,e,n,r,i,o){if(ao=o,oo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ro.current=null===t||null===t.memoizedState?Jo:ts,t=n(r,i),co){o=0;do{if(co=!1,uo=0,25<=o)throw Error(a(301));o+=1,lo=so=null,e.updateQueue=null,ro.current=es,t=n(r,i)}while(co)}if(ro.current=Qo,e=null!==so&&null!==so.next,ao=0,lo=so=oo=null,ho=!1,e)throw Error(a(300));return t}function vo(){var t=0!==uo;return uo=0,t}function _o(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=t:lo=lo.next=t,lo}function wo(){if(null===so){var t=oo.alternate;t=null!==t?t.memoizedState:null}else t=so.next;var e=null===lo?oo.memoizedState:lo.next;if(null!==e)lo=e,so=t;else{if(null===t)throw Error(a(310));t={memoizedState:(so=t).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=t:lo=lo.next=t}return lo}function yo(t,e){return"function"===typeof e?e(t):e}function bo(t){var e=wo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=so,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=s=null,h=null,c=o;do{var u=c.lane;if((ao&u)===u)null!==h&&(h=h.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===h?(l=h=d,s=r):h=h.next=d,oo.lanes|=u,Ul|=u}c=c.next}while(null!==c&&c!==o);null===h?s=r:h.next=l,sr(r,e.memoizedState)||(ws=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=h,n.lastRenderedState=r}if(null!==(t=n.interleaved)){i=t;do{o=i.lane,oo.lanes|=o,Ul|=o,i=i.next}while(i!==t)}else null===i&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xo(t){var e=wo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);sr(o,e.memoizedState)||(ws=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Mo(){}function So(t,e){var n=oo,r=wo(),i=e(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,ws=!0),r=r.queue,Uo(Co.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Do(9,ko.bind(null,n,r,i,e),void 0,null),null===Pl)throw Error(a(349));0!==(30&ao)||Eo(n,e,i)}return i}function Eo(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function ko(t,e,n,r){e.value=n,e.getSnapshot=r,Ao(e)&&Po(t)}function Co(t,e,n){return n((function(){Ao(e)&&Po(t)}))}function Ao(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function Po(t){var e=Ra(t,1);null!==e&&nh(e,t,1,-1)}function To(t){var e=_o();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:t},e.queue=t,t=t.dispatch=qo.bind(null,oo,t),[e.memoizedState,t]}function Do(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Io(){return wo().memoizedState}function No(t,e,n,r){var i=_o();oo.flags|=t,i.memoizedState=Do(1|e,n,void 0,void 0===r?null:r)}function Ro(t,e,n,r){var i=wo();r=void 0===r?null:r;var a=void 0;if(null!==so){var o=so.memoizedState;if(a=o.destroy,null!==r&&po(r,o.deps))return void(i.memoizedState=Do(e,n,a,r))}oo.flags|=t,i.memoizedState=Do(1|e,n,a,r)}function Lo(t,e){return No(8390656,8,t,e)}function Uo(t,e){return Ro(2048,8,t,e)}function Oo(t,e){return Ro(4,2,t,e)}function zo(t,e){return Ro(4,4,t,e)}function Fo(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Bo(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ro(4,4,Fo.bind(null,e,t),n)}function Vo(){}function Ho(t,e){var n=wo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&po(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Go(t,e){var n=wo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&po(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function jo(t,e,n){return 0===(21&ao)?(t.baseState&&(t.baseState=!1,ws=!0),t.memoizedState=n):(sr(n,e)||(n=pe(),oo.lanes|=n,Ul|=n,t.baseState=!0),e)}function Yo(t,e){var n=we;we=0!==n&&4>n?n:4,t(!0);var r=io.transition;io.transition={};try{t(!1),e()}finally{we=n,io.transition=r}}function Xo(){return wo().memoizedState}function Wo(t,e,n){var r=eh(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$o(t))Zo(e,n);else if(null!==(n=Na(t,e,n,r))){nh(n,t,r,th()),Ko(n,e,r)}}function qo(t,e,n){var r=eh(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(t))Zo(e,i);else{var a=t.alternate;if(0===t.lanes&&(null===a||0===a.lanes)&&null!==(a=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var l=e.interleaved;return null===l?(i.next=i,Ia(e)):(i.next=l.next,l.next=i),void(e.interleaved=i)}}catch(h){}null!==(n=Na(t,e,i,r))&&(nh(n,t,r,i=th()),Ko(n,e,r))}}function $o(t){var e=t.alternate;return t===oo||null!==e&&e===oo}function Zo(t,e){co=ho=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ko(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,_e(t,n)}}var Qo={readContext:Ta,useCallback:mo,useContext:mo,useEffect:mo,useImperativeHandle:mo,useInsertionEffect:mo,useLayoutEffect:mo,useMemo:mo,useReducer:mo,useRef:mo,useState:mo,useDebugValue:mo,useDeferredValue:mo,useTransition:mo,useMutableSource:mo,useSyncExternalStore:mo,useId:mo,unstable_isNewReconciler:!1},Jo={readContext:Ta,useCallback:function(t,e){return _o().memoizedState=[t,void 0===e?null:e],t},useContext:Ta,useEffect:Lo,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,No(4194308,4,Fo.bind(null,e,t),n)},useLayoutEffect:function(t,e){return No(4194308,4,t,e)},useInsertionEffect:function(t,e){return No(4,2,t,e)},useMemo:function(t,e){var n=_o();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_o();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Wo.bind(null,oo,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},_o().memoizedState=t},useState:To,useDebugValue:Vo,useDeferredValue:function(t){return _o().memoizedState=t},useTransition:function(){var t=To(!1),e=t[0];return t=Yo.bind(null,t[1]),_o().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=oo,i=_o();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=e(),null===Pl)throw Error(a(349));0!==(30&ao)||Eo(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Lo(Co.bind(null,r,o,t),[t]),r.flags|=2048,Do(9,ko.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=_o(),e=Pl.identifierPrefix;if(ia){var n=Ki;e=":"+e+"R"+(n=(Zi&~(1<<32-oe(Zi)-1)).toString(32)+n),0<(n=uo++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=fo++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ts={readContext:Ta,useCallback:Ho,useContext:Ta,useEffect:Uo,useImperativeHandle:Bo,useInsertionEffect:Oo,useLayoutEffect:zo,useMemo:Go,useReducer:bo,useRef:Io,useState:function(){return bo(yo)},useDebugValue:Vo,useDeferredValue:function(t){return jo(wo(),so.memoizedState,t)},useTransition:function(){return[bo(yo)[0],wo().memoizedState]},useMutableSource:Mo,useSyncExternalStore:So,useId:Xo,unstable_isNewReconciler:!1},es={readContext:Ta,useCallback:Ho,useContext:Ta,useEffect:Uo,useImperativeHandle:Bo,useInsertionEffect:Oo,useLayoutEffect:zo,useMemo:Go,useReducer:xo,useRef:Io,useState:function(){return xo(yo)},useDebugValue:Vo,useDeferredValue:function(t){var e=wo();return null===so?e.memoizedState=t:jo(e,so.memoizedState,t)},useTransition:function(){return[xo(yo)[0],wo().memoizedState]},useMutableSource:Mo,useSyncExternalStore:So,useId:Xo,unstable_isNewReconciler:!1};function ns(t,e){if(t&&t.defaultProps){for(var n in e=O({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function rs(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:O({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var is={isMounted:function(t){return!!(t=t._reactInternals)&&Ht(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=th(),i=eh(t),a=za(r,i);a.payload=e,void 0!==n&&null!==n&&(a.callback=n),null!==(e=Fa(t,a,i))&&(nh(e,t,i,r),Ba(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=th(),i=eh(t),a=za(r,i);a.tag=1,a.payload=e,void 0!==n&&null!==n&&(a.callback=n),null!==(e=Fa(t,a,i))&&(nh(e,t,i,r),Ba(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=th(),r=eh(t),i=za(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),null!==(e=Fa(t,i,r))&&(nh(e,t,r,n),Ba(e,t,r))}};function as(t,e,n,r,i,a,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,a,o):!e.prototype||!e.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function os(t,e,n){var r=!1,i=Ci,a=e.contextType;return"object"===typeof a&&null!==a?a=Ta(a):(i=Ii(e)?Ti:Ai.current,a=(r=null!==(r=e.contextTypes)&&void 0!==r)?Di(t,i):Ci),e=new e(n,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=is,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function ss(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&is.enqueueReplaceState(e,e.state,null)}function ls(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Ua(t);var a=e.contextType;"object"===typeof a&&null!==a?i.context=Ta(a):(a=Ii(e)?Ti:Ai.current,i.context=Di(t,a)),i.state=t.memoizedState,"function"===typeof(a=e.getDerivedStateFromProps)&&(rs(t,e,a,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&is.enqueueReplaceState(i,i.state,null),Ha(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308)}function hs(t,e){try{var n="",r=e;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:t,source:e,stack:i,digest:null}}function cs(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function us(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(t,e,n){(n=za(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){jl||(jl=!0,Yl=r),us(0,e)},n}function ms(t,e,n){(n=za(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){us(0,e)}}var a=t.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){us(0,e),"function"!==typeof r&&(null===Xl?Xl=new Set([this]):Xl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ps(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new ds;var i=new Set;r.set(e,i)}else void 0===(i=r.get(e))&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Eh.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function vs(t,e,n,r,i){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=za(-1,1)).tag=2,Fa(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var _s=y.ReactCurrentOwner,ws=!1;function ys(t,e,n,r){e.child=null===t?ba(e,null,n,r):ya(e,t.child,n,r)}function bs(t,e,n,r,i){n=n.render;var a=e.ref;return Pa(e,i),r=go(t,e,n,r,a,i),n=vo(),null===t||ws?(ia&&n&&ta(e),e.flags|=1,ys(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,js(t,e,i))}function xs(t,e,n,r,i){if(null===t){var a=n.type;return"function"!==typeof a||Ih(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Rh(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Ms(t,e,a,r,i))}if(a=t.child,0===(t.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&t.ref===e.ref)return js(t,e,i)}return e.flags|=1,(t=Nh(a,r)).ref=e.ref,t.return=e,e.child=t}function Ms(t,e,n,r,i){if(null!==t){var a=t.memoizedProps;if(lr(a,r)&&t.ref===e.ref){if(ws=!1,e.pendingProps=r=a,0===(t.lanes&i))return e.lanes=t.lanes,js(t,e,i);0!==(131072&t.flags)&&(ws=!0)}}return ks(t,e,n,r,i)}function Ss(t,e,n){var r=e.pendingProps,i=r.children,a=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(Nl,Il),Il|=n;else{if(0===(1073741824&n))return t=null!==a?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ki(Nl,Il),Il|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,ki(Nl,Il),Il|=r}else null!==a?(r=a.baseLanes|n,e.memoizedState=null):r=n,ki(Nl,Il),Il|=r;return ys(t,e,i,n),e.child}function Es(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ks(t,e,n,r,i){var a=Ii(n)?Ti:Ai.current;return a=Di(e,a),Pa(e,i),n=go(t,e,n,r,a,i),r=vo(),null===t||ws?(ia&&r&&ta(e),e.flags|=1,ys(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,js(t,e,i))}function Cs(t,e,n,r,i){if(Ii(n)){var a=!0;Ui(e)}else a=!1;if(Pa(e,i),null===e.stateNode)Gs(t,e),os(e,n,r),ls(e,n,r,i),r=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,h=n.contextType;"object"===typeof h&&null!==h?h=Ta(h):h=Di(e,h=Ii(n)?Ti:Ai.current);var c=n.getDerivedStateFromProps,u="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==h)&&ss(e,o,r,h),La=!1;var d=e.memoizedState;o.state=d,Ha(e,r,o,i),l=e.memoizedState,s!==r||d!==l||Pi.current||La?("function"===typeof c&&(rs(e,n,c,r),l=e.memoizedState),(s=La||as(e,n,s,r,d,l,h))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=h,r=s):("function"===typeof o.componentDidMount&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Oa(t,e),s=e.memoizedProps,h=e.type===e.elementType?s:ns(e.type,s),o.props=h,u=e.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ta(l):l=Di(e,l=Ii(n)?Ti:Ai.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==u||d!==l)&&ss(e,o,r,l),La=!1,d=e.memoizedState,o.state=d,Ha(e,r,o,i);var m=e.memoizedState;s!==u||d!==m||Pi.current||La?("function"===typeof f&&(rs(e,n,f,r),m=e.memoizedState),(h=La||as(e,n,h,r,d,m,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,m,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=h):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return As(t,e,n,r,a,i)}function As(t,e,n,r,i,a){Es(t,e);var o=0!==(128&e.flags);if(!r&&!o)return i&&Oi(e,n,!1),js(t,e,a);r=e.stateNode,_s.current=e;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&o?(e.child=ya(e,t.child,null,a),e.child=ya(e,null,s,a)):ys(t,e,s,a),e.memoizedState=r.state,i&&Oi(e,n,!0),e.child}function Ps(t){var e=t.stateNode;e.pendingContext?Ri(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ri(0,e.context,!1),$a(t,e.containerInfo)}function Ts(t,e,n,r,i){return fa(),ma(i),e.flags|=256,ys(t,e,n,r),e.child}var Ds,Is,Ns,Rs,Ls={dehydrated:null,treeContext:null,retryLane:0};function Us(t){return{baseLanes:t,cachePool:null,transitions:null}}function Os(t,e,n){var r,i=e.pendingProps,o=Ja.current,s=!1,l=0!==(128&e.flags);if((r=l)||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),ki(Ja,1&o),null===t)return ha(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=i.children,t=i.fallback,s?(i=e.mode,s=e.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Uh(l,i,0,null),t=Lh(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Us(n),e.memoizedState=Ls,t):zs(e,l));if(null!==(o=t.memoizedState)&&null!==(r=o.dehydrated))return function(t,e,n,r,i,o,s){if(n)return 256&e.flags?(e.flags&=-257,Fs(t,e,s,r=cs(Error(a(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Uh({mode:"visible",children:r.children},i,0,null),(o=Lh(o,i,s,null)).flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,0!==(1&e.mode)&&ya(e,t.child,null,s),e.child.memoizedState=Us(s),e.memoizedState=Ls,o);if(0===(1&e.mode))return Fs(t,e,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Fs(t,e,s,r=cs(o=Error(a(419)),r,void 0))}if(l=0!==(s&t.childLanes),ws||l){if(null!==(r=Pl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ra(t,i),nh(r,t,i,-1))}return ph(),Fs(t,e,s,r=cs(Error(a(421))))}return"$?"===i.data?(e.flags|=128,e.child=t.child,e=Ch.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,ra=hi(i.nextSibling),na=e,ia=!0,aa=null,null!==t&&(Wi[qi++]=Zi,Wi[qi++]=Ki,Wi[qi++]=$i,Zi=t.id,Ki=t.overflow,$i=e),e=zs(e,r.children),e.flags|=4096,e)}(t,e,l,i,r,o,n);if(s){s=i.fallback,l=e.mode,r=(o=t.child).sibling;var h={mode:"hidden",children:i.children};return 0===(1&l)&&e.child!==o?((i=e.child).childLanes=0,i.pendingProps=h,e.deletions=null):(i=Nh(o,h)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Nh(r,s):(s=Lh(s,l,n,null)).flags|=2,s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,l=null===(l=t.child.memoizedState)?Us(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Ls,i}return t=(s=t.child).sibling,i=Nh(s,{mode:"visible",children:i.children}),0===(1&e.mode)&&(i.lanes=n),i.return=e,i.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function zs(t,e){return(e=Uh({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Fs(t,e,n,r){return null!==r&&ma(r),ya(e,t.child,null,n),(t=zs(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Bs(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),Aa(t.return,e,n)}function Vs(t,e,n,r,i){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Hs(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(ys(t,e,r.children,n),0!==(2&(r=Ja.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Bs(t,n,e);else if(19===t.tag)Bs(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ki(Ja,r),0===(1&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===to(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Vs(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===to(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Vs(e,!0,n,null,a);break;case"together":Vs(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gs(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function js(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ul|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=Nh(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Nh(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ys(t,e){if(!ia)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=t,i=i.sibling;else for(i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Ws(t,e,n){var r=e.pendingProps;switch(ea(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(e),null;case 1:case 17:return Ii(e.type)&&Ni(),Xs(e),null;case 3:return r=e.stateNode,Za(),Ei(Pi),Ei(Ai),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(ua(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==aa&&(oh(aa),aa=null))),Is(t,e),Xs(e),null;case 5:Qa(e);var i=qa(Wa.current);if(n=e.type,null!==t&&null!=e.stateNode)Ns(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(a(166));return Xs(e),null}if(t=qa(Ya.current),ua(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[di]=e,r[fi]=o,t=0!==(1&e.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Fr(Lr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":Z(r,o),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Fr("invalid",r);break;case"textarea":it(r,o),Fr("invalid",r)}for(var l in _t(n,o),i=null,o)if(o.hasOwnProperty(l)){var h=o[l];"children"===l?"string"===typeof h?r.textContent!==h&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,h,t),i=["children",h]):"number"===typeof h&&r.textContent!==""+h&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,h,t),i=["children",""+h]):s.hasOwnProperty(l)&&null!=h&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":X(r),J(r,o,!0);break;case"textarea":X(r),ot(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=i,e.updateQueue=r,null!==r&&(e.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),"select"===n&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[di]=e,t[fi]=r,Ds(t,e,!1,!1),e.stateNode=t;t:{switch(l=wt(n,r),n){case"dialog":Fr("cancel",t),Fr("close",t),i=r;break;case"iframe":case"object":case"embed":Fr("load",t),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Fr(Lr[i],t);i=r;break;case"source":Fr("error",t),i=r;break;case"img":case"image":case"link":Fr("error",t),Fr("load",t),i=r;break;case"details":Fr("toggle",t),i=r;break;case"input":Z(t,r),i=$(t,r),Fr("invalid",t);break;case"option":default:i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=O({},r,{value:void 0}),Fr("invalid",t);break;case"textarea":it(t,r),i=rt(t,r),Fr("invalid",t)}for(o in _t(n,i),h=i)if(h.hasOwnProperty(o)){var c=h[o];"style"===o?gt(t,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&ut(t,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&dt(t,c):"number"===typeof c&&dt(t,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Fr("scroll",t):null!=c&&w(t,o,c,l))}switch(n){case"input":X(t),J(t,r,!1);break;case"textarea":X(t),ot(t);break;case"option":null!=r.value&&t.setAttribute("value",""+j(r.value));break;case"select":t.multiple=!!r.multiple,null!=(o=r.value)?nt(t,!!r.multiple,o,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(t.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Xs(e),null;case 6:if(t&&null!=e.stateNode)Rs(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(a(166));if(n=qa(Wa.current),qa(Ya.current),ua(e)){if(r=e.stateNode,n=e.memoizedProps,r[di]=e,(o=r.nodeValue!==n)&&null!==(t=na))switch(t.tag){case 3:Qr(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&t.mode))}o&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=e,e.stateNode=r}return Xs(e),null;case 13:if(Ei(Ja),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&e.mode)&&0===(128&e.flags))da(),fa(),e.flags|=98560,o=!1;else if(o=ua(e),null!==r&&null!==r.dehydrated){if(null===t){if(!o)throw Error(a(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(a(317));o[di]=e}else fa(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Xs(e),o=!1}else null!==aa&&(oh(aa),aa=null),o=!0;if(!o)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&Ja.current)?0===Rl&&(Rl=3):ph())),null!==e.updateQueue&&(e.flags|=4),Xs(e),null);case 4:return Za(),Is(t,e),null===t&&Hr(e.stateNode.containerInfo),Xs(e),null;case 10:return Ca(e.type._context),Xs(e),null;case 19:if(Ei(Ja),null===(o=e.memoizedState))return Xs(e),null;if(r=0!==(128&e.flags),null===(l=o.rendering))if(r)Ys(o,!1);else{if(0!==Rl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=to(t))){for(e.flags|=128,Ys(o,!1),null!==(r=l.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,t=l.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ki(Ja,1&Ja.current|2),e.child}t=t.sibling}null!==o.tail&&Kt()>Hl&&(e.flags|=128,r=!0,Ys(o,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=to(l))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Ys(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ia)return Xs(e),null}else 2*Kt()-o.renderingStartTime>Hl&&1073741824!==n&&(e.flags|=128,r=!0,Ys(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=o.last)?n.sibling=l:e.child=l,o.last=l)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Kt(),e.sibling=null,n=Ja.current,ki(Ja,r?1&n|2:1&n),e):(Xs(e),null);case 22:case 23:return uh(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Il)&&(Xs(e),6&e.subtreeFlags&&(e.flags|=8192)):Xs(e),null;case 24:case 25:return null}throw Error(a(156,e.tag))}function qs(t,e){switch(ea(e),e.tag){case 1:return Ii(e.type)&&Ni(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Za(),Ei(Pi),Ei(Ai),no(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Qa(e),null;case 13:if(Ei(Ja),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(a(340));fa()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ei(Ja),null;case 4:return Za(),null;case 10:return Ca(e.type._context),null;case 22:case 23:return uh(),null;default:return null}}Ds=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(){},Ns=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,qa(Ya.current);var a,o=null;switch(n){case"input":i=$(t,i),r=$(t,r),o=[];break;case"select":i=O({},i,{value:void 0}),r=O({},r,{value:void 0}),o=[];break;case"textarea":i=rt(t,i),r=rt(t,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(t.onclick=Jr)}for(c in _t(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var h=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&h!==l&&(null!=h||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&l[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(o||(o=[]),o.push(c,n)),n=h;else"dangerouslySetInnerHTML"===c?(h=h?h.__html:void 0,l=l?l.__html:void 0,null!=h&&l!==h&&(o=o||[]).push(c,h)):"children"===c?"string"!==typeof h&&"number"!==typeof h||(o=o||[]).push(c,""+h):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=h&&"onScroll"===c&&Fr("scroll",t),o||l===h||(o=[])):(o=o||[]).push(c,h))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}},Rs=function(t,e,n,r){n!==r&&(e.flags|=4)};var $s=!1,Zs=!1,Ks="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Js(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sh(t,e,r)}else n.current=null}function tl(t,e,n){try{n()}catch(r){Sh(t,e,r)}}var el=!1;function nl(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,void 0!==a&&tl(e,n,a)}i=i.next}while(i!==r)}}function rl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function il(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function al(t){var e=t.alternate;null!==e&&(t.alternate=null,al(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[di],delete e[fi],delete e[pi],delete e[gi],delete e[vi])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ol(t){return 5===t.tag||3===t.tag||4===t.tag}function sl(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||ol(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Jr));else if(4!==r&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function hl(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(hl(t,e,n),t=t.sibling;null!==t;)hl(t,e,n),t=t.sibling}var cl=null,ul=!1;function dl(t,e,n){for(n=n.child;null!==n;)fl(t,e,n),n=n.sibling}function fl(t,e,n){if(ae&&"function"===typeof ae.onCommitFiberUnmount)try{ae.onCommitFiberUnmount(ie,n)}catch(s){}switch(n.tag){case 5:Zs||Js(n,e);case 6:var r=cl,i=ul;cl=null,dl(t,e,n),ul=i,null!==(cl=r)&&(ul?(t=cl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(ul?(t=cl,n=n.stateNode,8===t.nodeType?li(t.parentNode,n):1===t.nodeType&&li(t,n),He(t)):li(cl,n.stateNode));break;case 4:r=cl,i=ul,cl=n.stateNode.containerInfo,ul=!0,dl(t,e,n),cl=r,ul=i;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&tl(n,e,o),i=i.next}while(i!==r)}dl(t,e,n);break;case 1:if(!Zs&&(Js(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sh(n,e,s)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,dl(t,e,n),Zs=r):dl(t,e,n);break;default:dl(t,e,n)}}function ml(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ks),e.forEach((function(e){var r=Ah.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function pl(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break t;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break t}l=l.return}if(null===cl)throw Error(a(160));fl(o,s,i),cl=null,ul=!1;var h=i.alternate;null!==h&&(h.return=null),i.return=null}catch(c){Sh(i,e,c)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pl(e,t),vl(t),4&r){try{nl(3,t,t.return),rl(3,t)}catch(g){Sh(t,t.return,g)}try{nl(5,t,t.return)}catch(g){Sh(t,t.return,g)}}break;case 1:pl(e,t),vl(t),512&r&&null!==n&&Js(n,n.return);break;case 5:if(pl(e,t),vl(t),512&r&&null!==n&&Js(n,n.return),32&t.flags){var i=t.stateNode;try{dt(i,"")}catch(g){Sh(t,t.return,g)}}if(4&r&&null!=(i=t.stateNode)){var o=t.memoizedProps,s=null!==n?n.memoizedProps:o,l=t.type,h=t.updateQueue;if(t.updateQueue=null,null!==h)try{"input"===l&&"radio"===o.type&&null!=o.name&&K(i,o),wt(l,s);var c=wt(l,o);for(s=0;s<h.length;s+=2){var u=h[s],d=h[s+1];"style"===u?gt(i,d):"dangerouslySetInnerHTML"===u?ut(i,d):"children"===u?dt(i,d):w(i,u,d,c)}switch(l){case"input":Q(i,o);break;case"textarea":at(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var m=o.value;null!=m?nt(i,!!o.multiple,m,!1):f!==!!o.multiple&&(null!=o.defaultValue?nt(i,!!o.multiple,o.defaultValue,!0):nt(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Sh(t,t.return,g)}}break;case 6:if(pl(e,t),vl(t),4&r){if(null===t.stateNode)throw Error(a(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){Sh(t,t.return,g)}}break;case 3:if(pl(e,t),vl(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{He(e.containerInfo)}catch(g){Sh(t,t.return,g)}break;case 4:default:pl(e,t),vl(t);break;case 13:pl(e,t),vl(t),8192&(i=t.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Kt())),4&r&&ml(t);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&t.mode?(Zs=(c=Zs)||u,pl(e,t),Zs=c):pl(e,t),vl(t),8192&r){if(c=null!==t.memoizedState,(t.stateNode.isHidden=c)&&!u&&0!==(1&t.mode))for(Qs=t,u=t.child;null!==u;){for(d=Qs=u;null!==Qs;){switch(m=(f=Qs).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Js(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Sh(r,n,g)}}break;case 5:Js(f,f.return);break;case 22:if(null!==f.memoizedState){bl(d);continue}}null!==m?(m.return=f,Qs=m):bl(d)}u=u.sibling}t:for(u=null,d=t;;){if(5===d.tag){if(null===u){u=d;try{i=d.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,s=void 0!==(h=d.memoizedProps.style)&&null!==h&&h.hasOwnProperty("display")?h.display:null,l.style.display=pt("display",s))}catch(g){Sh(t,t.return,g)}}}else if(6===d.tag){if(null===u)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Sh(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(e,t),vl(t),4&r&&ml(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(ol(n)){var r=n;break t}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(dt(i,""),r.flags&=-33),hl(t,sl(t),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(t,sl(t),o);break;default:throw Error(a(161))}}catch(s){Sh(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function _l(t,e,n){Qs=t,wl(t,e,n)}function wl(t,e,n){for(var r=0!==(1&t.mode);null!==Qs;){var i=Qs,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||$s;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Zs;s=$s;var h=Zs;if($s=o,(Zs=l)&&!h)for(Qs=i;null!==Qs;)l=(o=Qs).child,22===o.tag&&null!==o.memoizedState?xl(i):null!==l?(l.return=o,Qs=l):xl(i);for(;null!==a;)Qs=a,wl(a,e,n),a=a.sibling;Qs=i,$s=s,Zs=h}yl(t)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Qs=a):yl(t)}}function yl(t){for(;null!==Qs;){var e=Qs;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Zs||rl(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Zs)if(null===n)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ns(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&Ga(e,o,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Ga(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var c=e.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var d=u.dehydrated;null!==d&&He(d)}}}break;default:throw Error(a(163))}Zs||512&e.flags&&il(e)}catch(f){Sh(e,e.return,f)}}if(e===t){Qs=null;break}if(null!==(n=e.sibling)){n.return=e.return,Qs=n;break}Qs=e.return}}function bl(t){for(;null!==Qs;){var e=Qs;if(e===t){Qs=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Qs=n;break}Qs=e.return}}function xl(t){for(;null!==Qs;){var e=Qs;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rl(4,e)}catch(l){Sh(e,n,l)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var i=e.return;try{r.componentDidMount()}catch(l){Sh(e,i,l)}}var a=e.return;try{il(e)}catch(l){Sh(e,a,l)}break;case 5:var o=e.return;try{il(e)}catch(l){Sh(e,o,l)}}}catch(l){Sh(e,e.return,l)}if(e===t){Qs=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Qs=s;break}Qs=e.return}}var Ml,Sl=Math.ceil,El=y.ReactCurrentDispatcher,kl=y.ReactCurrentOwner,Cl=y.ReactCurrentBatchConfig,Al=0,Pl=null,Tl=null,Dl=0,Il=0,Nl=Si(0),Rl=0,Ll=null,Ul=0,Ol=0,zl=0,Fl=null,Bl=null,Vl=0,Hl=1/0,Gl=null,jl=!1,Yl=null,Xl=null,Wl=!1,ql=null,$l=0,Zl=0,Kl=null,Ql=-1,Jl=0;function th(){return 0!==(6&Al)?Kt():-1!==Ql?Ql:Ql=Kt()}function eh(t){return 0===(1&t.mode)?1:0!==(2&Al)&&0!==Dl?Dl&-Dl:null!==pa.transition?(0===Jl&&(Jl=pe()),Jl):0!==(t=we)?t:t=void 0===(t=window.event)?16:Ze(t.type)}function nh(t,e,n,r){if(50<Zl)throw Zl=0,Kl=null,Error(a(185));ve(t,n,r),0!==(2&Al)&&t===Pl||(t===Pl&&(0===(2&Al)&&(Ol|=n),4===Rl&&sh(t,Dl)),rh(t,r),1===n&&0===Al&&0===(1&e.mode)&&(Hl=Kt()+500,Fi&&Hi()))}function rh(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-oe(a),s=1<<o,l=i[o];-1===l?0!==(s&n)&&0===(s&r)||(i[o]=fe(s,e)):l<=e&&(t.expiredLanes|=s),a&=~s}}(t,e);var r=de(t,t===Pl?Dl:0);if(0===r)null!==n&&qt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&qt(n),1===e)0===t.tag?function(t){Fi=!0,Vi(t)}(lh.bind(null,t)):Vi(lh.bind(null,t)),oi((function(){0===(6&Al)&&Hi()})),n=null;else{switch(ye(r)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=Ph(n,ih.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ih(t,e){if(Ql=-1,Jl=0,0!==(6&Al))throw Error(a(327));var n=t.callbackNode;if(xh()&&t.callbackNode!==n)return null;var r=de(t,t===Pl?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=gh(t,r);else{e=r;var i=Al;Al|=2;var o=mh();for(Pl===t&&Dl===e||(Gl=null,Hl=Kt()+500,dh(t,e));;)try{_h();break}catch(l){fh(t,l)}ka(),El.current=o,Al=i,null!==Tl?e=0:(Pl=null,Dl=0,e=Rl)}if(0!==e){if(2===e&&(0!==(i=me(t))&&(r=i,e=ah(t,i))),1===e)throw n=Ll,dh(t,0),sh(t,r),rh(t,Kt()),n;if(6===e)sh(t,r);else{if(i=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(i)&&(2===(e=gh(t,r))&&(0!==(o=me(t))&&(r=o,e=ah(t,o))),1===e))throw n=Ll,dh(t,0),sh(t,r),rh(t,Kt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(a(345));case 2:case 5:bh(t,Bl,Gl);break;case 3:if(sh(t,r),(130023424&r)===r&&10<(e=Vl+500-Kt())){if(0!==de(t,0))break;if(((i=t.suspendedLanes)&r)!==r){th(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ri(bh.bind(null,t,Bl,Gl),e);break}bh(t,Bl,Gl);break;case 4:if(sh(t,r),(4194240&r)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-oe(r);o=1<<s,(s=e[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Kt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){t.timeoutHandle=ri(bh.bind(null,t,Bl,Gl),r);break}bh(t,Bl,Gl);break;default:throw Error(a(329))}}}return rh(t,Kt()),t.callbackNode===n?ih.bind(null,t):null}function ah(t,e){var n=Fl;return t.current.memoizedState.isDehydrated&&(dh(t,e).flags|=256),2!==(t=gh(t,e))&&(e=Bl,Bl=n,null!==e&&oh(e)),t}function oh(t){null===Bl?Bl=t:Bl.push.apply(Bl,t)}function sh(t,e){for(e&=~zl,e&=~Ol,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),r=1<<n;t[n]=-1,e&=~r}}function lh(t){if(0!==(6&Al))throw Error(a(327));xh();var e=de(t,0);if(0===(1&e))return rh(t,Kt()),null;var n=gh(t,e);if(0!==t.tag&&2===n){var r=me(t);0!==r&&(e=r,n=ah(t,r))}if(1===n)throw n=Ll,dh(t,0),sh(t,e),rh(t,Kt()),n;if(6===n)throw Error(a(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bh(t,Bl,Gl),rh(t,Kt()),null}function hh(t,e){var n=Al;Al|=1;try{return t(e)}finally{0===(Al=n)&&(Hl=Kt()+500,Fi&&Hi())}}function ch(t){null!==ql&&0===ql.tag&&0===(6&Al)&&xh();var e=Al;Al|=1;var n=Cl.transition,r=we;try{if(Cl.transition=null,we=1,t)return t()}finally{we=r,Cl.transition=n,0===(6&(Al=e))&&Hi()}}function uh(){Il=Nl.current,Ei(Nl)}function dh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ii(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(ea(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:Za(),Ei(Pi),Ei(Ai),no();break;case 5:Qa(r);break;case 4:Za();break;case 13:case 19:Ei(Ja);break;case 10:Ca(r.type._context);break;case 22:case 23:uh()}n=n.return}if(Pl=t,Tl=t=Nh(t.current,null),Dl=Il=e,Rl=0,Ll=null,zl=Ol=Ul=0,Bl=Fl=null,null!==Da){for(e=0;e<Da.length;e++)if(null!==(r=(n=Da[e]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Da=null}return t}function fh(t,e){for(;;){var n=Tl;try{if(ka(),ro.current=Qo,ho){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ho=!1}if(ao=0,lo=so=oo=null,co=!1,uo=0,kl.current=null,null===n||null===n.return){Rl=1,Ll=e,Tl=null;break}t:{var o=t,s=n.return,l=n,h=e;if(e=Dl,l.flags|=32768,null!==h&&"object"===typeof h&&"function"===typeof h.then){var c=h,u=l,d=u.tag;if(0===(1&u.mode)&&(0===d||11===d||15===d)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=gs(s);if(null!==m){m.flags&=-257,vs(m,s,l,0,e),1&m.mode&&ps(o,c,e),h=c;var p=(e=m).updateQueue;if(null===p){var g=new Set;g.add(h),e.updateQueue=g}else p.add(h);break t}if(0===(1&e)){ps(o,c,e),ph();break t}h=Error(a(426))}else if(ia&&1&l.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,e),ma(hs(h,l));break t}}o=h=hs(h,l),4!==Rl&&(Rl=2),null===Fl?Fl=[o]:Fl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,Va(o,fs(0,h,e));break t;case 1:l=h;var _=o.type,w=o.stateNode;if(0===(128&o.flags)&&("function"===typeof _.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Xl||!Xl.has(w)))){o.flags|=65536,e&=-e,o.lanes|=e,Va(o,ms(o,l,e));break t}}o=o.return}while(null!==o)}yh(n)}catch(y){e=y,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function mh(){var t=El.current;return El.current=Qo,null===t?Qo:t}function ph(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Pl||0===(268435455&Ul)&&0===(268435455&Ol)||sh(Pl,Dl)}function gh(t,e){var n=Al;Al|=2;var r=mh();for(Pl===t&&Dl===e||(Gl=null,dh(t,e));;)try{vh();break}catch(i){fh(t,i)}if(ka(),Al=n,El.current=r,null!==Tl)throw Error(a(261));return Pl=null,Dl=0,Rl}function vh(){for(;null!==Tl;)wh(Tl)}function _h(){for(;null!==Tl&&!$t();)wh(Tl)}function wh(t){var e=Ml(t.alternate,t,Il);t.memoizedProps=t.pendingProps,null===e?yh(t):Tl=e,kl.current=null}function yh(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Ws(n,e,Il)))return void(Tl=n)}else{if(null!==(n=qs(n,e)))return n.flags&=32767,void(Tl=n);if(null===t)return Rl=6,void(Tl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Tl=e);Tl=e=t}while(null!==e);0===Rl&&(Rl=5)}function bh(t,e,n){var r=we,i=Cl.transition;try{Cl.transition=null,we=1,function(t,e,n,r){do{xh()}while(null!==ql);if(0!==(6&Al))throw Error(a(327));n=t.finishedWork;var i=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-oe(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}(t,o),t===Pl&&(Tl=Pl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,Ph(ee,(function(){return xh(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var s=we;we=1;var l=Al;Al|=4,kl.current=null,function(t,e){if(ti=je,fr(t=dr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break t}var s=0,l=-1,h=-1,c=0,u=0,d=t,f=null;e:for(;;){for(var m;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==o||0!==r&&3!==d.nodeType||(h=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(m=d.firstChild);)f=d,d=m;for(;;){if(d===t)break e;if(f===n&&++c===i&&(l=s),f===o&&++u===r&&(h=s),null!==(m=d.nextSibling))break;f=(d=f).parentNode}d=m}n=-1===l||-1===h?null:{start:l,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:t,selectionRange:n},je=!1,Qs=e;null!==Qs;)if(t=(e=Qs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Qs=t;else for(;null!==Qs;){e=Qs;try{var p=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,_=e.stateNode,w=_.getSnapshotBeforeUpdate(e.elementType===e.type?g:ns(e.type,g),v);_.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(a(163))}}catch(b){Sh(e,e.return,b)}if(null!==(t=e.sibling)){t.return=e.return,Qs=t;break}Qs=e.return}p=el,el=!1}(t,n),gl(n,t),mr(ei),je=!!ti,ei=ti=null,t.current=n,_l(n,t,i),Zt(),Al=l,we=s,Cl.transition=o}else t.current=n;if(Wl&&(Wl=!1,ql=t,$l=i),o=t.pendingLanes,0===o&&(Xl=null),function(t){if(ae&&"function"===typeof ae.onCommitFiberRoot)try{ae.onCommitFiberRoot(ie,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),rh(t,Kt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(jl)throw jl=!1,t=Yl,Yl=null,t;0!==(1&$l)&&0!==t.tag&&xh(),o=t.pendingLanes,0!==(1&o)?t===Kl?Zl++:(Zl=0,Kl=t):Zl=0,Hi()}(t,e,n,r)}finally{Cl.transition=i,we=r}return null}function xh(){if(null!==ql){var t=ye($l),e=Cl.transition,n=we;try{if(Cl.transition=null,we=16>t?16:t,null===ql)var r=!1;else{if(t=ql,ql=null,$l=0,0!==(6&Al))throw Error(a(331));var i=Al;for(Al|=4,Qs=t.current;null!==Qs;){var o=Qs,s=o.child;if(0!==(16&Qs.flags)){var l=o.deletions;if(null!==l){for(var h=0;h<l.length;h++){var c=l[h];for(Qs=c;null!==Qs;){var u=Qs;switch(u.tag){case 0:case 11:case 15:nl(8,u,o)}var d=u.child;if(null!==d)d.return=u,Qs=d;else for(;null!==Qs;){var f=(u=Qs).sibling,m=u.return;if(al(u),u===c){Qs=null;break}if(null!==f){f.return=m,Qs=f;break}Qs=m}}}var p=o.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Qs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Qs=s;else t:for(;null!==Qs;){if(0!==(2048&(o=Qs).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var _=o.sibling;if(null!==_){_.return=o.return,Qs=_;break t}Qs=o.return}}var w=t.current;for(Qs=w;null!==Qs;){var y=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==y)y.return=s,Qs=y;else t:for(s=w;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(x){Sh(l,l.return,x)}if(l===s){Qs=null;break t}var b=l.sibling;if(null!==b){b.return=l.return,Qs=b;break t}Qs=l.return}}if(Al=i,Hi(),ae&&"function"===typeof ae.onPostCommitFiberRoot)try{ae.onPostCommitFiberRoot(ie,t)}catch(x){}r=!0}return r}finally{we=n,Cl.transition=e}}return!1}function Mh(t,e,n){t=Fa(t,e=fs(0,e=hs(n,e),1),1),e=th(),null!==t&&(ve(t,1,e),rh(t,e))}function Sh(t,e,n){if(3===t.tag)Mh(t,t,n);else for(;null!==e;){if(3===e.tag){Mh(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xl||!Xl.has(r))){e=Fa(e,t=ms(e,t=hs(n,t),1),1),t=th(),null!==e&&(ve(e,1,t),rh(e,t));break}}e=e.return}}function Eh(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=th(),t.pingedLanes|=t.suspendedLanes&n,Pl===t&&(Dl&n)===n&&(4===Rl||3===Rl&&(130023424&Dl)===Dl&&500>Kt()-Vl?dh(t,0):zl|=n),rh(t,e)}function kh(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var n=th();null!==(t=Ra(t,e))&&(ve(t,e,n),rh(t,n))}function Ch(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),kh(t,n)}function Ah(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(e),kh(t,n)}function Ph(t,e){return Wt(t,e)}function Th(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dh(t,e,n,r){return new Th(t,e,n,r)}function Ih(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Nh(t,e){var n=t.alternate;return null===n?((n=Dh(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rh(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)Ih(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case M:return Lh(n.children,i,o,e);case S:s=8,i|=8;break;case E:return(t=Dh(12,n,e,2|i)).elementType=E,t.lanes=o,t;case P:return(t=Dh(13,n,e,i)).elementType=P,t.lanes=o,t;case T:return(t=Dh(19,n,e,i)).elementType=T,t.lanes=o,t;case N:return Uh(n,i,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case k:s=10;break t;case C:s=9;break t;case A:s=11;break t;case D:s=14;break t;case I:s=16,r=null;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Dh(s,n,e,i)).elementType=t,e.type=r,e.lanes=o,e}function Lh(t,e,n,r){return(t=Dh(7,t,r,e)).lanes=n,t}function Uh(t,e,n,r){return(t=Dh(22,t,r,e)).elementType=N,t.lanes=n,t.stateNode={isHidden:!1},t}function Oh(t,e,n){return(t=Dh(6,t,null,e)).lanes=n,t}function zh(t,e,n){return(e=Dh(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fh(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bh(t,e,n,r,i,a,o,s,l){return t=new Fh(t,e,n,s,l),1===e?(e=1,!0===a&&(e|=8)):e=0,a=Dh(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ua(a),t}function Vh(t){if(!t)return Ci;t:{if(Ht(t=t._reactInternals)!==t||1!==t.tag)throw Error(a(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ii(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(a(171))}if(1===t.tag){var n=t.type;if(Ii(n))return Li(t,n,e)}return e}function Hh(t,e,n,r,i,a,o,s,l){return(t=Bh(n,r,!0,t,0,a,0,s,l)).context=Vh(null),n=t.current,(a=za(r=th(),i=eh(n))).callback=void 0!==e&&null!==e?e:null,Fa(n,a,i),t.current.lanes=i,ve(t,i,r),rh(t,r),t}function Gh(t,e,n,r){var i=e.current,a=th(),o=eh(i);return n=Vh(n),null===e.context?e.context=n:e.pendingContext=n,(e=za(a,o)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Fa(i,e,o))&&(nh(t,i,o,a),Ba(t,i,o)),o}function jh(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Yh(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Xh(t,e){Yh(t,e),(t=t.alternate)&&Yh(t,e)}Ml=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Pi.current)ws=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return ws=!1,function(t,e,n){switch(e.tag){case 3:Ps(e),fa();break;case 5:Ka(e);break;case 1:Ii(e.type)&&Ui(e);break;case 4:$a(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ki(xa,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(ki(Ja,1&Ja.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Os(t,e,n):(ki(Ja,1&Ja.current),null!==(t=js(t,e,n))?t.sibling:null);ki(Ja,1&Ja.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Hs(t,e,n);e.flags|=128}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ki(Ja,Ja.current),r)break;return null;case 22:case 23:return e.lanes=0,Ss(t,e,n)}return js(t,e,n)}(t,e,n);ws=0!==(131072&t.flags)}else ws=!1,ia&&0!==(1048576&e.flags)&&Ji(e,Xi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gs(t,e),t=e.pendingProps;var i=Di(e,Ai.current);Pa(e,n),i=go(null,e,r,t,i,n);var o=vo();return e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ii(r)?(o=!0,Ui(e)):o=!1,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ua(e),i.updater=is,e.stateNode=i,i._reactInternals=e,ls(e,r,t,n),e=As(null,e,r,!0,o,n)):(e.tag=0,ia&&o&&ta(e),ys(null,e,i,n),e=e.child),e;case 16:r=e.elementType;t:{switch(Gs(t,e),t=e.pendingProps,r=(i=r._init)(r._payload),e.type=r,i=e.tag=function(t){if("function"===typeof t)return Ih(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===A)return 11;if(t===D)return 14}return 2}(r),t=ns(r,t),i){case 0:e=ks(null,e,r,t,n);break t;case 1:e=Cs(null,e,r,t,n);break t;case 11:e=bs(null,e,r,t,n);break t;case 14:e=xs(null,e,r,ns(r.type,t),n);break t}throw Error(a(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,ks(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 1:return r=e.type,i=e.pendingProps,Cs(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 3:t:{if(Ps(e),null===t)throw Error(a(387));r=e.pendingProps,i=(o=e.memoizedState).element,Oa(t,e),Ha(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Ts(t,e,r,n,i=hs(Error(a(423)),e));break t}if(r!==i){e=Ts(t,e,r,n,i=hs(Error(a(424)),e));break t}for(ra=hi(e.stateNode.containerInfo.firstChild),na=e,ia=!0,aa=null,n=ba(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){e=js(t,e,n);break t}ys(t,e,r,n)}e=e.child}return e;case 5:return Ka(e),null===t&&ha(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(e.flags|=32),Es(t,e),ys(t,e,s,n),e.child;case 6:return null===t&&ha(e),null;case 13:return Os(t,e,n);case 4:return $a(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=ya(e,null,r,n):ys(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,bs(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 7:return ys(t,e,e.pendingProps,n),e.child;case 8:case 12:return ys(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ki(xa,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Pi.current){e=js(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var h=l.firstContext;null!==h;){if(h.context===r){if(1===o.tag){(h=za(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?h.next=h:(h.next=u.next,u.next=h),c.pending=h}}o.lanes|=n,null!==(h=o.alternate)&&(h.lanes|=n),Aa(o.return,n,e),l.lanes|=n;break}h=h.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Aa(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ys(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Pa(e,n),r=r(i=Ta(i)),e.flags|=1,ys(t,e,r,n),e.child;case 14:return i=ns(r=e.type,e.pendingProps),xs(t,e,r,i=ns(r.type,i),n);case 15:return Ms(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ns(r,i),Gs(t,e),e.tag=1,Ii(r)?(t=!0,Ui(e)):t=!1,Pa(e,n),os(e,r,i),ls(e,r,i,n),As(null,e,r,!0,t,n);case 19:return Hs(t,e,n);case 22:return Ss(t,e,n)}throw Error(a(156,e.tag))};var Wh="function"===typeof reportError?reportError:function(t){console.error(t)};function qh(t){this._internalRoot=t}function $h(t){this._internalRoot=t}function Zh(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Kh(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qh(){}function Jh(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var t=jh(o);s.call(t)}}Gh(e,o,t,i)}else o=function(t,e,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var t=jh(o);a.call(t)}}var o=Hh(e,r,t,0,null,!1,0,"",Qh);return t._reactRootContainer=o,t[mi]=o.current,Hr(8===t.nodeType?t.parentNode:t),ch(),o}for(;i=t.lastChild;)t.removeChild(i);if("function"===typeof r){var s=r;r=function(){var t=jh(l);s.call(t)}}var l=Bh(t,0,!1,null,0,!1,0,"",Qh);return t._reactRootContainer=l,t[mi]=l.current,Hr(8===t.nodeType?t.parentNode:t),ch((function(){Gh(e,l,n,r)})),l}(n,e,t,i,r);return jh(o)}$h.prototype.render=qh.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(a(409));Gh(t,e,null,null)},$h.prototype.unmount=qh.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;ch((function(){Gh(null,t,null,null)})),e[mi]=null}},$h.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ne.length&&0!==e&&e<Ne[n].priority;n++);Ne.splice(n,0,t),0===n&&Oe(t)}},be=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ue(e.pendingLanes);0!==n&&(_e(e,1|n),rh(e,Kt()),0===(6&Al)&&(Hl=Kt()+500,Hi()))}break;case 13:ch((function(){var e=Ra(t,1);if(null!==e){var n=th();nh(e,t,1,n)}})),Xh(t,1)}},xe=function(t){if(13===t.tag){var e=Ra(t,134217728);if(null!==e)nh(e,t,134217728,th());Xh(t,134217728)}},Me=function(t){if(13===t.tag){var e=eh(t),n=Ra(t,e);if(null!==n)nh(n,t,e,th());Xh(t,e)}},Se=function(){return we},Ee=function(t,e){var n=we;try{return we=t,e()}finally{we=n}},xt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=bi(r);if(!i)throw Error(a(90));W(r),Q(r,i)}}}break;case"textarea":at(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},At=hh,Pt=ch;var tc={usingClientEntryPoint:!1,Events:[wi,yi,bi,kt,Ct,hh]},ec={findFiberByHostInstance:_i,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:ec.bundleType,version:ec.version,rendererPackageName:ec.rendererPackageName,rendererConfig:ec.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Yt(t))?null:t.stateNode},findFiberByHostInstance:ec.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{ie=rc.inject(nc),ae=rc}catch(ct){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zh(e))throw Error(a(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Zh(t))throw Error(a(299));var n=!1,r="",i=Wh;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(i=e.onRecoverableError)),e=Bh(t,1,!1,null,0,n,0,r,i),t[mi]=e.current,Hr(8===t.nodeType?t.parentNode:t),new qh(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw t=Object.keys(t).join(","),Error(a(268,t))}return t=null===(t=Yt(e))?null:t.stateNode},e.flushSync=function(t){return ch(t)},e.hydrate=function(t,e,n){if(!Kh(e))throw Error(a(200));return Jh(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Zh(t))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Wh;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Hh(e,null,t,1,null!=n?n:null,i,0,o,s),t[mi]=e.current,Hr(t),r)for(t=0;t<r.length;t++)i=(i=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new $h(e)},e.render=function(t,e,n){if(!Kh(e))throw Error(a(200));return Jh(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Kh(t))throw Error(a(40));return!!t._reactRootContainer&&(ch((function(){Jh(null,null,t,!1,(function(){t._reactRootContainer=null,t[mi]=null}))})),!0)},e.unstable_batchedUpdates=hh,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kh(n))throw Error(a(200));if(null==t||void 0===t._reactInternals)throw Error(a(38));return Jh(t,e,n,!1,r)},e.version="18.3.1-next-f1338f8080-20240426"},4391:(t,e,n)=>{"use strict";var r=n(7950);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},7950:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(2730)},1153:(t,e,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function h(t,e,n){var r,a={},h=null,c=null;for(r in void 0!==n&&(h=""+n),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(c=e.ref),e)o.call(e,r)&&!l.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===a[r]&&(a[r]=e[r]);return{$$typeof:i,type:t,key:h,ref:c,props:a,_owner:s.current}}e.Fragment=a,e.jsx=h,e.jsxs=h},4202:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||m}function _(){}function w(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},_.prototype=v.prototype;var y=w.prototype=new _;y.constructor=w,p(y,v.prototype),y.isPureReactComponent=!0;var b=Array.isArray,x=Object.prototype.hasOwnProperty,M={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,r){var i,a={},o=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)x.call(e,i)&&!S.hasOwnProperty(i)&&(a[i]=e[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var h=Array(l),c=0;c<l;c++)h[c]=arguments[c+2];a.children=h}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:t,key:o,ref:s,props:a,_owner:M.current}}function k(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,i,a,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=t),t=""===a?"."+A(l,0):a,b(o)?(i="",null!=t&&(i=t.replace(C,"$&/")+"/"),P(o,e,i,"",(function(t){return t}))):null!=o&&(k(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+t)),e.push(o)),1;if(l=0,a=""===a?".":a+":",b(t))for(var h=0;h<t.length;h++){var c=a+A(s=t[h],h);l+=P(s,e,i,c,o)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),h=0;!(s=t.next()).done;)l+=P(s=s.value,e,i,c=a+A(s,h++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function T(t,e,n){if(null==t)return t;var r=[],i=0;return P(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function D(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var I={current:null},N={transition:null},R={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:N,ReactCurrentOwner:M};function L(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:T,forEach:function(t,e,n){T(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return T(t,(function(){e++})),e},toArray:function(t){return T(t,(function(t){return t}))||[]},only:function(t){if(!k(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=i,e.Profiler=o,e.PureComponent=w,e.StrictMode=a,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.act=L,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=p({},t.props),a=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=M.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)x.call(e,h)&&!S.hasOwnProperty(h)&&(i[h]=void 0===e[h]&&void 0!==l?l[h]:e[h])}var h=arguments.length-2;if(1===h)i.children=r;else if(1<h){l=Array(h);for(var c=0;c<h;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:t.type,key:a,ref:o,props:i,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:h,render:t}},e.isValidElement=k,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:D}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=N.transition;N.transition={};try{t()}finally{N.transition=e}},e.unstable_act=L,e.useCallback=function(t,e){return I.current.useCallback(t,e)},e.useContext=function(t){return I.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return I.current.useDeferredValue(t)},e.useEffect=function(t,e){return I.current.useEffect(t,e)},e.useId=function(){return I.current.useId()},e.useImperativeHandle=function(t,e,n){return I.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return I.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return I.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return I.current.useMemo(t,e)},e.useReducer=function(t,e,n){return I.current.useReducer(t,e,n)},e.useRef=function(t){return I.current.useRef(t)},e.useState=function(t){return I.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return I.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return I.current.useTransition()},e.version="18.3.1"},5043:(t,e,n)=>{"use strict";t.exports=n(4202)},579:(t,e,n)=>{"use strict";t.exports=n(1153)},5592:(t,e,n)=>{"use strict";var r=n(9844),i=n(2476),a=n(934),o=n(9571);function s(t,e,n,r){return function(n,i,a){var o=t(t(e(i[1],a[0]),e(-a[1],i[0])),t(e(n[1],i[0]),e(-i[1],n[0]))),s=t(e(n[1],a[0]),e(-a[1],n[0])),l=r(o,s);return l[l.length-1]}}function l(t,e,n,r){return function(i,a,o,s){var l=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),s[2])))),h=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),t(n(t(e(a[1],o[0]),e(-o[1],a[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),o[2])))),c=r(l,h);return c[c.length-1]}}function h(t,e,n,r){return function(i,a,o,s,l){var h=t(t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),l[2]))),a[3]),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-s[2]),n(t(e(a[1],s[0]),e(-s[1],a[0])),l[2]))),-o[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),l[2]))),s[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),-l[3]),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-s[2]),n(t(e(a[1],s[0]),e(-s[1],a[0])),l[2]))),i[3]),n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),l[2]))),-a[3])))),t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),l[2]))),s[3]),t(n(t(n(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),s[2]))),-l[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]),t(n(t(e(a[1],s[0]),e(-s[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]))),i[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),-a[3]),t(n(t(n(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),s[2]))),o[3]),n(t(n(t(e(a[1],o[0]),e(-o[1],a[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),o[2]))),-s[3]))))),c=t(t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),l[2]))),i[3]),n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),l[2]))),-o[3])),t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),l[2]))),s[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),-l[3]))),t(t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),a[2]),t(n(t(e(a[1],l[0]),e(-l[1],a[0])),-o[2]),n(t(e(a[1],o[0]),e(-o[1],a[0])),l[2]))),i[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),l[2]))),-a[3])),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),i[2]),t(n(t(e(i[1],l[0]),e(-l[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),l[2]))),o[3]),n(t(n(t(e(a[1],o[0]),e(-o[1],a[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-a[2]),n(t(e(i[1],a[0]),e(-a[1],i[0])),o[2]))),-l[3])))),u=r(h,c);return u[u.length-1]}}function c(t){return(3===t?s:4===t?l:h)(i,r,a,o)}var u=c(3),d=c(4),f=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,i=(t[1]-n[1])*(e[0]-n[0]),a=(t[0]-n[0])*(e[1]-n[1]),o=i-a;if(i>0){if(a<=0)return o;r=i+a}else{if(!(i<0))return o;if(a>=0)return o;r=-(i+a)}var s=33306690738754716e-32*r;return o>=s||o<=-s?o:u(t,e,n)},function(t,e,n,r){var i=t[0]-r[0],a=e[0]-r[0],o=n[0]-r[0],s=t[1]-r[1],l=e[1]-r[1],h=n[1]-r[1],c=t[2]-r[2],u=e[2]-r[2],f=n[2]-r[2],m=a*h,p=o*l,g=o*s,v=i*h,_=i*l,w=a*s,y=c*(m-p)+u*(g-v)+f*(_-w),b=7771561172376103e-31*((Math.abs(m)+Math.abs(p))*Math.abs(c)+(Math.abs(g)+Math.abs(v))*Math.abs(u)+(Math.abs(_)+Math.abs(w))*Math.abs(f));return y>b||-y>b?y:d(t,e,n,r)}];function m(t){var e=f[t.length];return e||(e=f[t.length]=c(t.length)),e.apply(void 0,t)}function p(t,e,n,r,i,a,o){return function(e,n,s,l,h){switch(arguments.length){case 0:case 1:return 0;case 2:return r(e,n);case 3:return i(e,n,s);case 4:return a(e,n,s,l);case 5:return o(e,n,s,l,h)}for(var c=new Array(arguments.length),u=0;u<arguments.length;++u)c[u]=arguments[u];return t(c)}}!function(){for(;f.length<=5;)f.push(c(f.length));t.exports=p.apply(void 0,[m].concat(f));for(var e=0;e<=5;++e)t.exports[e]=f[e]}()},6427:(t,e,n)=>{t.exports=function(t,e){for(var n=e[0],i=e[1],a=t.length,o=1,s=a,l=0,h=a-1;l<s;h=l++){var c=t[l],u=t[h],d=c[1],f=u[1];if(f<d){if(f<i&&i<d){if(0===(m=r(c,u,e)))return 0;o^=0<m|0}else if(i===d){if(d<t[(l+1)%a][1]){if(0===(m=r(c,u,e)))return 0;o^=0<m|0}}}else if(d<f){if(d<i&&i<f){if(0===(m=r(c,u,e)))return 0;o^=m<0|0}else if(i===d){if(t[(l+1)%a][1]<d){var m;if(0===(m=r(c,u,e)))return 0;o^=m<0|0}}}else if(i===d){var p=Math.min(c[0],u[0]),g=Math.max(c[0],u[0]);if(0===l){for(;h>0;){var v=(h+a-1)%a;if((y=t[v])[1]!==i)break;var _=y[0];p=Math.min(p,_),g=Math.max(g,_),h=v}if(0===h)return p<=n&&n<=g?0:1;s=h+1}for(var w=t[(h+a-1)%a][1];l+1<s;){var y;if((y=t[l+1])[1]!==i)break;_=y[0];p=Math.min(p,_),g=Math.max(g,_),l+=1}if(p<=n&&n<=g)return 0;var b=t[(l+1)%a][1];n<p&&w<i!==b<i&&(o^=1)}}return 2*o-1};var r=n(5592)},934:(t,e,n)=>{"use strict";var r=n(9844),i=n(9684);t.exports=function(t,e){var n=t.length;if(1===n){var a=r(t[0],e);return a[0]?a:[a[1]]}var o=new Array(2*n),s=[.1,.1],l=[.1,.1],h=0;r(t[0],e,s),s[0]&&(o[h++]=s[0]);for(var c=1;c<n;++c){r(t[c],e,l);var u=s[1];i(u,l[0],s),s[0]&&(o[h++]=s[0]);var d=l[1],f=s[1],m=d+f,p=f-(m-d);s[1]=m,p&&(o[h++]=p)}s[1]&&(o[h++]=s[1]);0===h&&(o[h++]=0);return o.length=h,o}},9571:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=n-r,a=e-r,o=t-i,s=o+a;if(s)return[s,n];return[n]}(t[0],-e[0]);var i,a,o=new Array(n+r),s=0,l=0,h=0,c=Math.abs,u=t[l],d=c(u),f=-e[h],m=c(f);d<m?(a=u,(l+=1)<n&&(d=c(u=t[l]))):(a=f,(h+=1)<r&&(m=c(f=-e[h])));l<n&&d<m||h>=r?(i=u,(l+=1)<n&&(d=c(u=t[l]))):(i=f,(h+=1)<r&&(m=c(f=-e[h])));var p,g,v=i+a,_=v-i,w=a-_,y=w,b=v;for(;l<n&&h<r;)d<m?(i=u,(l+=1)<n&&(d=c(u=t[l]))):(i=f,(h+=1)<r&&(m=c(f=-e[h]))),(w=(a=y)-(_=(v=i+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p;for(;l<n;)(w=(a=y)-(_=(v=(i=u)+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p,(l+=1)<n&&(u=t[l]);for(;h<r;)(w=(a=y)-(_=(v=(i=f)+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p,(h+=1)<r&&(f=-e[h]);y&&(o[s++]=y);b&&(o[s++]=b);s||(o[s++]=0);return o.length=s,o}},2476:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=n-r,a=e-r,o=t-i,s=o+a;if(s)return[s,n];return[n]}(t[0],e[0]);var i,a,o=new Array(n+r),s=0,l=0,h=0,c=Math.abs,u=t[l],d=c(u),f=e[h],m=c(f);d<m?(a=u,(l+=1)<n&&(d=c(u=t[l]))):(a=f,(h+=1)<r&&(m=c(f=e[h])));l<n&&d<m||h>=r?(i=u,(l+=1)<n&&(d=c(u=t[l]))):(i=f,(h+=1)<r&&(m=c(f=e[h])));var p,g,v=i+a,_=v-i,w=a-_,y=w,b=v;for(;l<n&&h<r;)d<m?(i=u,(l+=1)<n&&(d=c(u=t[l]))):(i=f,(h+=1)<r&&(m=c(f=e[h]))),(w=(a=y)-(_=(v=i+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p;for(;l<n;)(w=(a=y)-(_=(v=(i=u)+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p,(l+=1)<n&&(u=t[l]);for(;h<r;)(w=(a=y)-(_=(v=(i=f)+a)-i))&&(o[s++]=w),y=b-((p=b+v)-(g=p-b))+(v-g),b=p,(h+=1)<r&&(f=e[h]);y&&(o[s++]=y);b&&(o[s++]=b);s||(o[s++]=0);return o.length=s,o}},7234:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,i=t[r];if(!(0<a(i,e)))break t;t[r]=e,t[n]=i,n=r}}function r(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=t[s],h=s+1,c=t[h];if(0>a(l,n))h<i&&0>a(c,l)?(t[r]=c,t[h]=n,r=h):(t[r]=l,t[s]=n,r=s);else{if(!(h<i&&0>a(c,n)))break t;t[r]=c,t[h]=n,r=h}}}return e}function a(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var h=[],c=[],u=1,d=null,f=3,m=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function y(t){for(var e=r(c);null!==e;){if(null===e.callback)i(c);else{if(!(e.startTime<=t))break;i(c),e.sortIndex=e.expirationTime,n(h,e)}e=r(c)}}function b(t){if(g=!1,y(t),!p)if(null!==r(h))p=!0,N(x);else{var e=r(c);null!==e&&R(b,e.startTime-t)}}function x(t,n){p=!1,g&&(g=!1,_(k),k=-1),m=!0;var a=f;try{for(y(n),d=r(h);null!==d&&(!(d.expirationTime>n)||t&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(h)&&i(h),y(n)}else i(h);d=r(h)}if(null!==d)var l=!0;else{var u=r(c);null!==u&&R(b,u.startTime-n),l=!1}return l}finally{d=null,f=a,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var M,S=!1,E=null,k=-1,C=5,A=-1;function P(){return!(e.unstable_now()-A<C)}function T(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?M():(S=!1,E=null)}}else S=!1}if("function"===typeof w)M=function(){w(T)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,I=D.port2;D.port1.onmessage=T,M=function(){I.postMessage(null)}}else M=function(){v(T,0)};function N(t){E=t,S||(S=!0,M())}function R(t,n){k=v((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,N(x))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,i,a){var o=e.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:u++,callback:i,priorityLevel:t,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(t.sortIndex=a,n(c,t),null===r(h)&&t===r(c)&&(g?(_(k),k=-1):g=!0,R(b,a-o))):(t.sortIndex=s,n(h,t),p||m||(p=!0,N(x))),t},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},8853:(t,e,n)=>{"use strict";t.exports=n(7234)},4395:t=>{"use strict";t.exports={eudist:function(t,e){for(var n=t.length,r=0,i=0;i<n;i++){var a=(t[i]||0)-(e[i]||0);r+=a*a}return r},mandist:function(t,e){for(var n=t.length,r=0,i=0,a=0;a<n;a++)r+=(i=(t[a]||0)-(e[a]||0))>=0?i:-i;return r},dist:function(t,e,n){var r=Math.abs(t-e);return n?r:r*r}}},3357:(t,e,n)=>{"use strict";var r=n(4395),i=r.eudist,a=r.dist;t.exports={kmrand:function(t,e){for(var n={},r=[],i=e<<2,a=t.length,o=t[0].length>0;r.length<e&&i-- >0;){var s=t[Math.floor(Math.random()*a)],l=o?s.join("_"):"".concat(s);n[l]||(n[l]=!0,r.push(s))}if(r.length<e)throw new Error("Error initializating clusters");return r},kmpp:function(t,e,n){var r=n||(t[0].length?i:a),o=[],s=t.length,l=t[0].length>0,h=t[Math.floor(Math.random()*s)];l?h.join("_"):"".concat(h);for(o.push(h);o.length<e;){for(var c=[],u=o.length,d=0,f=[],m=0;m<s;m++){for(var p=1/0,g=0;g<u;g++){var v=r(t[m],o[g]);v<=p&&(p=v)}c[m]=p}for(var _=0;_<s;_++)d+=c[_];for(var w=0;w<s;w++)f[w]={i:w,v:t[w],pr:c[w]/d,cs:0};f.sort((function(t,e){return t.pr-e.pr})),f[0].cs=f[0].pr;for(var y=1;y<s;y++)f[y].cs=f[y-1].cs+f[y].pr;for(var b=Math.random(),x=0;x<s-1&&f[x++].cs<b;);o.push(f[x-1].v)}return o}}},109:(t,e,n)=>{"use strict";var r=n(4395),i=n(3357),a=r.eudist,o=(r.mandist,r.dist,i.kmrand),s=i.kmpp;function l(t,e,n){n=n||[];for(var r=0;r<t;r++)n[r]=e;return n}function h(t,e){for(var n=Array.isArray(t),r=this.centroids,i=r.length,o=1/0,s=0,l=0;l<i;l++){var h=e?e(t,r[l]):n?a(t,r[l]):Math.abs(t-r[l]);h<=o&&(o=h,s=l)}return{idx:s,centroid:r[s]}}t.exports=function(t,e,n,r,i){var c=[],u=[],d=[],f=[],m=!1,p=r||1e4,g=t.length,v=t[0].length,_=v>0,w=[];if(n)c="kmrand"==n?o(t,e):"kmpp"==n?s(t,e,i):n;else for(var y={},b=0;c.length<e;){var x=Math.floor(Math.random()*g);y[x]||(y[x]=!0,c[b++]=t[x])}do{l(e,0,w);for(var M=0;M<g;M++){for(var S=1/0,E=0,k=0;k<e;k++){(f=i?i(t[M],c[k]):_?a(t[M],c[k]):Math.abs(t[M]-c[k]))<=S&&(S=f,E=k)}d[M]=E,w[E]++}var C=[];u=[];if(_)for(var A=0;A<e;A++)C[A]=l(v,0,C[A]),u[A]=c[A];else for(var P=0;P<e;P++)C[P]=0,u[P]=c[P];if(_){for(var T=0;T<e;T++)c[T]=[];for(var D=0;D<g;D++)for(var I=C[d[D]],N=t[D],R=0;R<v;R++)I[R]+=N[R];m=!0;for(var L=0;L<e;L++){for(var U=c[L],O=C[L],z=u[L],F=w[L],B=0;B<v;B++)U[B]=O[B]/F||0;if(m)for(var V=0;V<v;V++)if(z[V]!=U[V]){m=!1;break}}}else{for(var H=0;H<g;H++){C[d[H]]+=t[H]}for(var G=0;G<e;G++)c[G]=C[G]/w[G]||0;m=!0;for(var j=0;j<e;j++)if(u[j]!=c[j]){m=!1;break}}m=m||--p<=0}while(!m);return{it:(r||1e4)-p,k:e,idxs:d,centroids:c,test:h}}},9844:t=>{"use strict";t.exports=function(t,n,r){var i=t*n,a=e*t,o=a-(a-t),s=t-o,l=e*n,h=l-(l-n),c=n-h,u=s*c-(i-o*h-s*h-o*c);if(r)return r[0]=u,r[1]=i,r;return[u,i]};var e=+(Math.pow(2,27)+1)},9684:t=>{"use strict";t.exports=function(t,e,n){var r=t+e,i=r-t,a=e-i,o=t-(r-i);if(n)return n[0]=o+a,n[1]=r,n;return[o+a,r]}},7600:(t,e,n)=>{"use strict";var r=n(5358),i=navigator.hardwareConcurrency||1;Function.prototype;function a(t,e){if("string"!==typeof t&&"function"!==typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!==typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(i-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,i):this._numWorkers=i,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var n=e.deps;"string"===typeof n&&(n=[n]),Array.isArray(n)||(n=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(n)}a.prototype._init=function(t){for(var e=r.newWorkerURL(this._workerCode,t),n=0;n<this._numWorkers;n++){var i=new Worker(e);i.onmessage=this._onmessage.bind(this,i),i.onerror=this._onerror.bind(this,i),i.running=!1,i.id=n,this._workers.set(i,null)}URL.revokeObjectURL(e)},a.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var n=this._workers.get(t);n&&n[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},a.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var n=this._workers.get(t);n&&n[0](e.data.data),this._workers.set(t,null),this._exec()}},a.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var n=this._waiting[e];if("number"!==typeof n[4]||n[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:n[0],args:n[1]},n[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,n[3]),this._working++;break}}}},a.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},a.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var n=[];for(var r of this._workers.keys())n.push(this.post(t,e,[],r.id));return Promise.all(n)},a.prototype.post=function(t,e,n,r){void 0===e&&(e=[]),void 0===n&&(n=[]),Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var i=this;return new Promise((function(a,o){if(i._terminated)throw new Error("Cannot post (terminated)");i._waiting.push([t,e,n,[a,o],r]),i._exec()}))},t.exports=a},5358:(t,e)=>{"use strict";var n=function(){self.window=self;function t(){this._listeners={}}t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!==typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,n){void 0===n?n=[]:Array.isArray(n)||(n=[n]),self.postMessage({id:t,data:e},n)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(n,r){e._send(t.data.id,n,r)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}}.toString().split('"CODE";');e.newWorkerURL=function(t,e){var r=new Blob(["(",n[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",n[1],")();"],{type:"application/javascript"});return URL.createObjectURL(r)}},7753:t=>{"use strict";t.exports={version:"1.0.1"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((e,n)=>(__webpack_require__.f[n](t,e),e)),[])),__webpack_require__.u=t=>"static/js/"+t+".964cfa5c.chunk.js",__webpack_require__.miniCssF=t=>{},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="picastlo:";__webpack_require__.l=(n,r,i,a)=>{if(t[n])t[n].push(r);else{var o,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var c=l[h];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==e+i){o=c;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",e+i),o.src=n),t[n]=[r];var u=(e,r)=>{o.onerror=o.onload=null,clearTimeout(d);var i=t[n];if(delete t[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((t=>t(r))),e)return e(r)},d=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),s&&document.head.appendChild(o)}}})(),__webpack_require__.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.p="/",(()=>{var t={792:0};__webpack_require__.f.j=(e,n)=>{var r=__webpack_require__.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=t[e]=[n,i]));n.push(r[2]=i);var a=__webpack_require__.p+__webpack_require__.u(e),o=new Error;__webpack_require__.l(a,(n=>{if(__webpack_require__.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,r[1](o)}}),"chunk-"+e,e)}};var e=(e,n)=>{var r,i,a=n[0],o=n[1],s=n[2],l=0;if(a.some((e=>0!==t[e]))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(s)s(__webpack_require__)}for(e&&e(n);l<a.length;l++)i=a[l],__webpack_require__.o(t,i)&&t[i]&&t[i][0](),t[i]=0},n=self.webpackChunkpicastlo=self.webpackChunkpicastlo||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var t=__webpack_require__(5043),e=__webpack_require__(4391),n=__webpack_require__(109),r=__webpack_require__.n(n);const i="168",a=1e3,o=1001,s=1002,l=1006,h=1008,c=1009,u=1023,d=2300,f=2301,m=2302,p=2400,g=2401,v=2402,_="",w="srgb",y="srgb-linear",b="display-p3",x="display-p3-linear",M="linear",S="srgb",E="rec709",k="p3",C=2e3,A=2001;class P{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const T=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];Math.PI,Math.PI;function D(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(T[255&t]+T[t>>8&255]+T[t>>16&255]+T[t>>24&255]+"-"+T[255&e]+T[e>>8&255]+"-"+T[e>>16&15|64]+T[e>>24&255]+"-"+T[63&n|128]+T[n>>8&255]+"-"+T[n>>16&255]+T[n>>24&255]+T[255&r]+T[r>>8&255]+T[r>>16&255]+T[r>>24&255]).toLowerCase()}function I(t,e,n){return Math.max(e,Math.min(n,t))}function N(t,e){return(t%e+e)%e}function R(t,e,n){return(1-n)*t+n*e}class L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;L.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(I(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,a=this.y-t.y;return this.x=i*n-a*r+t.x,this.y=i*r+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class U{constructor(t,e,n,r,i,a,o,s,l){U.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,a,o,s,l)}set(t,e,n,r,i,a,o,s,l){const h=this.elements;return h[0]=t,h[1]=r,h[2]=o,h[3]=e,h[4]=i,h[5]=s,h[6]=n,h[7]=a,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],h=n[4],c=n[7],u=n[2],d=n[5],f=n[8],m=r[0],p=r[3],g=r[6],v=r[1],_=r[4],w=r[7],y=r[2],b=r[5],x=r[8];return i[0]=a*m+o*v+s*y,i[3]=a*p+o*_+s*b,i[6]=a*g+o*w+s*x,i[1]=l*m+h*v+c*y,i[4]=l*p+h*_+c*b,i[7]=l*g+h*w+c*x,i[2]=u*m+d*v+f*y,i[5]=u*p+d*_+f*b,i[8]=u*g+d*w+f*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],h=t[8];return e*a*h-e*o*l-n*i*h+n*o*s+r*i*l-r*a*s}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],h=t[8],c=h*a-o*l,u=o*s-h*i,d=l*i-a*s,f=e*c+n*u+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const m=1/f;return t[0]=c*m,t[1]=(r*l-h*n)*m,t[2]=(o*n-r*a)*m,t[3]=u*m,t[4]=(h*e-r*s)*m,t[5]=(r*i-o*e)*m,t[6]=d*m,t[7]=(n*s-l*e)*m,t[8]=(a*e-n*i)*m,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,a,o){const s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+t,-r*l,r*s,-r*(-l*a+s*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(O.makeScale(t,e)),this}rotate(t){return this.premultiply(O.makeRotation(-t)),this}translate(t,e){return this.premultiply(O.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const O=new U;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function z(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function F(){const t=z("canvas");return t.style.display="block",t}const B=(new U).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),V=(new U).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),H={[y]:{transfer:M,primaries:E,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t,fromReference:t=>t},[w]:{transfer:S,primaries:E,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[x]:{transfer:M,primaries:k,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.applyMatrix3(V),fromReference:t=>t.applyMatrix3(B)},[b]:{transfer:S,primaries:k,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.convertSRGBToLinear().applyMatrix3(V),fromReference:t=>t.applyMatrix3(B).convertLinearToSRGB()}},G=new Set([y,x]),j={enabled:!0,_workingColorSpace:y,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!G.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(!1===this.enabled||e===n||!e||!n)return t;const r=H[e].toReference;return(0,H[n].fromReference)(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return H[t].primaries},getTransfer:function(t){return t===_?M:H[t].transfer},getLuminanceCoefficients:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._workingColorSpace;return t.fromArray(H[e].luminanceCoefficients)}};function Y(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function X(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let W;class q{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"===typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===W&&(W=z("canvas")),W.width=t.width,W.height=t.height;const n=W.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=W}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const e=z("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*Y(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Y(e[t]/255)):e[t]=Y(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let $=0;class Z{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:$++}),this.uuid=D(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(K(r[e].image)):t.push(K(r[e]))}else t=K(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function K(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?q.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Q=0;class J extends P{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J.DEFAULT_IMAGE,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:h,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:u,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:c,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:J.DEFAULT_ANISOTROPY,m=arguments.length>9&&void 0!==arguments[9]?arguments[9]:_;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Q++}),this.uuid=D(),this.name="",this.source=new Z(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=f,this.format=s,this.internalFormat=null,this.type=d,this.offset=new L(0,0),this.repeat=new L(1,1),this.center=new L(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new U,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t){void 0===t&&(t=null),this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case a:t.x=t.x-Math.floor(t.x);break;case o:t.x=t.x<0?0:1;break;case s:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case a:t.y=t.y-Math.floor(t.y);break;case o:t.y=t.y<0?0:1;break;case s:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}J.DEFAULT_IMAGE=null,J.DEFAULT_MAPPING=300,J.DEFAULT_ANISOTROPY=1;Symbol.iterator;class tt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,i,a,o){let s=n[r+0],l=n[r+1],h=n[r+2],c=n[r+3];const u=i[a+0],d=i[a+1],f=i[a+2],m=i[a+3];if(0===o)return t[e+0]=s,t[e+1]=l,t[e+2]=h,void(t[e+3]=c);if(1===o)return t[e+0]=u,t[e+1]=d,t[e+2]=f,void(t[e+3]=m);if(c!==m||s!==u||l!==d||h!==f){let t=1-o;const e=s*u+l*d+h*f+c*m,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,e*n);t=Math.sin(t*a)/i,o=Math.sin(o*a)/i}const i=o*n;if(s=s*t+u*i,l=l*t+d*i,h=h*t+f*i,c=c*t+m*i,t===1-o){const t=1/Math.sqrt(s*s+l*l+h*h+c*c);s*=t,l*=t,h*=t,c*=t}}t[e]=s,t[e+1]=l,t[e+2]=h,t[e+3]=c}static multiplyQuaternionsFlat(t,e,n,r,i,a){const o=n[r],s=n[r+1],l=n[r+2],h=n[r+3],c=i[a],u=i[a+1],d=i[a+2],f=i[a+3];return t[e]=o*f+h*c+s*d-l*u,t[e+1]=s*f+h*u+l*c-o*d,t[e+2]=l*f+h*d+o*u-s*c,t[e+3]=h*f-o*c-s*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t._x,r=t._y,i=t._z,a=t._order,o=Math.cos,s=Math.sin,l=o(n/2),h=o(r/2),c=o(i/2),u=s(n/2),d=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=u*h*c+l*d*f,this._y=l*d*c-u*h*f,this._z=l*h*f+u*d*c,this._w=l*h*c-u*d*f;break;case"YXZ":this._x=u*h*c+l*d*f,this._y=l*d*c-u*h*f,this._z=l*h*f-u*d*c,this._w=l*h*c+u*d*f;break;case"ZXY":this._x=u*h*c-l*d*f,this._y=l*d*c+u*h*f,this._z=l*h*f+u*d*c,this._w=l*h*c-u*d*f;break;case"ZYX":this._x=u*h*c-l*d*f,this._y=l*d*c+u*h*f,this._z=l*h*f-u*d*c,this._w=l*h*c+u*d*f;break;case"YZX":this._x=u*h*c+l*d*f,this._y=l*d*c+u*h*f,this._z=l*h*f-u*d*c,this._w=l*h*c-u*d*f;break;case"XZY":this._x=u*h*c-l*d*f,this._y=l*d*c-u*h*f,this._z=l*h*f+u*d*c,this._w=l*h*c+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],a=e[1],o=e[5],s=e[9],l=e[2],h=e[6],c=e[10],u=n+o+c;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(h-s)*t,this._y=(i-l)*t,this._z=(a-r)*t}else if(n>o&&n>c){const t=2*Math.sqrt(1+n-o-c);this._w=(h-s)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(i+l)/t}else if(o>c){const t=2*Math.sqrt(1+o-n-c);this._w=(i-l)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(s+h)/t}else{const t=2*Math.sqrt(1+c-n-o);this._w=(a-r)/t,this._x=(i+l)/t,this._y=(s+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(I(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,a=t._w,o=e._x,s=e._y,l=e._z,h=e._w;return this._x=n*h+a*o+r*l-i*s,this._y=r*h+a*s+i*o-n*l,this._z=i*h+a*l+n*s-r*o,this._w=a*h-n*o-r*s-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,a=this._w;let o=a*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const s=1-o*o;if(s<=Number.EPSILON){const t=1-e;return this._w=t*a+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this}const l=Math.sqrt(s),h=Math.atan2(l,o),c=Math.sin((1-e)*h)/l,u=Math.sin(e*h)/l;return this._w=a*c+this._w*u,this._x=n*c+this._x*u,this._y=r*c+this._y*u,this._z=i*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(t),r*Math.cos(t),i*Math.sin(e),i*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class et{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;et.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(rt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(rt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,a=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,a=t.y,o=t.z,s=t.w,l=2*(a*r-o*n),h=2*(o*e-i*r),c=2*(i*n-a*e);return this.x=e+s*l+a*c-o*h,this.y=n+s*h+o*l-i*c,this.z=r+s*c+i*h-a*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,a=e.x,o=e.y,s=e.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return nt.copy(this).projectOnVector(t),this.sub(nt)}reflect(t){return this.sub(nt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(I(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const nt=new et,rt=new tt;class it{constructor(t,e,n,r,i,a,o,s,l,h,c,u,d,f,m,p){it.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,a,o,s,l,h,c,u,d,f,m,p)}set(t,e,n,r,i,a,o,s,l,h,c,u,d,f,m,p){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=f,g[11]=m,g[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new it).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/at.setFromMatrixColumn(t,0).length(),i=1/at.setFromMatrixColumn(t,1).length(),a=1/at.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,i=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),h=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){const t=a*h,n=a*c,r=o*h,i=o*c;e[0]=s*h,e[4]=-s*c,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-o*s,e[2]=i-t*l,e[6]=r+n*l,e[10]=a*s}else if("YXZ"===t.order){const t=s*h,n=s*c,r=l*h,i=l*c;e[0]=t+i*o,e[4]=r*o-n,e[8]=a*l,e[1]=a*c,e[5]=a*h,e[9]=-o,e[2]=n*o-r,e[6]=i+t*o,e[10]=a*s}else if("ZXY"===t.order){const t=s*h,n=s*c,r=l*h,i=l*c;e[0]=t-i*o,e[4]=-a*c,e[8]=r+n*o,e[1]=n+r*o,e[5]=a*h,e[9]=i-t*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){const t=a*h,n=a*c,r=o*h,i=o*c;e[0]=s*h,e[4]=r*l-n,e[8]=t*l+i,e[1]=s*c,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){const t=a*s,n=a*l,r=o*s,i=o*l;e[0]=s*h,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=a*h,e[9]=-o*h,e[2]=-l*h,e[6]=n*c+r,e[10]=t-i*c}else if("XZY"===t.order){const t=a*s,n=a*l,r=o*s,i=o*l;e[0]=s*h,e[4]=-c,e[8]=l*h,e[1]=t*c+i,e[5]=a*h,e[9]=n*c-r,e[2]=r*c-n,e[6]=o*h,e[10]=i*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(st,t,lt)}lookAt(t,e,n){const r=this.elements;return ut.subVectors(t,e),0===ut.lengthSq()&&(ut.z=1),ut.normalize(),ht.crossVectors(n,ut),0===ht.lengthSq()&&(1===Math.abs(n.z)?ut.x+=1e-4:ut.z+=1e-4,ut.normalize(),ht.crossVectors(n,ut)),ht.normalize(),ct.crossVectors(ut,ht),r[0]=ht.x,r[4]=ct.x,r[8]=ut.x,r[1]=ht.y,r[5]=ct.y,r[9]=ut.y,r[2]=ht.z,r[6]=ct.z,r[10]=ut.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],h=n[1],c=n[5],u=n[9],d=n[13],f=n[2],m=n[6],p=n[10],g=n[14],v=n[3],_=n[7],w=n[11],y=n[15],b=r[0],x=r[4],M=r[8],S=r[12],E=r[1],k=r[5],C=r[9],A=r[13],P=r[2],T=r[6],D=r[10],I=r[14],N=r[3],R=r[7],L=r[11],U=r[15];return i[0]=a*b+o*E+s*P+l*N,i[4]=a*x+o*k+s*T+l*R,i[8]=a*M+o*C+s*D+l*L,i[12]=a*S+o*A+s*I+l*U,i[1]=h*b+c*E+u*P+d*N,i[5]=h*x+c*k+u*T+d*R,i[9]=h*M+c*C+u*D+d*L,i[13]=h*S+c*A+u*I+d*U,i[2]=f*b+m*E+p*P+g*N,i[6]=f*x+m*k+p*T+g*R,i[10]=f*M+m*C+p*D+g*L,i[14]=f*S+m*A+p*I+g*U,i[3]=v*b+_*E+w*P+y*N,i[7]=v*x+_*k+w*T+y*R,i[11]=v*M+_*C+w*D+y*L,i[15]=v*S+_*A+w*I+y*U,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+i*s*c-r*l*c-i*o*u+n*l*u+r*o*d-n*s*d)+t[7]*(+e*s*d-e*l*u+i*a*u-r*a*d+r*l*h-i*s*h)+t[11]*(+e*l*c-e*o*d-i*a*c+n*a*d+i*o*h-n*l*h)+t[15]*(-r*o*h-e*s*c+e*o*u+r*a*c-n*a*u+n*s*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],f=t[12],m=t[13],p=t[14],g=t[15],v=c*p*l-m*u*l+m*s*d-o*p*d-c*s*g+o*u*g,_=f*u*l-h*p*l-f*s*d+a*p*d+h*s*g-a*u*g,w=h*m*l-f*c*l+f*o*d-a*m*d-h*o*g+a*c*g,y=f*c*s-h*m*s-f*o*u+a*m*u+h*o*p-a*c*p,b=e*v+n*_+r*w+i*y;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/b;return t[0]=v*x,t[1]=(m*u*i-c*p*i-m*r*d+n*p*d+c*r*g-n*u*g)*x,t[2]=(o*p*i-m*s*i+m*r*l-n*p*l-o*r*g+n*s*g)*x,t[3]=(c*s*i-o*u*i-c*r*l+n*u*l+o*r*d-n*s*d)*x,t[4]=_*x,t[5]=(h*p*i-f*u*i+f*r*d-e*p*d-h*r*g+e*u*g)*x,t[6]=(f*s*i-a*p*i-f*r*l+e*p*l+a*r*g-e*s*g)*x,t[7]=(a*u*i-h*s*i+h*r*l-e*u*l-a*r*d+e*s*d)*x,t[8]=w*x,t[9]=(f*c*i-h*m*i-f*n*d+e*m*d+h*n*g-e*c*g)*x,t[10]=(a*m*i-f*o*i+f*n*l-e*m*l-a*n*g+e*o*g)*x,t[11]=(h*o*i-a*c*i-h*n*l+e*c*l+a*n*d-e*o*d)*x,t[12]=y*x,t[13]=(h*m*r-f*c*r+f*n*u-e*m*u-h*n*p+e*c*p)*x,t[14]=(f*o*r-a*m*r-f*n*s+e*m*s+a*n*p-e*o*p)*x,t[15]=(a*c*r-h*o*r+h*n*s-e*c*s-a*n*u+e*o*u)*x,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,a=t.x,o=t.y,s=t.z,l=i*a,h=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,h*o+n,h*s-r*a,0,l*s-r*o,h*s+r*a,i*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,a){return this.set(1,n,i,0,t,1,a,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,h=a+a,c=o+o,u=i*l,d=i*h,f=i*c,m=a*h,p=a*c,g=o*c,v=s*l,_=s*h,w=s*c,y=n.x,b=n.y,x=n.z;return r[0]=(1-(m+g))*y,r[1]=(d+w)*y,r[2]=(f-_)*y,r[3]=0,r[4]=(d-w)*b,r[5]=(1-(u+g))*b,r[6]=(p+v)*b,r[7]=0,r[8]=(f+_)*x,r[9]=(p-v)*x,r[10]=(1-(u+m))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=at.set(r[0],r[1],r[2]).length();const a=at.set(r[4],r[5],r[6]).length(),o=at.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],ot.copy(this);const s=1/i,l=1/a,h=1/o;return ot.elements[0]*=s,ot.elements[1]*=s,ot.elements[2]*=s,ot.elements[4]*=l,ot.elements[5]*=l,ot.elements[6]*=l,ot.elements[8]*=h,ot.elements[9]*=h,ot.elements[10]*=h,e.setFromRotationMatrix(ot),n.x=i,n.y=a,n.z=o,this}makePerspective(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C;const s=this.elements,l=2*i/(e-t),h=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r);let d,f;if(o===C)d=-(a+i)/(a-i),f=-2*a*i/(a-i);else{if(o!==A)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-a/(a-i),f=-a*i/(a-i)}return s[0]=l,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=h,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C;const s=this.elements,l=1/(e-t),h=1/(n-r),c=1/(a-i),u=(e+t)*l,d=(n+r)*h;let f,m;if(o===C)f=(a+i)*c,m=-2*c;else{if(o!==A)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);f=i*c,m=-1*c}return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*h,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=m,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const at=new et,ot=new it,st=new et(0,0,0),lt=new et(1,1,1),ht=new et,ct=new et,ut=new et,dt=new it,ft=new tt;class mt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:mt.DEFAULT_ORDER;this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=t.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],h=r[9],c=r[2],u=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(I(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-I(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(I(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-I(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(I(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-I(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return dt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(dt,e,n)}setFromVector3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}reorder(t){return ft.setFromEuler(this),this.setFromQuaternion(ft,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}mt.DEFAULT_ORDER="XYZ";class pt{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&1<<t)}}let gt=0;const vt=new et,_t=new tt,wt=new it,yt=new et,bt=new et,xt=new et,Mt=new tt,St=new et(1,0,0),Et=new et(0,1,0),kt=new et(0,0,1),Ct={type:"added"},At={type:"removed"},Pt={type:"childadded",child:null},Tt={type:"childremoved",child:null};class Dt extends P{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gt++}),this.uuid=D(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Dt.DEFAULT_UP.clone();const t=new et,e=new mt,n=new tt,r=new et(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new it},normalMatrix:{value:new U}}),this.matrix=new it,this.matrixWorld=new it,this.matrixAutoUpdate=Dt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Dt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new pt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return _t.setFromAxisAngle(t,e),this.quaternion.multiply(_t),this}rotateOnWorldAxis(t,e){return _t.setFromAxisAngle(t,e),this.quaternion.premultiply(_t),this}rotateX(t){return this.rotateOnAxis(St,t)}rotateY(t){return this.rotateOnAxis(Et,t)}rotateZ(t){return this.rotateOnAxis(kt,t)}translateOnAxis(t,e){return vt.copy(t).applyQuaternion(this.quaternion),this.position.add(vt.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(St,t)}translateY(t){return this.translateOnAxis(Et,t)}translateZ(t){return this.translateOnAxis(kt,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(wt.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?yt.copy(t):yt.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),bt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wt.lookAt(bt,yt,this.up):wt.lookAt(yt,bt,this.up),this.quaternion.setFromRotationMatrix(wt),r&&(wt.extractRotation(r.matrixWorld),_t.setFromRotationMatrix(wt),this.quaternion.premultiply(_t.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Ct),Pt.child=t,this.dispatchEvent(Pt),Pt.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(At),Tt.child=t,this.dispatchEvent(Tt),Tt.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),wt.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),wt.multiply(t.parent.matrixWorld)),t.applyMatrix4(wt),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Ct),Pt.child=t,this.dispatchEvent(Pt),Pt.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getObjectsByProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[t]===e&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bt,t,xt),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bt,Mt,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){e[n].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((t=>({boxInitialized:t.boxInitialized,boxMin:t.box.min.toArray(),boxMax:t.box.max.toArray(),sphereInitialized:t.sphereInitialized,sphereRadius:t.sphere.radius,sphereCenter:t.sphere.center.toArray()}))),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(t),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=a(t.geometries),r=a(t.materials),i=a(t.textures),o=a(t.images),s=a(t.shapes),l=a(t.skeletons),h=a(t.animations),c=a(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),h.length>0&&(n.animations=h),c.length>0&&(n.nodes=c)}return n.object=r,n;function a(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}Dt.DEFAULT_UP=new et(0,1,0),Dt.DEFAULT_MATRIX_AUTO_UPDATE=!0,Dt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const It={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nt={h:0,s:0,l:0},Rt={h:0,s:0,l:0};function Lt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class Ut{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,j.toWorkingColorSpace(this,e),this}setRGB(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j.workingColorSpace;return this.r=t,this.g=e,this.b=n,j.toWorkingColorSpace(this,r),this}setHSL(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j.workingColorSpace;if(t=N(t,1),e=I(e,0,1),n=I(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Lt(i,r,t+1/3),this.g=Lt(i,r,t),this.b=Lt(i,r,t-1/3)}return j.toWorkingColorSpace(this,r),this}setStyle(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;function r(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}if(e=/^(\w+)\(([^\)]*)\)/.exec(t)){let i;const a=e[1],o=e[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=e[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(6===i)return this.setHex(parseInt(r,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;const n=It[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Y(t.r),this.g=Y(t.g),this.b=Y(t.b),this}copyLinearToSRGB(t){return this.r=X(t.r),this.g=X(t.g),this.b=X(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w;return j.fromWorkingColorSpace(Ot.copy(this),t),65536*Math.round(I(255*Ot.r,0,255))+256*Math.round(I(255*Ot.g,0,255))+Math.round(I(255*Ot.b,0,255))}getHexString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w;return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.workingColorSpace;j.fromWorkingColorSpace(Ot.copy(this),e);const n=Ot.r,r=Ot.g,i=Ot.b,a=Math.max(n,r,i),o=Math.min(n,r,i);let s,l;const h=(o+a)/2;if(o===a)s=0,l=0;else{const t=a-o;switch(l=h<=.5?t/(a+o):t/(2-a-o),a){case n:s=(r-i)/t+(r<i?6:0);break;case r:s=(i-n)/t+2;break;case i:s=(n-r)/t+4}s/=6}return t.h=s,t.s=l,t.l=h,t}getRGB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.workingColorSpace;return j.fromWorkingColorSpace(Ot.copy(this),e),t.r=Ot.r,t.g=Ot.g,t.b=Ot.b,t}getStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w;j.fromWorkingColorSpace(Ot.copy(this),t);const e=Ot.r,n=Ot.g,r=Ot.b;return t!==w?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(t,e,n){return this.getHSL(Nt),this.setHSL(Nt.h+t,Nt.s+e,Nt.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Nt),t.getHSL(Rt);const n=R(Nt.h,Rt.h,e),r=R(Nt.s,Rt.s,e),i=R(Nt.l,Rt.l,e);return this.setHSL(n,r,i),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,i=t.elements;return this.r=i[0]*e+i[3]*n+i[6]*r,this.g=i[1]*e+i[4]*n+i[7]*r,this.b=i[2]*e+i[5]*n+i[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ot=new Ut;Ut.NAMES=It;function zt(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Ft(t){const e={};for(let n=0;n<t.length;n++){const r=zt(t[n]);for(const t in r)e[t]=r[t]}return e}const Bt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Vt={common:{diffuse:{value:new Ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new U},alphaMap:{value:null},alphaMapTransform:{value:new U},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new U}},envmap:{envMap:{value:null},envMapRotation:{value:new U},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new U}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new U}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new U},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new U},normalScale:{value:new L(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new U},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new U}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new U}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new U}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new U},alphaTest:{value:0},uvTransform:{value:new U}},sprite:{diffuse:{value:new Ut(16777215)},opacity:{value:1},center:{value:new L(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new U},alphaMap:{value:null},alphaMapTransform:{value:new U},alphaTest:{value:0}}},Ht={basic:{uniforms:Ft([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.fog]),vertexShader:Bt.meshbasic_vert,fragmentShader:Bt.meshbasic_frag},lambert:{uniforms:Ft([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,Vt.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Bt.meshlambert_vert,fragmentShader:Bt.meshlambert_frag},phong:{uniforms:Ft([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,Vt.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:Bt.meshphong_vert,fragmentShader:Bt.meshphong_frag},standard:{uniforms:Ft([Vt.common,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.roughnessmap,Vt.metalnessmap,Vt.fog,Vt.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bt.meshphysical_vert,fragmentShader:Bt.meshphysical_frag},toon:{uniforms:Ft([Vt.common,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.gradientmap,Vt.fog,Vt.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Bt.meshtoon_vert,fragmentShader:Bt.meshtoon_frag},matcap:{uniforms:Ft([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,{matcap:{value:null}}]),vertexShader:Bt.meshmatcap_vert,fragmentShader:Bt.meshmatcap_frag},points:{uniforms:Ft([Vt.points,Vt.fog]),vertexShader:Bt.points_vert,fragmentShader:Bt.points_frag},dashed:{uniforms:Ft([Vt.common,Vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bt.linedashed_vert,fragmentShader:Bt.linedashed_frag},depth:{uniforms:Ft([Vt.common,Vt.displacementmap]),vertexShader:Bt.depth_vert,fragmentShader:Bt.depth_frag},normal:{uniforms:Ft([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,{opacity:{value:1}}]),vertexShader:Bt.meshnormal_vert,fragmentShader:Bt.meshnormal_frag},sprite:{uniforms:Ft([Vt.sprite,Vt.fog]),vertexShader:Bt.sprite_vert,fragmentShader:Bt.sprite_frag},background:{uniforms:{uvTransform:{value:new U},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Bt.background_vert,fragmentShader:Bt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new U}},vertexShader:Bt.backgroundCube_vert,fragmentShader:Bt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Bt.cube_vert,fragmentShader:Bt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bt.equirect_vert,fragmentShader:Bt.equirect_frag},distanceRGBA:{uniforms:Ft([Vt.common,Vt.displacementmap,{referencePosition:{value:new et},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bt.distanceRGBA_vert,fragmentShader:Bt.distanceRGBA_frag},shadow:{uniforms:Ft([Vt.lights,Vt.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:Bt.shadow_vert,fragmentShader:Bt.shadow_frag}};Ht.physical={uniforms:Ft([Ht.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new U},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new U},clearcoatNormalScale:{value:new L(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new U},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new U},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new U},sheen:{value:0},sheenColor:{value:new Ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new U},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new U},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new U},transmissionSamplerSize:{value:new L},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new U},attenuationDistance:{value:0},attenuationColor:{value:new Ut(0)},specularColor:{value:new Ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new U},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new U},anisotropyVector:{value:new L},anisotropyMap:{value:null},anisotropyMapTransform:{value:new U}}]),vertexShader:Bt.meshphysical_vert,fragmentShader:Bt.meshphysical_frag};Math.sqrt(5);new Float32Array(16),new Float32Array(9),new Float32Array(4);new Map;function Gt(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function jt(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class Yt{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let a;n:{r:if(!(t<r)){for(let a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=e[++n],t<r)break e}a=e.length;break n}if(t>=i)break t;{const o=e[1];t<o&&(n=2,i=o);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=e[--n-1],t>=i)break e}a=n,n=0}}for(;n<a;){const r=n+a>>>1;t<e[r]?a=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let a=0;a!==r;++a)e[a]=n[i+a];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Xt extends Yt{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:p,endingEnd:p}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,a=t+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case g:i=t,o=2*e-n;break;case v:i=r.length-2,o=e+r[i]-r[i+1];break;default:i=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case g:a=t,s=2*n-e;break;case v:a=1,s=n+r[1]-r[0];break;default:a=t-1,s=e}const l=.5*(n-e),h=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-n),this._offsetPrev=i*h,this._offsetNext=a*h}interpolate_(t,e,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,h=this._offsetPrev,c=this._offsetNext,u=this._weightPrev,d=this._weightNext,f=(n-e)/(r-e),m=f*f,p=m*f,g=-u*p+2*u*m-u*f,v=(1+u)*p+(-1.5-2*u)*m+(-.5+u)*f+1,_=(-1-d)*p+(1.5+d)*m+.5*f,w=d*p-d*m;for(let y=0;y!==o;++y)i[y]=g*a[h+y]+v*a[l+y]+_*a[s+y]+w*a[c+y];return i}}class Wt extends Yt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,h=(n-e)/(r-e),c=1-h;for(let u=0;u!==o;++u)i[u]=a[l+u]*c+a[s+u]*h;return i}}class qt extends Yt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class $t{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Gt(e,this.TimeBufferType),this.values=Gt(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Gt(t.times,Array),values:Gt(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new qt(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Wt(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Xt(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case d:e=this.InterpolantFactoryMethodDiscrete;break;case f:e=this.InterpolantFactoryMethodLinear;break;case m:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return d;case this.InterpolantFactoryMethodLinear:return f;case this.InterpolantFactoryMethodSmooth:return m}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const t=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*t,a*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let a=null;for(let o=0;o!==i;o++){const e=n[o];if("number"===typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,e),t=!1;break}if(null!==a&&a>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,e,a),t=!1;break}a=e}if(void 0!==r&&jt(r))for(let o=0,s=r.length;o!==s;++o){const e=r[o];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,e),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===m,i=t.length-1;let a=1;for(let o=1;o<i;++o){let i=!1;const s=t[o];if(s!==t[o+1]&&(1!==o||s!==t[0]))if(r)i=!0;else{const t=o*n,r=t-n,a=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[r+o]||n!==e[a+o]){i=!0;break}}}if(i){if(o!==a){t[a]=t[o];const r=o*n,i=a*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++a}}if(i>0){t[a]=t[i];for(let t=i*n,r=a*n,o=0;o!==n;++o)e[r+o]=e[t+o];++a}return a!==t.length?(this.times=t.slice(0,a),this.values=e.slice(0,a*n)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}$t.prototype.TimeBufferType=Float32Array,$t.prototype.ValueBufferType=Float32Array,$t.prototype.DefaultInterpolation=f;class Zt extends $t{constructor(t,e,n){super(t,e,n)}}Zt.prototype.ValueTypeName="bool",Zt.prototype.ValueBufferType=Array,Zt.prototype.DefaultInterpolation=d,Zt.prototype.InterpolantFactoryMethodLinear=void 0,Zt.prototype.InterpolantFactoryMethodSmooth=void 0;class Kt extends $t{}Kt.prototype.ValueTypeName="color";class Qt extends $t{}Qt.prototype.ValueTypeName="number";class Jt extends Yt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-e)/(r-e);let l=t*o;for(let h=l+o;l!==h;l+=4)tt.slerpFlat(i,0,a,l-o,a,l,s);return i}}class te extends $t{InterpolantFactoryMethodLinear(t){return new Jt(this.times,this.values,this.getValueSize(),t)}}te.prototype.ValueTypeName="quaternion",te.prototype.InterpolantFactoryMethodSmooth=void 0;class ee extends $t{constructor(t,e,n){super(t,e,n)}}ee.prototype.ValueTypeName="string",ee.prototype.ValueBufferType=Array,ee.prototype.DefaultInterpolation=d,ee.prototype.InterpolantFactoryMethodLinear=void 0,ee.prototype.InterpolantFactoryMethodSmooth=void 0;class ne extends $t{}ne.prototype.ValueTypeName="vector";class re{constructor(t,e,n){const r=this;let i,a=!1,o=0,s=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===a&&void 0!==r.onStart&&r.onStart(t,o,s),a=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,s),o===s&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const ie=new re;class ae{constructor(t){this.manager=void 0!==t?t:ie,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}ae.DEFAULT_MATERIAL_NAME="__DEFAULT";Error;const oe="\\[\\]\\.:\\/",se=new RegExp("["+oe+"]","g"),le="[^"+oe+"]",he="[^"+oe.replace("\\.","")+"]",ce=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",le)+/(WCOD+)?/.source.replace("WCOD",he)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",le)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",le)+"$"),ue=["material","materials","bones","map"];class de{constructor(t,e,n){this.path=e,this.parsedPath=n||de.parseTrackName(e),this.node=de.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new de.Composite(t,e,n):new de(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(se,"")}static parseTrackName(t){const e=ce.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==ue.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const a=n(i.children);if(a)return a}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=de.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const a=t[r];if(void 0===a){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}de.Composite=class{constructor(t,e,n){const r=n||de.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},de.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},de.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},de.prototype.GetterByBindingType=[de.prototype._getValue_direct,de.prototype._getValue_array,de.prototype._getValue_arrayElement,de.prototype._getValue_toArray],de.prototype.SetterByBindingTypeAndVersioning=[[de.prototype._setValue_direct,de.prototype._setValue_direct_setNeedsUpdate,de.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[de.prototype._setValue_array,de.prototype._setValue_array_setNeedsUpdate,de.prototype._setValue_array_setMatrixWorldNeedsUpdate],[de.prototype._setValue_arrayElement,de.prototype._setValue_arrayElement_setNeedsUpdate,de.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[de.prototype._setValue_fromArray,de.prototype._setValue_fromArray_setNeedsUpdate,de.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i);__webpack_require__(4416).Image;class fe{constructor(t){this.imageData=void 0,this.imageData=t||new ImageData(1,1)}getImageData(){return this.imageData}loadFrom(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");if(!n)throw new Error("Could not get context from canvas");n.drawImage(t,0,0),this.imageData=n.getImageData(0,0,e.width,e.height)}async loadFromString(t){return new Promise(((e,n)=>{const r=new Image;r.src=t,r.onload=()=>{this.loadFrom(r),e(this)}}))}transformImage(t){return t.transform(this)}getPixelXY(t,e){const n=this.imageData.data,r=4*e*this.imageData.width+4*t;return[n[r],n[r+1],n[r+2],n[r+3]]}setPixelXY(t,e,n){const r=this.imageData.data,i=4*e*this.imageData.width+4*t;for(let a=0;a<this.imageData.colorSpace.length;a++)r[i+a]=n[a]}copyRawData(){const t=F().getContext("2d");if(!t)throw Error();const e=t.createImageData(this.imageData.width,this.imageData.height,{colorSpace:this.imageData.colorSpace});for(let n=0;n<this.imageData.data.length;n++)e.data[n]=this.imageData.data[n];return e}width(){return this.imageData.width}height(){return this.imageData.height}dataURL(){const t=document.createElement("canvas");t.width=this.imageData.width,t.height=this.imageData.height;const e=t.getContext("2d");if(e){const n=e.getImageData(0,0,this.imageData.width,this.imageData.height);for(let t=0;t<this.imageData.data.length;t+=1)n.data[t]=this.imageData.data[t];return e.putImageData(n,0,0),t.toDataURL()}throw new Error("Could not get context from canvas")}}const me=11102230246251565e-32,pe=134217729,ge=(3+8*me)*me;function ve(t,e,n,r,i){let a,o,s,l,h=e[0],c=r[0],u=0,d=0;c>h===c>-h?(a=h,h=e[++u]):(a=c,c=r[++d]);let f=0;if(u<t&&d<n)for(c>h===c>-h?(o=h+a,s=a-(o-h),h=e[++u]):(o=c+a,s=a-(o-c),c=r[++d]),a=o,0!==s&&(i[f++]=s);u<t&&d<n;)c>h===c>-h?(o=a+h,l=o-a,s=a-(o-l)+(h-l),h=e[++u]):(o=a+c,l=o-a,s=a-(o-l)+(c-l),c=r[++d]),a=o,0!==s&&(i[f++]=s);for(;u<t;)o=a+h,l=o-a,s=a-(o-l)+(h-l),h=e[++u],a=o,0!==s&&(i[f++]=s);for(;d<n;)o=a+c,l=o-a,s=a-(o-l)+(c-l),c=r[++d],a=o,0!==s&&(i[f++]=s);return 0===a&&0!==f||(i[f++]=a),f}function _e(t){return new Float64Array(t)}const we=_e(4),ye=_e(8),be=_e(12),xe=_e(16),Me=_e(4);function Se(t,e,n,r,i,a){const o=(e-a)*(n-i),s=(t-i)*(r-a),l=o-s,h=Math.abs(o+s);return Math.abs(l)>=33306690738754716e-32*h?l:-function(t,e,n,r,i,a,o){let s,l,h,c,u,d,f,m,p,g,v,_,w,y,b,x,M,S;const E=t-i,k=n-i,C=e-a,A=r-a;y=E*A,d=pe*E,f=d-(d-E),m=E-f,d=pe*A,p=d-(d-A),g=A-p,b=m*g-(y-f*p-m*p-f*g),x=C*k,d=pe*C,f=d-(d-C),m=C-f,d=pe*k,p=d-(d-k),g=k-p,M=m*g-(x-f*p-m*p-f*g),v=b-M,u=b-v,we[0]=b-(v+u)+(u-M),_=y+v,u=_-y,w=y-(_-u)+(v-u),v=w-x,u=w-v,we[1]=w-(v+u)+(u-x),S=_+v,u=S-_,we[2]=_-(S-u)+(v-u),we[3]=S;let P=function(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}(4,we),T=22204460492503146e-32*o;if(P>=T||-P>=T)return P;if(u=t-E,s=t-(E+u)+(u-i),u=n-k,h=n-(k+u)+(u-i),u=e-C,l=e-(C+u)+(u-a),u=r-A,c=r-(A+u)+(u-a),0===s&&0===l&&0===h&&0===c)return P;if(T=11093356479670487e-47*o+ge*Math.abs(P),P+=E*c+A*s-(C*h+k*l),P>=T||-P>=T)return P;y=s*A,d=pe*s,f=d-(d-s),m=s-f,d=pe*A,p=d-(d-A),g=A-p,b=m*g-(y-f*p-m*p-f*g),x=l*k,d=pe*l,f=d-(d-l),m=l-f,d=pe*k,p=d-(d-k),g=k-p,M=m*g-(x-f*p-m*p-f*g),v=b-M,u=b-v,Me[0]=b-(v+u)+(u-M),_=y+v,u=_-y,w=y-(_-u)+(v-u),v=w-x,u=w-v,Me[1]=w-(v+u)+(u-x),S=_+v,u=S-_,Me[2]=_-(S-u)+(v-u),Me[3]=S;const D=ve(4,we,4,Me,ye);y=E*c,d=pe*E,f=d-(d-E),m=E-f,d=pe*c,p=d-(d-c),g=c-p,b=m*g-(y-f*p-m*p-f*g),x=C*h,d=pe*C,f=d-(d-C),m=C-f,d=pe*h,p=d-(d-h),g=h-p,M=m*g-(x-f*p-m*p-f*g),v=b-M,u=b-v,Me[0]=b-(v+u)+(u-M),_=y+v,u=_-y,w=y-(_-u)+(v-u),v=w-x,u=w-v,Me[1]=w-(v+u)+(u-x),S=_+v,u=S-_,Me[2]=_-(S-u)+(v-u),Me[3]=S;const I=ve(D,ye,4,Me,be);y=s*c,d=pe*s,f=d-(d-s),m=s-f,d=pe*c,p=d-(d-c),g=c-p,b=m*g-(y-f*p-m*p-f*g),x=l*h,d=pe*l,f=d-(d-l),m=l-f,d=pe*h,p=d-(d-h),g=h-p,M=m*g-(x-f*p-m*p-f*g),v=b-M,u=b-v,Me[0]=b-(v+u)+(u-M),_=y+v,u=_-y,w=y-(_-u)+(v-u),v=w-x,u=w-v,Me[1]=w-(v+u)+(u-x),S=_+v,u=S-_,Me[2]=_-(S-u)+(v-u),Me[3]=S;const N=ve(I,be,4,Me,xe);return xe[N-1]}(t,e,n,r,i,a,h)}_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(8),_e(8),_e(8),_e(4),_e(8),_e(8),_e(8),_e(12);_e(192),_e(192);_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(8),_e(8),_e(8),_e(8),_e(8),_e(8),_e(8),_e(8),_e(8),_e(4),_e(4),_e(4),_e(8),_e(16),_e(16),_e(16),_e(32),_e(32),_e(48),_e(64);_e(1152),_e(1152);_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(4),_e(24),_e(24),_e(24),_e(24),_e(24),_e(24),_e(24),_e(24),_e(24),_e(24),_e(1152),_e(1152),_e(1152),_e(1152),_e(1152),_e(2304),_e(2304),_e(3456),_e(5760),_e(8),_e(8),_e(8),_e(16),_e(24),_e(48),_e(48),_e(96),_e(192),_e(384),_e(384),_e(384),_e(768);_e(96),_e(96),_e(96),_e(1152);const Ee=Math.pow(2,-52),ke=new Uint32Array(512);class Ce{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Re;const r=t.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=t[a];i[2*a]=e(r),i[2*a+1]=n(r)}return new Ce(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=t.length>>1;let o=1/0,s=1/0,l=-1/0,h=-1/0;for(let S=0;S<a;S++){const e=t[2*S],n=t[2*S+1];e<o&&(o=e),n<s&&(s=n),e>l&&(l=e),n>h&&(h=n),this._ids[S]=S}const c=(o+l)/2,u=(s+h)/2;let d,f,m;for(let S=0,E=1/0;S<a;S++){const e=Ae(c,u,t[2*S],t[2*S+1]);e<E&&(d=S,E=e)}const p=t[2*d],g=t[2*d+1];for(let S=0,E=1/0;S<a;S++){if(S===d)continue;const e=Ae(p,g,t[2*S],t[2*S+1]);e<E&&e>0&&(f=S,E=e)}let v=t[2*f],_=t[2*f+1],w=1/0;for(let S=0;S<a;S++){if(S===d||S===f)continue;const e=Te(p,g,v,_,t[2*S],t[2*S+1]);e<w&&(m=S,w=e)}let y=t[2*m],b=t[2*m+1];if(w===1/0){for(let r=0;r<a;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];De(this._ids,this._dists,0,a-1);const e=new Uint32Array(a);let n=0;for(let t=0,r=-1/0;t<a;t++){const i=this._ids[t],a=this._dists[i];a>r&&(e[n++]=i,r=a)}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Se(p,g,v,_,y,b)<0){const t=f,e=v,n=_;f=m,v=y,_=b,m=t,y=e,b=n}const x=function(t,e,n,r,i,a){const o=n-t,s=r-e,l=i-t,h=a-e,c=o*o+s*s,u=l*l+h*h,d=.5/(o*h-s*l);return{x:t+(h*c-s*u)*d,y:e+(o*u-l*c)*d}}(p,g,v,_,y,b);this._cx=x.x,this._cy=x.y;for(let S=0;S<a;S++)this._dists[S]=Ae(t[2*S],t[2*S+1],x.x,x.y);De(this._ids,this._dists,0,a-1),this._hullStart=d;let M=3;n[d]=e[m]=f,n[f]=e[d]=m,n[m]=e[f]=d,r[d]=0,r[f]=1,r[m]=2,i.fill(-1),i[this._hashKey(p,g)]=d,i[this._hashKey(v,_)]=f,i[this._hashKey(y,b)]=m,this.trianglesLen=0,this._addTriangle(d,f,m,-1,-1,-1);for(let S,E,k=0;k<this._ids.length;k++){const a=this._ids[k],o=t[2*a],s=t[2*a+1];if(k>0&&Math.abs(o-S)<=Ee&&Math.abs(s-E)<=Ee)continue;if(S=o,E=s,a===d||a===f||a===m)continue;let l=0;for(let t=0,e=this._hashKey(o,s);t<this._hashSize&&(l=i[(e+t)%this._hashSize],-1===l||l===n[l]);t++);l=e[l];let h,c=l;for(;h=n[c],Se(o,s,t[2*c],t[2*c+1],t[2*h],t[2*h+1])>=0;)if(c=h,c===l){c=-1;break}if(-1===c)continue;let u=this._addTriangle(c,a,n[c],-1,-1,r[c]);r[a]=this._legalize(u+2),r[c]=u,M++;let p=n[c];for(;h=n[p],Se(o,s,t[2*p],t[2*p+1],t[2*h],t[2*h+1])<0;)u=this._addTriangle(p,a,h,r[a],-1,r[p]),r[a]=this._legalize(u+2),n[p]=p,M--,p=h;if(c===l)for(;h=e[c],Se(o,s,t[2*h],t[2*h+1],t[2*c],t[2*c+1])<0;)u=this._addTriangle(h,a,c,-1,r[c],r[h]),this._legalize(u+2),r[h]=u,n[c]=c,M--,c=h;this._hullStart=e[a]=c,n[c]=e[p]=a,n[a]=p,i[this._hashKey(o,s)]=a,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(M);for(let S=0,E=this._hullStart;S<M;S++)this.hull[S]=E,E=n[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1===o){if(0===i)break;t=ke[--i];continue}const l=o-o%3,h=s+(t+1)%3,c=l+(o+2)%3,u=e[a],d=e[t],f=e[h],m=e[c];if(Pe(r[2*u],r[2*u+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*m],r[2*m+1])){e[t]=m,e[o]=u;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[a]),this._link(a,c);const s=l+(o+1)%3;i<ke.length&&(ke[i++]=s)}else{if(0===i)break;t=ke[--i]}}return a}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function Ae(t,e,n,r){const i=t-n,a=e-r;return i*i+a*a}function Pe(t,e,n,r,i,a,o,s){const l=t-o,h=e-s,c=n-o,u=r-s,d=i-o,f=a-s,m=c*c+u*u,p=d*d+f*f;return l*(u*p-m*f)-h*(c*p-m*d)+(l*l+h*h)*(c*f-u*d)<0}function Te(t,e,n,r,i,a){const o=n-t,s=r-e,l=i-t,h=a-e,c=o*o+s*s,u=l*l+h*h,d=.5/(o*h-s*l),f=(h*c-s*u)*d,m=(o*u-l*c)*d;return f*f+m*m}function De(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],a=e[r];let o=i-1;for(;o>=n&&e[t[o]]>a;)t[o+1]=t[o--];t[o+1]=r}else{let i=n+1,a=r;Ie(t,n+r>>1,i),e[t[n]]>e[t[r]]&&Ie(t,n,r),e[t[i]]>e[t[r]]&&Ie(t,i,r),e[t[n]]>e[t[i]]&&Ie(t,n,i);const o=t[i],s=e[o];for(;;){do{i++}while(e[t[i]]<s);do{a--}while(e[t[a]]>s);if(a<i)break;Ie(t,i,a)}t[n+1]=t[a],t[a]=o,r-i+1>=a-n?(De(t,e,i,r),De(t,e,n,a-1)):(De(t,e,n,a-1),De(t,e,i,r))}}function Ie(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Ne(t){return t[0]}function Re(t){return t[1]}const Le=__webpack_require__(4416).Image;const Ue=t=>{try{return JSON.parse(t)}catch(e){throw console.error("Error parsing JSON:",e),new Error("Failed to load JSON")}};class Oe{constructor(t,e,n){this.heightMap=t,this.tactileMap=e,this.resolution=n}setResolution(t){this.resolution=t}makePointCloud(){let t=this.heightMap.width(),e=this.heightMap.height(),n=[];for(let r=0;r<t;r+=this.resolution)for(let t=0;t<e;t+=this.resolution)n.push([r,t]);return n}triangulate(t){let e=Ce.from(t),n=[];for(let r=0;r<e.triangles.length;r+=3)n.push({p1:t[e.triangles[r]],p2:t[e.triangles[r+1]],p3:t[e.triangles[r+2]]});return n}setHeight(t){let e=t[0],n=t[1],r=[.299,.587,.114],i=0;for(let a=0;a<3;a++)e<this.resolution||n<this.resolution||e>=this.heightMap.width()-this.resolution||n>=this.heightMap.height()-this.resolution?i=0:i+=this.heightMap.getPixelXY(e,n)[a]*r[a]+this.tactileMap.getPixelXY(e,n)[a]*r[a];return[e,this.heightMap.height()-n,-i/50]}applyHeightMap(t){let e=[];for(let n=0;n<t.length;n+=1)e.push(this.setHeight(t[n].p1)),e.push(this.setHeight(t[n].p2)),e.push(this.setHeight(t[n].p3));return e}outputOBJTriangles(t){let e=new Map,n="",r=1;for(let a=0;a<t.length;a+=3){let i=[];for(let s=0;s<3;s++){let[o,l,h]=t[a+s],c=`v ${o} ${l} ${-h}\n`;e.has(c)?i.push(e.get(c)):(n+=c,n+="vn 0 0 0\n",e.set(c,r),i.push(r),r+=1)}let o="f";for(let t=0;t<3;t++)o+=` ${i[t]}`;n+=o+"\n"}function i(t,e,r,i){n+=`f ${t} ${e} ${r} ${t} \n`,n+=`f ${t} ${i} ${r}  ${t} \n`}return n+="v 0 0 0\n",n+=`v ${this.heightMap.width()} 0 0\n`,n+=`v 0 ${this.heightMap.height()} 0\n`,n+=`v ${this.heightMap.width()} ${this.heightMap.height()} 0\n`,n+="v 0 0 -5\n",n+=`v ${this.heightMap.width()} 0 -5\n`,n+=`v 0 ${this.heightMap.height()} -5\n`,n+=`v ${this.heightMap.width()} ${this.heightMap.height()} -5 \n`,i(r,r+1,r+5,r+4),i(r+2,r+6,r+7,r+3),i(r,r+2,r+6,r+4),i(r+1,r+3,r+7,r+5),i(r+4,r+5,r+7,r+6),n}render(){let t=this.triangulate(this.makePointCloud()),e=this.applyHeightMap(t);return this.outputOBJTriangles(e)}}class ze{constructor(t,e){this.name=void 0,this.value=void 0,this.name=t,this.value=e}setValue(t){this.validValue(t)&&(this.value=t)}getValue(){return this.value}}class Fe extends ze{constructor(t,e,n,r){super(t,e),this.min=void 0,this.max=void 0,this.min=n,this.max=r}validValue(t){return t>=this.min&&t<=this.max}accept(t,e){return t.visitValueOption(this,e)}}class Be extends ze{constructor(t,e){super(t,e)}validValue(t){let e=!0;for(let n=0;e&&n<t.length;++n)e=t[n]>=0&&t[n]<=255;return e}accept(t,e){return t.visitColorOption(this,e)}}class Ve extends ze{constructor(t,e){super(t,e)}validValue(t){return!0}accept(t,e){return t.visitImageOption(this,e)}}class He{constructor(t,e,n){this.name=void 0,this.options=void 0,this.name=t,this.options=e,n&&this.options.push(new Fe("Opacity",100,0,100))}getName(){return this.name}getOptions(){return this.options}getOption(t){if(t>=this.options.length)throw new Error(`index:${t} out of bounds:${this.options.length} `);return this.options[t]}setOption(t,e){if(0==this.options.length)throw new Error("Cannot set options.");for(let n=0;n<this.options.length;++n)if(t===this.options[n].name)return void this.options[n].setValue(e)}transform(t){let e=this.internalTransform(t);if(this.options.length<=0||"Opacity"!==this.options[this.options.length-1].name)return e;let n=this.options[this.options.length-1];if(n.getValue()<=0)return t;if(n.getValue()>=100)return e;let r=n.getValue()/n.max,i=1-r;for(let a=0;a<t.width();++a)for(let n=0;n<t.height();++n){let o=e.getPixelXY(a,n),s=t.getPixelXY(a,n);e.setPixelXY(a,n,[o[0]*r+s[0]*i,o[1]*r+s[1]*i,o[2]*r+s[2]*i,o[3]*r+s[3]*i])}return e}}class Ge extends He{internalTransform(t){const e=t.copyRawData(),n=e.width,r=e.height;let i=new Le(n,r,e.data);i=this.transformImage(i);const a=i.getRGBAData();for(let o=0;o<e.data.length;o++)e.data[o]=a[o];return new fe(e)}}class je extends Ge{constructor(t,e){super(`Convolution(${e})`,[new Fe("Iterations",1,1,25)],!0),this.kernel=t,this.kernel=t}transformImage(t){let e=t;for(let n=0;n<this.getOption(0).getValue();++n)e=e.convolution(this.kernel);return e}}class Ye extends Ge{constructor(){super("Gray Scale",[],!0)}transformImage(t){return t.grey()}}function Xe(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.sqrt(Math.pow(t[r]-e[r],2));return n/t.length}function We(t,e){let n=1/0,r=0;for(let i=0;i<e.length;i++){let a=Xe(t,e[i]);(0===i||a<n)&&(n=a,r=i)}return e[r]}class qe extends He{constructor(t){super("Quantize",[new Fe("k",t,1,20),new Fe("percentage",10,1,100)],!0)}internalTransform(t){const e=t.copyRawData(),n=e.data;let i=[],a=Math.round(n.length*(this.getOption(1).getValue()/100));for(let r=0;r<a;r++){let t=4*Math.floor(Math.random()*(n.length/4));i.push([n[t],n[t+1],n[t+2],n[t+3]])}let o=r()(i,this.getOption(0).getValue()).centroids;for(let r=0;r<n.length;r+=4){let t=We([n[r],n[r+1],n[r+2],n[r+3]],o);for(let e=0;e<4;e++)n[r+e]=t[e]}return new fe(e)}}class $e extends He{constructor(t){super("Point Wise Transformation",[],!0),this.transformation=t}internalTransform(t){const e=t.copyRawData(),n=e.data;for(let r=0;r<n.length;r+=4){let t=[n[r],n[r+1],n[r+2],n[r+3]],e=this.transformation(t);for(let i=0;i<4;i++)n[r+i]=e[i]}return new fe(e)}}class Ze extends Ge{constructor(){super("Edge Detection",[],!0)}transformImage(t){return t.sobelFilter()}}class Ke extends Ge{constructor(){super("Invert Colors",[],!1)}transformImage(t){return t.invert()}}class Qe extends Ge{constructor(){super("Gaussian Filter",[],!0)}transformImage(t){return t.gaussianFilter()}}function Je(t,e,n){return e>=t-n&&e<=t+n}function tn(t,e,n){return Je(t[0],e[0],n)&&Je(t[1],e[1],n)&&Je(t[2],e[2],n)}class en extends Ge{constructor(t,e){super(`Texturize(${e})`,[new Be("color",[127,127,127]),new Fe("margin",0,0,255),new Fe("scale",1,1,20),new Fe("paint strength",50,0,100),new Fe("texture strength",50,0,100)],!1),this.stencil=null,new fe(null).loadFromString(t).then((t=>{this.stencil=new Le(t.width(),t.height(),t.copyRawData().data)}))}transformImage(t){var e,n;if(!this.stencil)return t;let r=null===(e=this.stencil)||void 0===e?void 0:e.resize({width:Math.max(1,Math.floor((null===(n=this.stencil)||void 0===n?void 0:n.width)*(1/this.getOption(2).getValue())))}),i=new ImageData(r.getRGBAData({clamped:!0}),r.width);const a=document.createElement("canvas");a.width=t.width,a.height=t.height;const o=a.getContext("2d");if(!o)throw Error();for(let m=0;m<t.width;m+=i.width)for(let e=0;e<t.height;e+=i.height)o.putImageData(i,m,e);let s=new Le(t.width,t.height,o.getImageData(0,0,t.width,t.height).data),l=this.getOption(0).getValue(),h=this.getOption(1).getValue(),c=this.getOption(3),u=this.getOption(4),d=c.getValue()/c.max,f=u.getValue()/u.max;for(let m=0;m<t.width;++m)for(let e=0;e<t.height;++e){let n=t.getPixelXY(m,e),r=s.getPixelXY(m,e);tn(n,l,h)&&0!=n[3]&&t.setPixelXY(m,e,[n[0]*d+r[0]*f,n[1]*d+r[1]*f,n[2]*d+r[2]*f,n[3]])}return t}}class nn extends Ge{constructor(){super("Select",[new Be("Source Color",[127,127,127]),new Fe("Margin",5,0,255),new Be("Target Color",[127,127,127])],!0)}transformImage(t){let e=this.getOption(0).getValue(),n=this.getOption(1).getValue(),r=this.getOption(2).getValue();for(let i=0;i<t.width;++i)for(let a=0;a<t.height;++a){tn(e,t.getPixelXY(i,a),n)&&t.setPixelXY(i,a,r)}return t}}class rn extends Ge{constructor(t,e){super("Paint",[new Ve("Mask",new ImageData(t,e))],!0)}transformImage(t){let e=t.width,n=t.height,r=this.getOption(0).getValue().data;for(let i=0;i<e;++i)for(let a=0;a<n;++a){const n=4*(a*e+i),o=r[n+3];if(o<=0)continue;const s=o/255,l=1-s;let h=t.getPixelXY(i,a),c=[h[0]*l+r[n]*s,h[1]*l+r[n+1]*s,h[2]*l+r[n+2]*s];t.alpha&&c.push(255),t.setPixelXY(i,a,c)}return t}}const an=[[0,-1,0],[-1,5,-1],[0,-1,0]],on=[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]];var sn=__webpack_require__(579);const ln=e=>{let{title:n,children:r}=e;const[i,a]=(0,t.useState)(!0);return(0,sn.jsxs)("div",{children:[(0,sn.jsxs)("div",{style:{cursor:"pointer",fontWeight:"bold"},children:[(0,sn.jsx)("span",{onClick:()=>a(!i),children:i?"\u25bc":"\u25b6"})," ",n]}),i&&(0,sn.jsx)("div",{style:{marginTop:"10px",paddingLeft:"10px",borderLeft:"2px solid #ccc"},children:r})]})},hn=t=>{let e=Number(t).toString(16);return 1==e.length?"0"+e:e},cn=t=>[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)],un=e=>{let{onSelect:n,setImage:r}=e;const[i,a]=(0,t.useState)(void 0);return(0,sn.jsx)("div",{className:"widget-card",onClick:n,children:(0,sn.jsx)(ln,{title:"Original Image "+(void 0===i?"":"("+i+")"),children:(0,sn.jsx)("input",{type:"file",accept:"image/*",onChange:t=>{var e;const n=null===(e=t.target.files)||void 0===e?void 0:e[0];if(a(null===n||void 0===n?void 0:n.name),n){const t=new FileReader;t.onload=t=>{var e;r(null===(e=t.target)||void 0===e?void 0:e.result)},t.readAsDataURL(n)}}})})})};function dn(t,e){const n=new Blob([e],{type:"text/csv"}),r=window.document.createElement("a");r.href=window.URL.createObjectURL(n),r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}const fn=t=>{let{outputImage:e}=t;return(0,sn.jsx)("div",{children:(0,sn.jsx)("button",{className:"button button-dark",onClick:()=>{if(!e)return;dn("output.obj",new Oe(e,e,1).render())},children:"Export to OBJ"})})};const mn=t=>{let{pipeline:e}=t;return(0,sn.jsx)("button",{className:"button button-dark",onClick:()=>{dn("pipeline.json",e.toJSON())},children:"Save"})},pn=e=>{let{pipeline:n,onLoad:r}=e;const[i,a]=(0,t.useState)(null),o=(0,t.useRef)(null);return(0,sn.jsxs)(sn.Fragment,{children:[(0,sn.jsx)("button",{className:"button button-dark",onClick:()=>{var t;null===(t=o.current)||void 0===t||t.click()},children:"Load"}),(0,sn.jsx)("input",{ref:o,style:{display:"none"},accept:".json",type:"file",onChange:t=>{var e;const o=null===(e=t.target.files)||void 0===e?void 0:e[0];if(o){const t=new FileReader;t.onload=t=>{try{var e;n.fromJSON(null===(e=t.target)||void 0===e?void 0:e.result),r(n.length())}catch(i){a(i.message)}},t.readAsText(o)}}}),i&&(0,sn.jsxs)("p",{style:{color:"red"},children:[i,(0,sn.jsx)("span",{style:{cursor:"grab",height:"0px",position:"relative",top:"0px",left:"300px"},onClick:()=>a(null),children:"x"})]})]})};var gn=__webpack_require__(7950);function vn(){return vn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vn.apply(this,arguments)}var _n="undefined"!==typeof window?t.useLayoutEffect:t.useEffect,wn={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},yn=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],bn=function(t,e,n,r,i){var a=i.offsetX,o=i.offsetY,s=r?8:0,l=n.split(" "),h=t.top+t.height/2,c=t.left+t.width/2,u=e.height,d=e.width,f=h-u/2,m=c-d/2,p="",g="0%",v="0%";switch(l[0]){case"top":f-=u/2+t.height/2+s,p="rotate(180deg)  translateX(50%)",g="100%",v="50%";break;case"bottom":f+=u/2+t.height/2+s,p="rotate(0deg) translateY(-100%) translateX(-50%)",v="50%";break;case"left":m-=d/2+t.width/2+s,p=" rotate(90deg)  translateY(50%) translateX(-25%)",v="100%",g="50%";break;case"right":m+=d/2+t.width/2+s,p="rotate(-90deg)  translateY(-150%) translateX(25%)",g="50%"}switch(l[1]){case"top":f=t.top,g=t.height/2+"px";break;case"bottom":f=t.top-u+t.height,g=u-t.height/2+"px";break;case"left":m=t.left,v=t.width/2+"px";break;case"right":m=t.left-d+t.width,v=d-t.width/2+"px"}return{top:f="top"===l[0]?f-o:f+o,left:m="left"===l[0]?m-a:m+a,transform:p,arrowLeft:v,arrowTop:g}},xn=function(t,e,n,r,i,a){var o=i.offsetX,s=i.offsetY,l={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},h=0,c=function(t){var e={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if("string"===typeof t){var n=document.querySelector(t);null!==n&&(e=n.getBoundingClientRect())}return e}(a),u=Array.isArray(n)?n:[n];for((a||Array.isArray(n))&&(u=[].concat(u,yn));h<u.length;){var d={top:(l=bn(t,e,u[h],r,{offsetX:o,offsetY:s})).top,left:l.left,width:e.width,height:e.height};if(!(d.top<=c.top||d.left<=c.left||d.top+d.height>=c.top+c.height||d.left+d.width>=c.left+c.width))break;h++}return l},Mn=0,Sn=(0,t.forwardRef)((function(e,n){var r=e.trigger,i=void 0===r?null:r,a=e.onOpen,o=void 0===a?function(){}:a,s=e.onClose,l=void 0===s?function(){}:s,h=e.defaultOpen,c=void 0!==h&&h,u=e.open,d=void 0===u?void 0:u,f=e.disabled,m=void 0!==f&&f,p=e.nested,g=void 0!==p&&p,v=e.closeOnDocumentClick,_=void 0===v||v,w=e.repositionOnResize,y=void 0===w||w,b=e.closeOnEscape,x=void 0===b||b,M=e.on,S=void 0===M?["click"]:M,E=e.contentStyle,k=void 0===E?{}:E,C=e.arrowStyle,A=void 0===C?{}:C,P=e.overlayStyle,T=void 0===P?{}:P,D=e.className,I=void 0===D?"":D,N=e.position,R=void 0===N?"bottom center":N,L=e.modal,U=void 0!==L&&L,O=e.lockScroll,z=void 0!==O&&O,F=e.arrow,B=void 0===F||F,V=e.offsetX,H=void 0===V?0:V,G=e.offsetY,j=void 0===G?0:G,Y=e.mouseEnterDelay,X=void 0===Y?100:Y,W=e.mouseLeaveDelay,q=void 0===W?100:W,$=e.keepTooltipInside,Z=void 0!==$&&$,K=e.children,Q=(0,t.useState)(d||c),J=Q[0],tt=Q[1],et=(0,t.useRef)(null),nt=(0,t.useRef)(null),rt=(0,t.useRef)(null),it=(0,t.useRef)(null),at=(0,t.useRef)("popup-"+ ++Mn),ot=!!U||!i,st=(0,t.useRef)(0);_n((function(){return J?(it.current=document.activeElement,wt(),gt(),mt()):pt(),function(){clearTimeout(st.current)}}),[J]),(0,t.useEffect)((function(){"boolean"===typeof d&&(d?lt():ht())}),[d,m]);var lt=function(t){J||m||(tt(!0),setTimeout((function(){return o(t)}),0))},ht=function(t){var e;J&&!m&&(tt(!1),ot&&(null===(e=it.current)||void 0===e||e.focus()),setTimeout((function(){return l(t)}),0))},ct=function(t){null===t||void 0===t||t.stopPropagation(),J?ht(t):lt(t)},ut=function(t){clearTimeout(st.current),st.current=setTimeout((function(){return lt(t)}),X)},dt=function(t){null===t||void 0===t||t.preventDefault(),ct()},ft=function(t){clearTimeout(st.current),st.current=setTimeout((function(){return ht(t)}),q)},mt=function(){ot&&z&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},pt=function(){ot&&z&&(document.getElementsByTagName("body")[0].style.overflow="auto")},gt=function(){var t,e=null===nt||void 0===nt||null===(t=nt.current)||void 0===t?void 0:t.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),n=Array.prototype.slice.call(e)[0];null===n||void 0===n||n.focus()};(0,t.useImperativeHandle)(n,(function(){return{open:function(){lt()},close:function(){ht()},toggle:function(){ct()}}}));var vt,_t,wt=function(){if(!ot&&J&&(null===et||void 0===et?void 0:et.current)&&(null===et||void 0===et?void 0:et.current)&&(null===nt||void 0===nt?void 0:nt.current)){var t,e,n=et.current.getBoundingClientRect(),r=nt.current.getBoundingClientRect(),i=xn(n,r,R,B,{offsetX:H,offsetY:j},Z);if(nt.current.style.top=i.top+window.scrollY+"px",nt.current.style.left=i.left+window.scrollX+"px",B&&rt.current)rt.current.style.transform=i.transform,rt.current.style.setProperty("-ms-transform",i.transform),rt.current.style.setProperty("-webkit-transform",i.transform),rt.current.style.top=(null===(t=A.top)||void 0===t?void 0:t.toString())||i.arrowTop,rt.current.style.left=(null===(e=A.left)||void 0===e?void 0:e.toString())||i.arrowLeft}};vt=ht,void 0===(_t=x)&&(_t=!0),(0,t.useEffect)((function(){if(_t){var t=function(t){"Escape"===t.key&&vt(t)};return document.addEventListener("keyup",t),function(){_t&&document.removeEventListener("keyup",t)}}}),[vt,_t]),function(e,n){void 0===n&&(n=!0),(0,t.useEffect)((function(){if(n){var t=function(t){if(9===t.keyCode){var n,r=null===e||void 0===e||null===(n=e.current)||void 0===n?void 0:n.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),i=Array.prototype.slice.call(r);if(1===i.length)return void t.preventDefault();var a=i[0],o=i[i.length-1];t.shiftKey&&document.activeElement===a?(t.preventDefault(),o.focus()):document.activeElement===o&&(t.preventDefault(),a.focus())}};return document.addEventListener("keydown",t),function(){n&&document.removeEventListener("keydown",t)}}}),[e,n])}(nt,J&&ot),function(e,n){void 0===n&&(n=!0),(0,t.useEffect)((function(){if(n){var t=function(){e()};return window.addEventListener("resize",t),function(){n&&window.removeEventListener("resize",t)}}}),[e,n])}(wt,y),function(e,n,r){void 0===r&&(r=!0),(0,t.useEffect)((function(){if(r){var t=function(t){var r=Array.isArray(e)?e:[e],i=!1;r.forEach((function(e){e.current&&!e.current.contains(t.target)||(i=!0)})),t.stopPropagation(),i||n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){r&&(document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t))}}}),[e,n,r])}(i?[nt,et]:[nt],ht,_&&!g);var yt=function(){return t.createElement("div",Object.assign({},function(){var t=ot?wn.popupContent.modal:wn.popupContent.tooltip,e={className:"popup-content "+(""!==I?I.split(" ").map((function(t){return t+"-content"})).join(" "):""),style:vn({},t,k,{pointerEvents:"auto"}),ref:nt,onClick:function(t){t.stopPropagation()}};return!U&&S.indexOf("hover")>=0&&(e.onMouseEnter=ut,e.onMouseLeave=ft),e}(),{key:"C",role:ot?"dialog":"tooltip",id:at.current}),B&&!ot&&t.createElement("div",{ref:rt,style:wn.popupArrow},t.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(""!==I?I.split(" ").map((function(t){return t+"-arrow"})).join(" "):""),viewBox:"0 0 32 16",style:vn({position:"absolute"},A)},t.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),K&&"function"===typeof K?K(ht,J):K)},bt=!(S.indexOf("hover")>=0),xt=ot?wn.overlay.modal:wn.overlay.tooltip,Mt=[bt&&t.createElement("div",{key:"O","data-testid":"overlay","data-popup":ot?"modal":"tooltip",className:"popup-overlay "+(""!==I?I.split(" ").map((function(t){return t+"-overlay"})).join(" "):""),style:vn({},xt,T,{pointerEvents:_&&g||ot?"auto":"none"}),onClick:_&&g?ht:void 0,tabIndex:-1},ot&&yt()),!ot&&yt()];return t.createElement(t.Fragment,null,function(){for(var e={key:"T",ref:et,"aria-describedby":at.current},n=Array.isArray(S)?S:[S],r=0,a=n.length;r<a;r++)switch(n[r]){case"click":e.onClick=ct;break;case"right-click":e.onContextMenu=dt;break;case"hover":e.onMouseEnter=ut,e.onMouseLeave=ft;break;case"focus":e.onFocus=ut,e.onBlur=ft}if("function"===typeof i){var o=i(J);return!!i&&t.cloneElement(o,e)}return!!i&&t.cloneElement(i,e)}(),J&&gn.createPortal(Mt,function(){var t=document.getElementById("popup-root");return null===t&&((t=document.createElement("div")).setAttribute("id","popup-root"),document.body.appendChild(t)),t}()))}));const En=Sn,kn={visitValueOption:(t,e)=>t.getValue(),visitColorOption(t,e){return n=t.getValue(),"#"+hn(n[0])+hn(n[1])+hn(n[2]);var n},visitImageOption:(t,e)=>t.getValue()},Cn={visitValueOption(t,e){const n=n=>{const r=parseInt(n.target.value);e.transformation.setOption(t.name,r),e.setState(r),e.onLoad()};return(0,sn.jsx)(sn.Fragment,{children:(0,sn.jsxs)("label",{children:[t.name,":",(0,sn.jsx)("input",{type:"number",value:e.state,min:t.min,max:t.max,onChange:n}),(0,sn.jsx)("input",{className:"slider",type:"range",value:e.state,name:t.name,min:t.min,max:t.max,onChange:n})]})})},visitColorOption:(t,e)=>(0,sn.jsx)(sn.Fragment,{children:(0,sn.jsxs)("label",{children:[t.name,": ",(0,sn.jsx)("input",{type:"color",value:e.state,onChange:n=>{e.transformation.setOption(t.name,cn(n.target.value)),e.setState(n.target.value),e.onLoad()}})]})}),visitImageOption:(t,e)=>(0,sn.jsx)(sn.Fragment,{children:(0,sn.jsx)(En,{trigger:(0,sn.jsx)("button",{children:"Toggle Mask Editor"}),position:"right center",children:(0,sn.jsx)(In,{imgRef:e.imgRef,mask:e.state,onChange:n=>{e.transformation.setOption(t.name,n),e.setState(n),e.onLoad()}})})})},An=e=>{let{imgRef:n,option:r,transformation:i,onLoad:a}=e;const[o,s]=(0,t.useState)(r.accept(kn,null));return(0,sn.jsx)("div",{children:r.accept(Cn,{imgRef:n,transformation:i,onLoad:a,state:o,setState:s})})},Pn=e=>{let{imgRef:n,transformation:r,onLoad:i}=e;const[a,o]=(0,t.useState)(!1),s=()=>{i(),o(!1)};return(0,sn.jsxs)("div",{onBlur:s,children:[r.getOptions().map(((t,e)=>(0,sn.jsx)(An,{imgRef:n,option:t,transformation:r,onLoad:()=>o(!0)},e))),r.getOptions().length>0&&(0,sn.jsx)("button",{disabled:!a,onClick:s,children:"Apply"})]})},Tn=t=>{let{imgRef:e,transformation:n,onSelect:r,onLoad:i}=t;return(0,sn.jsx)("div",{className:"widget-card",onClick:r,children:(0,sn.jsx)(ln,{title:n.getName(),children:(0,sn.jsx)(Pn,{imgRef:e,transformation:n,onLoad:i})})})};var Dn=function(t){return t.Brush="BRUSH",t.Eraser="ERASER",t}(Dn||{});const In=e=>{let{mask:n,imgRef:r,onChange:i}=e;const[a,o]=(0,t.useState)(100),[s,l]=(0,t.useState)("#000000"),[h,c]=(0,t.useState)(100),[u,d]=(0,t.useState)(5),[f,m]=(0,t.useState)(Dn.Brush),p=(0,t.useRef)(null),g=(0,t.useRef)(null);(0,t.useEffect)((()=>{const t=g.current;t.width=n.width,t.height=n.height;const e=t.getContext("2d");if(!e)throw Error();e.putImageData(n,0,0)}),[n]);let v=!1;const _=()=>{g.current.getContext("2d")&&(v=!0)},w=(t,e)=>{const n=g.current.getContext("2d");if(n&&v){switch(n.lineWidth=u,n.lineCap="round",f){case Dn.Brush:n.globalCompositeOperation="source-over";const t=cn(s);n.strokeStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+h/100+")";break;case Dn.Eraser:n.globalCompositeOperation="destination-out",n.strokeStyle="rgba(127,127,127,1)"}n.lineTo(t,e),n.stroke(),n.beginPath(),n.moveTo(t,e)}},y=t=>{const e=g.current;w(Math.ceil((t.pageX-e.offsetLeft)/e.clientWidth*e.width),Math.ceil((t.pageY-e.offsetParent.offsetTop)/e.clientHeight*e.height))},b=t=>{t.preventDefault();const e=g.current,n=t.touches;if(1!=n.length)return;const r=n[0];w(Math.ceil((r.pageX-e.offsetLeft)/e.clientWidth*e.width),Math.ceil((r.pageY-e.offsetParent.offsetTop)/e.clientHeight*e.height))},x=()=>{const t=g.current.getContext("2d");t&&(v=!1,t.beginPath())},M=1,S=100,E=1,k=100,C=0,A=100,P=r.current;if(!P.parentElement)throw Error();(0,t.useEffect)((()=>{var t;p.current.style.width=`${null===(t=P.parentElement)||void 0===t?void 0:t.clientWidth}px`;const e=g.current;e.style.left=`calc(${P.style.left} + 1px)`,e.style.top="1px",e.style.width=`${P.clientWidth}px`,e.style.height=`${P.clientHeight}px`,e.style.opacity=`${a}%`}),[]);return(0,sn.jsxs)("div",{ref:p,className:"editor",children:[(0,sn.jsx)("canvas",{ref:g,onMouseDown:t=>{_(),y(t)},onMouseUp:t=>{x()},onMouseMove:y,onTouchStart:t=>{t.preventDefault(),1==t.touches.length&&(_(),b(t))},onTouchEnd:t=>{x()},onTouchMove:b}),(0,sn.jsxs)("div",{className:"toolbar",children:[(0,sn.jsx)("div",{className:"toolopt",children:(0,sn.jsx)(ln,{title:"Editor",children:(0,sn.jsx)("div",{className:"editor-opacity",children:(0,sn.jsxs)("label",{children:["Opacity: ",(0,sn.jsx)("input",{type:"range",value:a,min:C,max:A,onChange:t=>{o(parseInt(t.target.value))}})]})})})}),(0,sn.jsx)("div",{className:"toolopt",children:(0,sn.jsx)(ln,{title:"Brush",children:(0,sn.jsxs)("div",{className:"brush-opts",children:[(0,sn.jsxs)("div",{children:[(0,sn.jsxs)("label",{children:["Color: ",(0,sn.jsx)("input",{type:"color",value:s,onChange:t=>{l(t.target.value)}})]}),(0,sn.jsxs)("label",{className:"editor-settings",children:["Size: ",(0,sn.jsx)("input",{type:"number",value:u,min:M,max:S,onChange:t=>{d(parseInt(t.target.value))}})]}),(0,sn.jsx)("br",{}),(0,sn.jsxs)("label",{children:["Alpha: ",(0,sn.jsx)("input",{type:"range",value:h,min:E,max:k,onChange:t=>{c(parseInt(t.target.value))}})]})]}),(0,sn.jsxs)("div",{onChange:t=>{m(t.target.value)},children:[(0,sn.jsx)("div",{children:(0,sn.jsxs)("label",{children:[(0,sn.jsx)("input",{type:"radio",id:"brush",name:"drone",value:Dn.Brush,checked:f===Dn.Brush})," Brush"]})}),(0,sn.jsx)("div",{children:(0,sn.jsxs)("label",{children:[(0,sn.jsx)("input",{type:"radio",id:"eraser",name:"drone",value:Dn.Eraser,checked:f===Dn.Eraser})," Eraser"]})})]})]})})}),(0,sn.jsx)("button",{onClick:()=>{const t=g.current,e=t.getContext("2d");if(!e)throw Error();i(e.getImageData(0,0,t.width,t.height))},children:"Save"})]})]})},Nn=t=>{let{onSelect:e,image:n,pipeline:r,onLoad:i}=t;return(0,sn.jsx)("div",{className:"widget-card",onClick:e,children:(0,sn.jsxs)(ln,{title:"Final Image",children:[(0,sn.jsx)("div",{children:(0,sn.jsx)(fn,{outputImage:n})}),(0,sn.jsxs)("div",{children:[(0,sn.jsx)(mn,{pipeline:r}),(0,sn.jsx)(pn,{pipeline:r,onLoad:i})]})]})})},Rn=t=>{let{children:e,selected:n}=t;const r=n?"select-box-selected":"select-box";return(0,sn.jsxs)("div",{className:r,children:[" ",e," "]})},Ln=[[0,-1,0],[-1,5,-1],[0,-1,0]],Un=[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],On=[["Quantize",()=>new qe(5)],["GrayScale",()=>new Ye],["Conv Sharpen",()=>new je(Ln,"sharpen")],["Conv Smooth",()=>new je(Un,"smooth")],["GaussianFilter",()=>new Qe],["Edge Detect",()=>new Ze],["Invert",()=>new Ke],["Extract Red",()=>new $e((t=>{let[e,n,r,i]=t;return[e,0,0,i]}))],["Triangles",()=>new en("triangle.png","triangles")],["Waves",()=>new en("waves.png","waves")],["Circles",()=>new en("circle.png","circles")],["Spheres",()=>new en("spheres2.png","spheres")],["Select",()=>new nn],["Paint",t=>new rn(t[0],t[1])]],zn=t=>{let{handleClick:e,symbol:n}=t;return(0,sn.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,sn.jsx)("span",{style:{cursor:"grab",display:"inline-block",marginRight:"10px",verticalAlign:"middle"},onClick:e,children:n}),(0,sn.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,sn.jsx)("hr",{style:{width:"300px",marginRight:"10px",border:"1px solid white",display:"inline-block"}})})]})},Fn=t=>{let{handleClick:e}=t;return(0,sn.jsx)(zn,{handleClick:e,symbol:"+"})},Bn=t=>{let{handleClick:e}=t;return(0,sn.jsx)(zn,{handleClick:e,symbol:"-"})},Vn=e=>{let{imageDimensions:n,addTransform:r}=e;const[i,a]=(0,t.useState)(!1),[o,s]=(0,t.useState)(0);return(0,sn.jsxs)("div",{children:[!i&&(0,sn.jsx)(Fn,{handleClick:()=>{a(!0)}}),i&&(0,sn.jsxs)(sn.Fragment,{children:[(0,sn.jsx)(Bn,{handleClick:()=>{a(!1)}}),(0,sn.jsx)("div",{children:"Choose a transformation: "}),(0,sn.jsxs)("div",{children:[(0,sn.jsx)("select",{value:o,onChange:t=>{s(parseInt(t.target.value))},children:On.map(((t,e)=>(0,sn.jsx)("option",{value:e,children:t[0]},e)))}),(0,sn.jsx)("button",{onClick:()=>{r(On[o][1](n)),a(!1)},style:{margin:"10px"},children:"Add"}),(0,sn.jsx)("button",{onClick:()=>{a(!1)},children:"Cancel"})]})]})]})},Hn=e=>{let{name:n,removeTransform:r}=e;const[i,a]=(0,t.useState)(!1);return(0,sn.jsxs)("div",{children:[!i&&(0,sn.jsx)("div",{style:{position:"absolute"},children:(0,sn.jsx)("span",{style:{cursor:"grab",height:"0px",position:"relative",top:"0px",left:"300px"},onClick:()=>{a(!0)},children:"x"})}),i&&(0,sn.jsxs)(sn.Fragment,{children:["Remove ",n,(0,sn.jsx)("button",{style:{margin:"10px"},onClick:()=>{r(),a(!1)},children:"Confirm"}),(0,sn.jsx)("button",{onClick:()=>{a(!1)},children:"Cancel"})]})]})},Gn=e=>{let{imgRef:n,pipeline:r,image:i,setImage:a,addTransform:o,removeTransform:s,selected:l,setSelected:h}=e;const[c,u]=(0,t.useState)([!1,0]),[d,f]=(0,t.useState)([0,0]);(0,t.useEffect)((()=>{var t;return a((null===(t=r.getImage(l))||void 0===t?void 0:t.dataURL())||null)}),[l]),(0,t.useEffect)((()=>{var t;i&&(r.performTransformations(c[1],m),a((null===(t=r.getImage(l))||void 0===t?void 0:t.dataURL())||null))}),[c]);const m=t=>{h(t)};return(0,sn.jsxs)("div",{className:"toolbox-container",children:[(0,sn.jsx)(Rn,{selected:-1==l,children:(0,sn.jsx)(un,{onSelect:()=>h(-1),setImage:t=>{a(t),new fe(null).loadFromString(t).then((t=>{var e,n;r.setInitialImage(t),f([null===(e=r.getImage(l))||void 0===e?void 0:e.width(),null===(n=r.getImage(l))||void 0===n?void 0:n.height()]),console.log("Loaded & Performing"),r.performTransformations(0,m)}))}})}),r.map(((t,e)=>(0,sn.jsxs)("div",{children:[(0,sn.jsx)(Vn,{imageDimensions:d,addTransform:t=>{i&&(o(e,t),u([!c,e]))}}),(0,sn.jsx)(Hn,{name:t.getName(),removeTransform:()=>{s(e),u([!c,e])}}),(0,sn.jsx)(Rn,{selected:l===e,children:(0,sn.jsx)(Tn,{imgRef:n,transformation:t,onSelect:()=>{h(e)},onLoad:()=>u([!c,e])})})," "]},e))),(0,sn.jsx)(Vn,{imageDimensions:d,addTransform:t=>{i&&(o(r.length(),t),u([!c,r.length()-1]))}}),(0,sn.jsx)(Rn,{selected:l===r.length()-1,children:(0,sn.jsx)(Nn,{onSelect:()=>h(r.length()-1),image:r.getOutputImage(),pipeline:r,onLoad:t=>{u([!c,0]),console.log(t),h(t)}})})]})},jn=new class{constructor(t){this.transformations=void 0,this.input=void 0,this.images=void 0,this.getPipeline=()=>this.transformations,this.length=()=>this.transformations.length,this.map=t=>this.transformations.map(t),this.transformations=t,this.input=null,this.images=[]}add(t){this.transformations.push(t)}insertTransformation(t,e){t>=0&&t<=this.transformations.length&&this.transformations.splice(t,0,e)}removeTransformation(t){t>=0&&t<=this.transformations.length&&this.transformations.splice(t,1)}transform(t,e,n){let r=0==t?e:this.images[t-1];this.images=this.images.splice(0,t);for(let i=t;i<this.transformations.length;i++){r=this.transformations[i].transform(r),this.images.push(r),n(t)}return this.images[t]}setInitialImage(t){this.input=t}setTransformations(t){var e;const n=(null!==(e=Ue(t))&&void 0!==e?e:[]).transformations.map((t=>function(t){const e=t.name;var n=null;switch(e){case"Convolution(sharpen)":n=Object.assign(new je(an,"sharpen"),t);break;case"Convolution(smooth)":n=Object.assign(new je(on,"smooth"),t);break;case"Gray Scale":n=Object.assign(new Ye,t);break;case"Quantize":n=Object.assign(new qe(5),t);break;case"Point Wise Transformation":n=Object.assign(new $e((t=>{let[e,n,r,i]=t;return[e,0,0,i]})),t);break;case"Edge Detection":n=Object.assign(new Ze,t);break;case"Invert Colors":n=Object.assign(new Ke,t);break;case"Gaussian Filter":n=Object.assign(new Qe,t);break;case"Texturize(triangle)":n=Object.assign(new en("triangle.png","triangle"),t);break;case"Texturize(waves)":n=Object.assign(new en("waves.png","waves"),t);break;case"Texturize(circles)":n=Object.assign(new en("circle.png","circles"),t);break;case"Texturize(spheres)":n=Object.assign(new en("spheres2.png","spheres"),t);break;case"Select":n=Object.assign(new nn,t)}n&&t.options&&(n.options=t.options.map((t=>function(t){const e=t.name,n=Object.keys(t),r=n[1],i=t[r];var a=null;if("number"===typeof i){const n=t.value,r=t.min,i=t.max;a=Object.assign(new Fe(e,n,r,i),t)}else if(Array.isArray(i)){const n=t.color;a=Object.assign(new Be(e,n),t)}else"object"===typeof i&&null!==i?console.log("This is an object."):console.log("This is of an unknown type.");return a}(t))));return n}(t)));this.transformations=n}performTransformations(t,e){null!=this.input&&this.transform(t,this.input,e)}getImage(t){return t<0?this.input:t<this.images.length?this.images[t]:null}getOutputImage(){return this.getImage(this.images.length-1)}toJSON(){const t={transformations:this.transformations};return JSON.stringify(t)}fromJSON(t){this.setTransformations(t)}}([]),Yn=()=>{const e=jn,[n,r]=(0,t.useState)(0),[i,a]=(0,t.useState)(null),[o,s]=(0,t.useState)(e.length()-1),l=(0,t.useRef)(null),h=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(null),d=i&&(0,sn.jsx)(sn.Fragment,{children:(0,sn.jsx)("img",{ref:l,src:i,alt:"Uploaded",className:"uploaded-image"})});return(0,t.useEffect)((()=>{h.current.style.width=`calc(100vw - ${c.current.clientWidth}px)`,u.current.style.width=c.current.clientWidth-20+"px"}),[]),(0,t.useEffect)((()=>{const t=l.current;t&&(t.style.left=(h.current.clientWidth-t.clientWidth)/2+"px")}),[n,o,i]),(0,sn.jsx)(sn.Fragment,{children:(0,sn.jsx)("div",{className:"image-transformer",children:(0,sn.jsxs)("div",{className:"image-container",children:[(0,sn.jsx)("div",{ref:h,className:"image-cell",children:d}),(0,sn.jsxs)("div",{ref:c,className:"toolbox",children:[(0,sn.jsx)("h1",{children:"PicaSTLo"}),(0,sn.jsxs)("div",{className:"transformations",children:[(0,sn.jsx)(Gn,{imgRef:l,pipeline:e,image:i,setImage:a,addTransform:(t,i)=>{e.insertTransformation(t,i),r((()=>n+1))},removeTransform:t=>{e.removeTransformation(t),0===e.length()?s(-1):e.length()===t&&s(e.length()-1),r((()=>n+1))},selected:o,setSelected:t=>{s(t)}}),(0,sn.jsxs)("div",{ref:u,className:"license",children:[(0,sn.jsx)("a",{href:"https://picastlo.github.io/",children:"Picastlo"})," \xa9 2024 by ",(0,sn.jsx)("a",{href:"https://github.com/picastlo/",children:"Christophe Scholliers, Jo\xe3o Costa Seco, Eduardo Geraldo"})," is licensed under ",(0,sn.jsx)("a",{href:"https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1",children:"CC BY-SA 4.0"})]})]})]})]})})})},Xn=t=>{t&&t instanceof Function&&__webpack_require__.e(453).then(__webpack_require__.bind(__webpack_require__,6453)).then((e=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:o}=e;n(t),r(t),i(t),a(t),o(t)}))};e.createRoot(document.getElementById("root")).render((0,sn.jsx)(t.StrictMode,{children:(0,sn.jsx)(Yn,{})})),Xn()})()})();
//# sourceMappingURL=main.255e867d.js.map